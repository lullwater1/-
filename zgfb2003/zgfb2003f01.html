<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZGFB2003F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZGFB2003F01</h2>
<h3> Description: Include ZGFB2002F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGFB2002F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_DATA_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data_0100.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_outtab_0100_top&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0100_top,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_zcust_prefix&nbsp;type&nbsp;string.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_zcust_no_5&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_zcust_prefix&nbsp;=&nbsp;|{&nbsp;gv_zcust_no_5&nbsp;}%|.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;a~bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~cctype&nbsp;AS&nbsp;cotype,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~werks,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~name1&nbsp;&nbsp;AS&nbsp;lifnm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~f_name,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~cust_ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8000&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;lfa1&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~lifnr&nbsp;=&nbsp;b~lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zgft8002&nbsp;AS&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;c~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;c~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQ&nbsp;@p_bukrs2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;@s_ccno2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;@s_werks2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;@s_lifnr2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~idate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;@s_idate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~cust_ccno&nbsp;IN&nbsp;@s_cucc2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~imprf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQ&nbsp;'I'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EXISTS&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8001&nbsp;AS&nbsp;x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;x~bukrs&nbsp;=&nbsp;a~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~ccno&nbsp;&nbsp;=&nbsp;a~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~mtroh&nbsp;IN&nbsp;@s_matnr2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~zdeno&nbsp;IN&nbsp;@s_zdeno2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;(&nbsp;@gv_zcust_no_5&nbsp;IS&nbsp;INITIAL&nbsp;OR&nbsp;x~zdeno&nbsp;LIKE&nbsp;@lv_zcust_prefix&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~budat&nbsp;IN&nbsp;@s_budat2&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@lt_outtab_0100_top.<br />
<br />
&nbsp;&nbsp;gt_outtab_0100_top[]&nbsp;=&nbsp;lt_outtab_0100_top[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_data_bot<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data_bot USING p_row TYPE lvc_s_row.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_top_row&nbsp;TYPE&nbsp;ty_outtab_0100_top,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_bot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0100_bot.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_outtab_0100_bot.<br />
&nbsp;&nbsp;REFRESH:&nbsp;gt_outtab_0100_bot.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100_top&nbsp;INTO&nbsp;ls_top_row&nbsp;INDEX&nbsp;p_row-index.<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;a~bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~mtroh&nbsp;AS&nbsp;matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~ccngnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~coflgr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~offshr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~offshr_txt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~land1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~zdeno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~budat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~datab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~datbi<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_outtab_0100_bot<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8001&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zgft8000&nbsp;AS&nbsp;b&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;b~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;b~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~bukrs&nbsp;=&nbsp;@ls_top_row-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;@ls_top_row-ccno.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_bot-&gt;refresh_table_display<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;=&nbsp;1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;HOTSPOT_CLICK_ALV<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM hotspot_click_alv<br />
&nbsp;&nbsp;USING&nbsp;p_e_row_id&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_e_column_id&nbsp;TYPE&nbsp;lvc_s_col.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_row_data&nbsp;TYPE&nbsp;ty_outtab_0100_top,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft8000-ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_fseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft8000-f_seq,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_fname&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xstring&nbsp;&nbsp;TYPE&nbsp;xstring.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_bin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;solix_tab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_len&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_fullpath&nbsp;TYPE&nbsp;string.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;#<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100_top&nbsp;INTO&nbsp;ls_row_data&nbsp;INDEX&nbsp;p_e_row_id.<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;lv_ccno&nbsp;=&nbsp;ls_row_data-ccno.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;####&nbsp;seq<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MAX(&nbsp;f_seq&nbsp;)&nbsp;INTO&nbsp;@lv_fseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8002<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;@lv_ccno.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;#/##<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;f_name,&nbsp;f_binary<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;(@lv_fname,&nbsp;@lv_xstring)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8002<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;ccno&nbsp;&nbsp;=&nbsp;@lv_ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;f_seq&nbsp;=&nbsp;@lv_fseq.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;lv_xstring&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;XSTRING&nbsp;-&gt;&nbsp;BINARY<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SCMS_XSTRING_TO_BINARY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_xstring<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_tab&nbsp;=&nbsp;lt_bin.<br />
&nbsp;&nbsp;lv_file_len&nbsp;=&nbsp;xstrlen(&nbsp;lv_xstring&nbsp;).<br />
<br />
&nbsp;&nbsp;"&nbsp;===&nbsp;ITS&nbsp;###&nbsp;WS_FILENAME_GET&nbsp;###&nbsp;##&nbsp;===<br />
&nbsp;&nbsp;DATA(lv_return)&nbsp;=&nbsp;space.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GUI_IS_ITS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;=&nbsp;lv_return.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;'X'&nbsp;=&nbsp;WebGUI<br />
<br />
&nbsp;&nbsp;DATA(lv_mode)&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;lv_return&nbsp;=&nbsp;'X'&nbsp;THEN&nbsp;'S'&nbsp;ELSE&nbsp;'O'&nbsp;).<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WS_FILENAME_GET'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_fname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###(###&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Web='S'&nbsp;/&nbsp;SAP&nbsp;GUI='O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'File&nbsp;Save'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_winsys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_batch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selection_cancel&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selection_error&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;lv_fullpath&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;cl_gui_frontend_services=&gt;gui_download(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filetype&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BIN'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_filesize&nbsp;=&nbsp;lv_file_len<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_tab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_bin&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_DATA_0200<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data_0200.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lt_outtab_0200&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0200.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;a~bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~werks,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w~name1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;wernm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l~name1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;lifnm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~budat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e~ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;ccngnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~maktx,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zdeno<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;t001w&nbsp;&nbsp;&nbsp;AS&nbsp;w&nbsp;ON&nbsp;a~werks&nbsp;=&nbsp;w~werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;lfa1&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;l&nbsp;ON&nbsp;a~lifnr&nbsp;=&nbsp;l~lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;makt&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;b&nbsp;ON&nbsp;a~matnr&nbsp;=&nbsp;b~matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~spras&nbsp;=&nbsp;@sy-langu<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zssloimtb500i&nbsp;AS&nbsp;c&nbsp;ON&nbsp;a~ebeln&nbsp;=&nbsp;c~ebeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zssloimtb500h&nbsp;AS&nbsp;d&nbsp;ON&nbsp;c~zdedn&nbsp;=&nbsp;d~zdedn<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zgft0003&nbsp;AS&nbsp;e<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;e~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~matnr&nbsp;=&nbsp;e~matnr<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~bukrs&nbsp;EQ&nbsp;@p_bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~werks&nbsp;IN&nbsp;@s_werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~matnr&nbsp;IN&nbsp;@s_matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~loekz&nbsp;EQ&nbsp;@zgftp_false<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~budat&nbsp;IN&nbsp;@s_budat<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;d~zipwdt&nbsp;IN&nbsp;@s_budat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~lifnr&nbsp;IN&nbsp;@s_lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~rcpty&nbsp;EQ&nbsp;'IMP'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;d~zdeno&nbsp;IS&nbsp;NOT&nbsp;INITIAL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;d~zdeno&nbsp;IN&nbsp;@s_zdeno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;NOT&nbsp;EXISTS&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8000&nbsp;AS&nbsp;x<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;zgft8001&nbsp;AS&nbsp;y&nbsp;ON&nbsp;x~ccno&nbsp;=&nbsp;y~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;x~bukrs&nbsp;=&nbsp;a~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~werks&nbsp;=&nbsp;a~werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~lifnr&nbsp;=&nbsp;a~lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;x~cctype&nbsp;=&nbsp;'C'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~budat&nbsp;BETWEEN&nbsp;x~datab&nbsp;AND&nbsp;x~datbi<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;y~mtroh&nbsp;=&nbsp;a~matnr&nbsp;)<br />
&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@lt_outtab_0200.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_outtab_0200&nbsp;BY&nbsp;bukrs&nbsp;lifnr&nbsp;matnr.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_outtab_0200&nbsp;COMPARING&nbsp;bukrs&nbsp;lifnr&nbsp;matnr.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_outtab_0200&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;fs_out&gt;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;d~zdeno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@&lt;fs_out&gt;-zdeno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0200&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zssloimtb500i&nbsp;AS&nbsp;c&nbsp;ON&nbsp;a~ebeln&nbsp;=&nbsp;c~ebeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zssloimtb500h&nbsp;AS&nbsp;d&nbsp;ON&nbsp;c~zdedn&nbsp;=&nbsp;d~zdedn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~bukrs&nbsp;=&nbsp;@&lt;fs_out&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~lifnr&nbsp;=&nbsp;@&lt;fs_out&gt;-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~matnr&nbsp;=&nbsp;@&lt;fs_out&gt;-matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~budat&nbsp;=&nbsp;@&lt;fs_out&gt;-budat.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_out&gt;-zdeno_5&nbsp;=&nbsp;&lt;fs_out&gt;-zdeno+0(5).<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_zcust_no_5&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;lt_outtab_0200&nbsp;WHERE&nbsp;zdeno_5&nbsp;&lt;&gt;&nbsp;gv_zcust_no_5.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;gt_outtab_0200[]&nbsp;=&nbsp;lt_outtab_0200[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_GRID_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container_top<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM1_TOP'.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container_bot<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM1_BOT'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid_top<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container_top<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid_bot<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container_bot<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat_0100&nbsp;TABLES&nbsp;gt_lvc_fcat_top<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat_bot.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0100.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_top&nbsp;gt_outtab_0100_top[]&nbsp;gt_lvc_fcat_top[].<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_bot&nbsp;gt_outtab_0100_bot[]&nbsp;gt_lvc_fcat_bot[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_GRID_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0110 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM_CONTAINER1'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_dropdown_list&nbsp;USING&nbsp;lcl_grid1.<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat_0110&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0110.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid1&nbsp;gt_outtab_0100[]&nbsp;gt_lvc_fcat[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;FORM_FCAT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_LVC_FCAT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM form_fcat_0110  TABLES pt_fcat_alv TYPE lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;pt_fcat_alv,&nbsp;pt_fcat_alv[].<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;1.&nbsp;BUKRS<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;1.&nbsp;Plant<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2.&nbsp;Vendor<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;3.&nbsp;Vendor&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LIFMN'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;4.&nbsp;IMP.&nbsp;Declaration&nbsp;Number<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'zdeno'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'zdeno'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;5.&nbsp;Material&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Material'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;6.&nbsp;HS&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'CCNGNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'HS'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'CCN'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;7.&nbsp;IMP.&nbsp;Declaration&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'budat'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Date'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;8.&nbsp;Start&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'DATAB'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Start'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'STDT'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;9.&nbsp;End&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'DATBI'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'End'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ENDT'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;10.&nbsp;Agreement&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PFONA'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'AGR'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;11.&nbsp;Origin&nbsp;Status<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'COFLGR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ORI'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;12.&nbsp;PSR<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PRULE'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;13.&nbsp;Non-Originating&nbsp;Reason<br />
*&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;13.<br />
*&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR'.<br />
*&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
*&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
*&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
*&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
*&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Reason'.<br />
*&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Reason'.<br />
*&nbsp;&nbsp;ls_fcat-tech&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
*&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
*&nbsp;13.&nbsp;Non-Originating&nbsp;Reason<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;13.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR_DIS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Reason'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;14.&nbsp;Non-Originating&nbsp;Text<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;14.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR_TXT'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Text'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;16.&nbsp;Land1<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;15.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Cty'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'5'.<br />
&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_GRID_0200<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0200 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM1'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat_0200&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0200.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid&nbsp;gt_outtab_0200[]&nbsp;gt_lvc_fcat[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_GRID_0210<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0210 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM_CONTAINER1'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_dropdown_list&nbsp;USING&nbsp;lcl_grid2.<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat_0210&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0210.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid2&nbsp;gt_outtab_0210[]&nbsp;gt_lvc_fcat[].<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_GRID_0300<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0300 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM_CONTAINER1'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat_0300&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0300.<br />
&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid3&nbsp;gt_outtab_0300[]&nbsp;gt_lvc_fcat[].<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_GRID<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM refresh_grid USING io_grid  TYPE REF TO cl_gui_alv_grid.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;io_grid-&gt;refresh_table_display.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;APPEND_EXCLUDE_FUNCTIONS<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;&lt;TABLE&gt;<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_UND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM append_exclude_functions   TABLES pt_table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;p_value&nbsp;&nbsp;TYPE&nbsp;&nbsp;any.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;ls_exclude&nbsp;TYPE&nbsp;ui_func.<br />
<br />
&nbsp;&nbsp;ls_exclude&nbsp;=&nbsp;p_value.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_exclude&nbsp;TO&nbsp;pt_table.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;LAYOUT_ATTRIBUTE_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GS_LAYO<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM layout_attribute  CHANGING ps_lvc_layo TYPE lvc_s_layo.<br />
<br />
&nbsp;&nbsp;ps_lvc_layo-cwidth_opt&nbsp;=&nbsp;'A'.&nbsp;&nbsp;"Optimize&nbsp;column&nbsp;width<br />
&nbsp;&nbsp;ps_lvc_layo-zebra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.&nbsp;&nbsp;"Alternating&nbsp;line&nbsp;color&nbsp;(striped)<br />
&nbsp;&nbsp;ps_lvc_layo-sel_mode&nbsp;&nbsp;&nbsp;=&nbsp;'D'.&nbsp;&nbsp;"Selection&nbsp;mode<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ps_lvc_layo-sel_mode&nbsp;&nbsp;&nbsp;=&nbsp;'A'.&nbsp;&nbsp;"Selection&nbsp;mode<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ps_lvc_layo-ctab_fname&nbsp;=&nbsp;'COLTAB'.<br />
&nbsp;&nbsp;ps_lvc_layo-stylefname&nbsp;=&nbsp;'CELLTAB'.<br />
&nbsp;&nbsp;ps_lvc_layo-smalltitle&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ps_lvc_layo-no_rowmark&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;ps_lvc_layo-no_merging&nbsp;=&nbsp;''.<br />
<br />
&nbsp;&nbsp;gs_variant-report&nbsp;=&nbsp;sy-repid.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;TOOLBAR_PART_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM toolbar_part  USING p_t_ui_functions.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;:&nbsp;&lt;table&gt;&nbsp;TYPE&nbsp;ui_functions.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;l_table_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;feld-name.<br />
<br />
&nbsp;&nbsp;CONCATENATE&nbsp;p_t_ui_functions&nbsp;'[]'&nbsp;INTO&nbsp;&nbsp;l_table_name.<br />
&nbsp;&nbsp;ASSIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(l_table_name)&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;&lt;table&gt;.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;append_exclude_functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES&nbsp;&nbsp;&lt;table&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;:&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_undo,&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_auf,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;????&nbsp;&AUF<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_AVERAGE,&nbsp;&nbsp;"&nbsp;&AVERAGE<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_back_classic,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CALL_ABC,&nbsp;"&nbsp;&ABC<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_chain,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_crbatch,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_crweb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_lineitems,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_master_data,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_more,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CALL_REPORT,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_xint,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CALL_XXL,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_col_invisible,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_col_optimize,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CURRENT_VARIANT,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_data_save,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_DELETE_FILTER,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_DESELECT_ALL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_DETAIL,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expcrdata,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expcrdesig,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expcrtempl,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expmdb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_extend,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_f4,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_FILTER,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_FIND,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_FIX_COLUMNS,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_graph,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_help,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_info,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOAD_VARIANT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_COPY,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;?&nbsp;??<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_html,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_copy_row,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;?&nbsp;??<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_cut,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;??<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_delete_row,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;???<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_insert_row,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;???<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_move_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_append_row,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;????<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_paste,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;????<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_paste_new_row,&nbsp;"&nbsp;????<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_MAINTAIN_VARIANT,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_maximum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_minimum,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PC_FILE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT_BACK,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT_PREV,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_reprep,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SAVE_VARIANT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SELECT_ALL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SEND,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SEPARATOR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SORT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SORT_ASC,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SORT_DSC,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SUBTOT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SUM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_TO_OFFICE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_TO_REP_TREE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_UNFIX_COLUMNS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEWS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEW_CRYSTAL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEW_EXCEL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEW_GRID,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_WORD_PROCESSOR,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_refresh,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_check.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;FORM_FCAT_0200<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM form_fcat_0200  TABLES pt_fcat_alv TYPE lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_pos&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;pt_fcat_alv,&nbsp;pt_fcat_alv[].<br />
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;1)&nbsp;Company&nbsp;Code&nbsp;(BUKRS)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'T001'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2)&nbsp;Plant&nbsp;(WERKS)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'T001W'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;3)&nbsp;Plant&nbsp;Name&nbsp;(WERNM)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'WERNM'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Plant&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Plant&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Plant&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'Name'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'T001W'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'LIFNM'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;35.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'Name'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;6)&nbsp;IMP.&nbsp;Declaration&nbsp;Number&nbsp;(ZDENO)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'ZDENO'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Declaration&nbsp;Number'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Declaration&nbsp;Number'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Dec.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'ZDENO'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;7)&nbsp;Material&nbsp;Code&nbsp;(MATNR)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;18.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Material'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'MARA'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;8)&nbsp;Material&nbsp;Name&nbsp;(MAKTX)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;40.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'Material&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'Mat.&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'MAKT'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;9)&nbsp;HS&nbsp;Code&nbsp;(CCNGNR)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'CCNGNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'HS'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'CCN'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;10)&nbsp;IMP.&nbsp;Declaration&nbsp;Date&nbsp;(BUDAT)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_pos&nbsp;=&nbsp;lv_pos&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_pos.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;=&nbsp;'BUDAT'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Declaration&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Declaration&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;=&nbsp;'Date'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;=&nbsp;'MKPF'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;=&nbsp;'BUDAT'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;FORM_FCAT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_LVC_FCAT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM form_fcat_0210  TABLES pt_fcat_alv TYPE lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;pt_fcat_alv,&nbsp;pt_fcat_alv[].<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;1.&nbsp;Company<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2.&nbsp;Plant<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;3.&nbsp;Vendor<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;4.&nbsp;Vendor&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNM'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;5.&nbsp;IMP.&nbsp;Declaration&nbsp;Number<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'ZDENO'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ZDENO'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;6.&nbsp;Material&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Material'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;7.&nbsp;HS&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'CCNGNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'HS'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'CCN'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;8.&nbsp;IMP.&nbsp;Declaration&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'BUDAT'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Date'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;9.&nbsp;Start&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'DATAB'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Start'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'STDT'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;10.&nbsp;End&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'DATBI'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'End'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ENDT'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;11.&nbsp;Agreement&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PFONA'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'AGR'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;12.&nbsp;Origin&nbsp;Status<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'COFLGR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ORI'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;13.&nbsp;PSR<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;13.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PRULE'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;14.&nbsp;Non-Originating&nbsp;Reason<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;14.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR_DIS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Reason'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;15.&nbsp;Non-Originating&nbsp;Text<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;15.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR_TXT'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Text'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;16.&nbsp;Land1<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Cty'.<br />
&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'5'.<br />
&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;FORM_FCAT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_LVC_FCAT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM form_fcat_0300  TABLES pt_fcat_alv TYPE lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;pt_fcat_alv,&nbsp;pt_fcat_alv[].<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;1.&nbsp;CO&nbsp;No.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'CCNO'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'CO&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'CO&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'CO&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'CO&nbsp;No.'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2.&nbsp;Company<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Company'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;3.&nbsp;Plant<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;4.&nbsp;Vendor<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;&nbsp;&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;5.&nbsp;Vendor&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LIFNM'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Name'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;6.&nbsp;IMP.&nbsp;Declaration&nbsp;Number<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'ZDENO'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No.'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ZDENO'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;7.&nbsp;Material&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Material'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;8.&nbsp;HS&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'CCNGNR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'HS'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'CCN'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;9.&nbsp;IMP.&nbsp;Declaration&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'BUDAT'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Date'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;10.&nbsp;Start&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'DATAB'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Start'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'STDT'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;11.&nbsp;End&nbsp;Date<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'DATBI'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'End'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ENDT'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;12.&nbsp;Agreement&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PFONA'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Agreement'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'AGR'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;13.&nbsp;Origin&nbsp;Status<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;13.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'COFLGR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'ORI'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;14.&nbsp;PSR<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;14.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PRULE'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'PSR'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;15.&nbsp;Non-Originating&nbsp;Reason<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;15.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Reason'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Reason'.<br />
&nbsp;&nbsp;ls_fcat-drdn_hndl&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
&nbsp;&nbsp;ls_fcat-drdn_alias&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;16.&nbsp;Non-Originating&nbsp;Text<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'OFFSHR_TXT'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Non-Originating&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Non-ORI&nbsp;Text'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Text'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;17.&nbsp;Land1<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;17.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Country'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Cty'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;18.&nbsp;Cust_No<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;18.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'CUST_CCNO'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Cust_No'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Cust_No'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Customer'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Cust'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;19.&nbsp;Status&nbsp;(ICON)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;19.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;ls_fcat-icon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Status'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;20.&nbsp;Error&nbsp;Message<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'MSG'.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;&nbsp;&nbsp;=&nbsp;40.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Error&nbsp;Message'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;&nbsp;&nbsp;=&nbsp;'Error&nbsp;Message'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;&nbsp;&nbsp;=&nbsp;'Error&nbsp;Msg'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;&nbsp;&nbsp;=&nbsp;'Error'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv.&nbsp;CLEAR&nbsp;ls_fcat.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_REGISTER_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0100 .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_top-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_bot-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_top-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_bot-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
*&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_toolbar&nbsp;FOR&nbsp;lcl_grid.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid_top.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid_top.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_double_click&nbsp;FOR&nbsp;lcl_grid_top.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_hotspot_click&nbsp;FOR&nbsp;lcl_grid_top.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid_bot.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid_bot.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_register_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0110 .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid1-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid1-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid1.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_register_0100<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0200 .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;FORM_FCAT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_LVC_FCAT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM form_fcat_0100  TABLES pt_fcat_alv_top TYPE lvc_t_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot&nbsp;TYPE&nbsp;lvc_t_fcat.<br />
&nbsp;&nbsp;DATA:&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat_bot&nbsp;type&nbsp;.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:&nbsp;pt_fcat_alv_top,&nbsp;pt_fcat_alv_top[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot,&nbsp;pt_fcat_alv_bot[].<br />
<br />
<br />
&nbsp;&nbsp;DEFINE&nbsp;add_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-fieldname&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-outputlen&nbsp;=&nbsp;&3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;&5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELD,&nbsp;POSTION,&nbsp;OUTPLEN,&nbsp;SCRTXT,&nbsp;FCAT.<br />
<br />
*&nbsp;TOP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;add_fcat&nbsp;'BUKRS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;6&nbsp;&nbsp;'Company&nbsp;Code'&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;add_fcat&nbsp;'CCNO'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;14&nbsp;'K&nbsp;Origin&nbsp;CO&nbsp;Number'&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;add_fcat&nbsp;'COTYPE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;10&nbsp;'C/O&nbsp;Type'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;add_fcat&nbsp;'WERKS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;4&nbsp;&nbsp;'Plant'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;ls_fcat-fieldname&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;ls_fcat-outputlen&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;=&nbsp;'Vendor&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;=&nbsp;'Vendor&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;=&nbsp;'Vendor&nbsp;Code'.<br />
&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;add_fcat&nbsp;'LIFNM'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;20&nbsp;'Vendor'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;ls_fcat-hotspot&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'F_NAME'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;20&nbsp;'Attach&nbsp;File'&nbsp;&nbsp;pt_fcat_alv_top.<br />
&nbsp;&nbsp;ls_fcat-convexit&nbsp;=&nbsp;'ALPHA'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'CUST_CCNO'&nbsp;&nbsp;8&nbsp;20&nbsp;'Supplier&nbsp;Origin&nbsp;NO'&nbsp;&nbsp;pt_fcat_alv_top.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;BOT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;add_fcat&nbsp;'BUKRS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;6&nbsp;&nbsp;'Company&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'zdeno'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;14&nbsp;'IMP.&nbsp;No'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'MATNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;14&nbsp;'Material&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'CCNGNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;8&nbsp;&nbsp;'HS&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'budat'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;10&nbsp;'IMP.&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'DATAB'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;10&nbsp;'Start&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'DATBI'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;10&nbsp;'End&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'PFONA'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;10&nbsp;'Agreement'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'COFLGR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;10&nbsp;&nbsp;'Origin&nbsp;Status'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'PRULE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;6&nbsp;&nbsp;'PSR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'OFFSHR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;16&nbsp;&nbsp;'Non-originating&nbsp;Reason'&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'OFFSHR_TXT'&nbsp;12&nbsp;20&nbsp;'Non-originating&nbsp;Text'&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
&nbsp;&nbsp;add_fcat&nbsp;'LAND1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;10&nbsp;'Country'&nbsp;&nbsp;&nbsp;pt_fcat_alv_bot.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_register_0210<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0210 .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid2-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid2-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_toolbar&nbsp;FOR&nbsp;lcl_grid2.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid2.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid2.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_register_0300<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0300 .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid3-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid3-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_toolbar&nbsp;FOR&nbsp;lcl_grid3.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid3.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid3.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
**&---------------------------------------------------------------------*<br />
**&&nbsp;Form&nbsp;ALV_DISPLAY_PART_0100<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;alv_display_part_0100&nbsp;.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid-&gt;set_table_for_first_display<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_toolbar_excluding&nbsp;=&nbsp;gt_ui_functions<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_default&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_SORT[]<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_outtab[]<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_lvc_fcat[].<br />
*<br />
*ENDFORM.<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_DISPLAY_PART_0210<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_display_part USING io_grid     TYPE REF TO cl_gui_alv_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcat&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;io_grid-&gt;set_table_for_first_display<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_toolbar_excluding&nbsp;=&nbsp;gt_ui_functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_default&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;it_outtab[]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;it_fieldcat[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
**&---------------------------------------------------------------------*<br />
**&&nbsp;Form&nbsp;ALV_DISPLAY_PART_0300<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;alv_display_part_0300&nbsp;.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid3-&gt;set_table_for_first_display<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_toolbar_excluding&nbsp;=&nbsp;gt_ui_functions<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_default&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_SORT[]<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_outtab_0300[]<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_lvc_fcat[].<br />
*<br />
*ENDFORM.<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_UCOMM<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;SENDER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_user_command   USING p_ucomm TYPE sy-ucomm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sender&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_gui_alv_grid.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;p_ucomm.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'INSL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;check_if_selected&nbsp;USING&nbsp;gc_ins&nbsp;CHANGING&nbsp;gv_answer.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;insert_new_row&nbsp;USING&nbsp;gc_ins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;refresh_grid&nbsp;USING&nbsp;lcl_grid2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DELL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;check_if_selected&nbsp;USING&nbsp;gc_del&nbsp;CHANGING&nbsp;gv_answer.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;delete_selected.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;refresh_grid&nbsp;USING&nbsp;lcl_grid2.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_OBJECT<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_INTERACTIVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_toolbar USING i_object TYPE REF TO cl_alv_event_toolbar_set<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_interactive&nbsp;.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_toolbar&nbsp;TYPE&nbsp;stb_button.<br />
<br />
&nbsp;&nbsp;IF&nbsp;g_dynnr&nbsp;&lt;&gt;&nbsp;103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_toolbar.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-function&nbsp;=&nbsp;'INSL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-butn_type&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-icon&nbsp;=&nbsp;icon_insert_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-quickinfo&nbsp;=&nbsp;'INSERT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-text&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-disabled&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_toolbar&nbsp;TO&nbsp;i_object-&gt;mt_toolbar.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_toolbar.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-function&nbsp;=&nbsp;'DELL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-butn_type&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-icon&nbsp;=&nbsp;icon_delete_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-quickinfo&nbsp;=&nbsp;'DELETE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-text&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-disabled&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_toolbar&nbsp;TO&nbsp;i_object-&gt;mt_toolbar.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_IF_SELECTED<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GV_ANSWER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_if_selected  USING pv_mode CHANGING pv_answer.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_selected&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;pv_answer.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_selected_rows.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid2-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;gt_selected_rows.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DELETE_SELECTED<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM delete_selected .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_outtab_0210&nbsp;TYPE&nbsp;ty_outtab_0210,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;lv_count&nbsp;=&nbsp;lines(&nbsp;gt_outtab_0210&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;###&nbsp;###&nbsp;##&nbsp;##&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;lv_count&nbsp;&lt;=&nbsp;lines(&nbsp;gt_selected_rows&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'At&nbsp;least&nbsp;one&nbsp;row&nbsp;must&nbsp;remain.&nbsp;Deletion&nbsp;canceled.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_selected_rows&nbsp;INTO&nbsp;DATA(ls_rows).<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;ls_outtab_0210&nbsp;INDEX&nbsp;ls_rows-index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_outtab_0210-deleted&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_outtab_0210&nbsp;FROM&nbsp;ls_outtab_0210&nbsp;INDEX&nbsp;ls_rows-index&nbsp;TRANSPORTING&nbsp;deleted.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;DELETE&nbsp;gt_outtab_0210&nbsp;WHERE&nbsp;deleted&nbsp;=&nbsp;abap_true.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_CELL_TAB_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM modify_cell_tab_0100.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0100&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;fs&gt;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;gt_celltab[],&nbsp;gs_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-pfona&nbsp;=&nbsp;'PKRGA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;OFFSHR<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'OFFSHR_DIS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-coflgr&nbsp;=&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;OFFSHR_TXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'OFFSHR_TXT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-coflgr&nbsp;=&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-celltab&nbsp;=&nbsp;gt_celltab[].<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_CELL_TAB_0210<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM modify_cell_tab_0210.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0210&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;fs&gt;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;gt_celltab[],&nbsp;gs_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-pfona&nbsp;=&nbsp;'PKRGA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;OFFSHR<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'OFFSHR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-coflgr&nbsp;=&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;OFFSHR_TXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'OFFSHR_TXT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-coflgr&nbsp;=&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-celltab&nbsp;=&nbsp;gt_celltab[].<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_DATA_CHANGED<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_DATA_CHANGED<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_data_changed USING       rr_data_changed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_alv_changed_data_protocol.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;ls_mod&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_modi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cells&nbsp;TYPE&nbsp;lvc_s_modi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_value&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_psr_dropdown&nbsp;TYPE&nbsp;lvc_t_dral,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_dral.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ccngn_try&nbsp;TYPE&nbsp;zgft0001-ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_rct&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;zgft0001-rct&nbsp;WITH&nbsp;EMPTY&nbsp;KEY.<br />
<br />
&nbsp;&nbsp;IF&nbsp;g_dynnr&nbsp;=&nbsp;101.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;rr_data_changed-&gt;mt_good_cells&nbsp;INTO&nbsp;ls_mod.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;ls_mod-fieldname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PFONA'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100&nbsp;INTO&nbsp;DATA(ls_row_0100)&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_pfona)&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_psr_dropdown,&nbsp;ls_dropdown,&nbsp;ls_dropdown-int_value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;TIMES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;=&nbsp;sy-index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn_try&nbsp;=&nbsp;ls_row_0100-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn_try&nbsp;=&nbsp;ls_row_0100-ccngnr(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn_try&nbsp;=&nbsp;ls_row_0100-ccngnr(2).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;rct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@DATA(lt_rct_partial)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@ls_row_0100-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;=&nbsp;@lv_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngn&nbsp;=&nbsp;@lv_ccngn_try.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_rct_partial&nbsp;INTO&nbsp;ls_dropdown-int_value.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;=&nbsp;ls_dropdown-int_value.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;ls_dropdown&nbsp;INTO&nbsp;lt_psr_dropdown.&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid1-&gt;set_drop_down_table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_drop_down_alias&nbsp;=&nbsp;lt_psr_dropdown.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DATAB'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100&nbsp;INTO&nbsp;ls_row_0100&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_cctype&nbsp;=&nbsp;'C'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_datab)&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;NOT&nbsp;(&nbsp;lv_datab&nbsp;&lt;=&nbsp;ls_row_0100-budat&nbsp;AND&nbsp;ls_row_0100-budat&nbsp;&lt;=&nbsp;ls_row_0100-datbi&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Import&nbsp;Date&nbsp;must&nbsp;be&nbsp;between&nbsp;Start&nbsp;Date&nbsp;and&nbsp;End&nbsp;Date.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DATBI'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100&nbsp;INTO&nbsp;ls_row_0100&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_cctype&nbsp;=&nbsp;'C'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_datbi)&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;NOT&nbsp;(&nbsp;ls_row_0100-datab&nbsp;&lt;=&nbsp;ls_row_0100-budat&nbsp;AND&nbsp;ls_row_0100-budat&nbsp;&lt;=&nbsp;lv_datbi&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Import&nbsp;Date&nbsp;must&nbsp;be&nbsp;between&nbsp;Start&nbsp;Date&nbsp;and&nbsp;End&nbsp;Date.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'OFFSHR_DIS'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100&nbsp;INTO&nbsp;ls_row_0100&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLIT&nbsp;ls_mod-value&nbsp;AT&nbsp;space&nbsp;INTO&nbsp;DATA(lv_offshr)&nbsp;DATA(lv_offshr_text).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_0100-offshr&nbsp;=&nbsp;lv_offshr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_outtab_0100&nbsp;FROM&nbsp;ls_row_0100&nbsp;INDEX&nbsp;ls_mod-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;offshr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;g_dynnr&nbsp;=&nbsp;102.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;rr_data_changed-&gt;mt_good_cells&nbsp;INTO&nbsp;ls_mod.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;ls_mod-fieldname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PFONA'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;DATA(ls_row_0210)&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_pfona&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_psr_dropdown,&nbsp;ls_dropdown,&nbsp;ls_dropdown-int_value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;TIMES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;=&nbsp;sy-index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn_try&nbsp;=&nbsp;ls_row_0210-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn_try&nbsp;=&nbsp;ls_row_0210-ccngnr(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn_try&nbsp;=&nbsp;ls_row_0210-ccngnr(2).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;rct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@lt_rct_partial<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@ls_row_0210-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;=&nbsp;@lv_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngn&nbsp;=&nbsp;@lv_ccngn_try.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_rct_partial&nbsp;INTO&nbsp;ls_dropdown-int_value.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;=&nbsp;ls_dropdown-int_value.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;ls_dropdown&nbsp;INTO&nbsp;lt_psr_dropdown.&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid2-&gt;set_drop_down_table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_drop_down_alias&nbsp;=&nbsp;lt_psr_dropdown.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DATAB'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;ls_row_0210&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_cctype&nbsp;=&nbsp;'C'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_datab&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;NOT&nbsp;(&nbsp;lv_datab&nbsp;&lt;=&nbsp;ls_row_0210-budat&nbsp;AND&nbsp;ls_row_0210-budat&nbsp;&lt;=&nbsp;ls_row_0210-datbi&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Import&nbsp;Date&nbsp;must&nbsp;be&nbsp;between&nbsp;Start&nbsp;Date&nbsp;and&nbsp;End&nbsp;Date.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DATBI'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;ls_row_0210&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_cctype&nbsp;=&nbsp;'C'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_datbi&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;NOT&nbsp;(&nbsp;ls_row_0210-datab&nbsp;&lt;=&nbsp;ls_row_0210-budat&nbsp;AND&nbsp;ls_row_0210-budat&nbsp;&lt;=&nbsp;lv_datbi&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Import&nbsp;Date&nbsp;must&nbsp;be&nbsp;between&nbsp;Start&nbsp;Date&nbsp;and&nbsp;End&nbsp;Date.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'OFFSHR_DIS'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;ls_row_0210&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLIT&nbsp;ls_mod-value&nbsp;AT&nbsp;space&nbsp;INTO&nbsp;lv_offshr&nbsp;lv_offshr_text.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_0210-offshr&nbsp;=&nbsp;lv_offshr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_outtab_0210&nbsp;FROM&nbsp;ls_row_0210&nbsp;INDEX&nbsp;ls_mod-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;offshr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INSERT_NEW_ROW<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GC_INS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM insert_new_row  USING    pv_mode.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_outtab_0210.<br />
&nbsp;&nbsp;CLEAR:&nbsp;gv_saved.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_lines&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_maxindex&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rows&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_outtab_0210&nbsp;TYPE&nbsp;ty_outtab_0210.<br />
<br />
&nbsp;&nbsp;lv_lines&nbsp;=&nbsp;lines(&nbsp;gt_selected_rows[]&nbsp;).<br />
<br />
&nbsp;&nbsp;CASE&nbsp;pv_mode.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;gc_ins.<br />
   </div>
   <div class="codeComment">
*&nbsp;---&nbsp;insert&nbsp;at&nbsp;the&nbsp;top&nbsp;when&nbsp;no&nbsp;row&nbsp;is&nbsp;selected<br />
*&nbsp;---&nbsp;insert&nbsp;above&nbsp;the&nbsp;selected&nbsp;row&nbsp;when&nbsp;a&nbsp;row&nbsp;is&nbsp;selected<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;gs_outtab_0210,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_saved.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_lines&nbsp;=&nbsp;lines(&nbsp;gt_selected_rows&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_lines&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.&nbsp;"###&nbsp;##&nbsp;###&nbsp;##&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_selected_rows&nbsp;INTO&nbsp;ls_rows.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;ls_outtab_0210&nbsp;INDEX&nbsp;ls_rows-index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-bukrs.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;company&nbsp;code<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-werks.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;plant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-lifnr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;vendor<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-lifnm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-lifnm.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;vendor&nbsp;name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-zdeno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-zdeno.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;IMP.&nbsp;No<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-matnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-matnr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;material&nbsp;code<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-ccngnr.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;HS&nbsp;code<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-budat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-budat.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;IMP&nbsp;date<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-datab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-datab.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;start&nbsp;date<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-datbi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab_0210-datbi.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;end&nbsp;date<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-appended&nbsp;&nbsp;=&nbsp;abap_true.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;###&nbsp;##&nbsp;###&nbsp;#&nbsp;##&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;gs_outtab_0210&nbsp;INTO&nbsp;gt_outtab_0210&nbsp;INDEX&nbsp;ls_rows-index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_SORTS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_alv_sorts .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_sort,&nbsp;gt_sort,&nbsp;gt_sort[].<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;sort_proc&nbsp;USING&nbsp;'1'&nbsp;&nbsp;'CCNGN'&nbsp;&nbsp;'X'&nbsp;''&nbsp;''.<br />
&nbsp;&nbsp;PERFORM&nbsp;sort_proc&nbsp;USING&nbsp;'2'&nbsp;&nbsp;'F_NAME'&nbsp;&nbsp;'X'&nbsp;''&nbsp;''.<br />
<br />
ENDFORM.                    " ALV_SORTS<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;sort_proc<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM sort_proc USING    p_spos<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_fname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_up<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_down<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_subtot.<br />
<br />
&nbsp;&nbsp;gs_sort-spos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_spos.<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;p_fname.<br />
&nbsp;&nbsp;gs_sort-up&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_up.<br />
&nbsp;&nbsp;gs_sort-down&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_down.<br />
&nbsp;&nbsp;gs_sort-subtot&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_subtot.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort&nbsp;TO&nbsp;gt_sort.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_INIT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_init .<br />
<br />
&nbsp;&nbsp;pbukrs2&nbsp;=&nbsp;'Comapany&nbsp;Code'.<br />
&nbsp;&nbsp;sccno&nbsp;&nbsp;&nbsp;=&nbsp;'K&nbsp;Origin&nbsp;CO&nbsp;Number'.<br />
&nbsp;&nbsp;scucc&nbsp;&nbsp;&nbsp;=&nbsp;'Supplier&nbsp;CO&nbsp;Number'.<br />
&nbsp;&nbsp;sbudat2&nbsp;=&nbsp;'IMP&nbsp;Declaration&nbsp;Date'.<br />
&nbsp;&nbsp;szdeno2&nbsp;=&nbsp;'IMP&nbsp;Declaration&nbsp;Number'.<br />
&nbsp;&nbsp;smatnr2&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;swerks2&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;slifnr2&nbsp;=&nbsp;'Vendor'.<br />
&nbsp;&nbsp;sidate&nbsp;&nbsp;=&nbsp;'Create&nbsp;Date'.<br />
<br />
&nbsp;&nbsp;pbukrs&nbsp;&nbsp;=&nbsp;'Company&nbsp;Code'.<br />
&nbsp;&nbsp;pfile1&nbsp;&nbsp;=&nbsp;'Excel&nbsp;Upload'.<br />
&nbsp;&nbsp;sbudat&nbsp;&nbsp;=&nbsp;'IMP&nbsp;Declaration&nbsp;Date'.<br />
&nbsp;&nbsp;szdeno&nbsp;&nbsp;=&nbsp;'IMP&nbsp;Declaration&nbsp;Number'.<br />
&nbsp;&nbsp;smatnr&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;swerks&nbsp;&nbsp;=&nbsp;'Plant'.<br />
&nbsp;&nbsp;slifnr&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCEL_DOWNLOAD<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM excel_download_0100.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_row_index&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_index&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_row&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cnt&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_down_0100.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"Title<br />
*&nbsp;&nbsp;gs_down_0100-text1&nbsp;&nbsp;=&nbsp;'Company&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0100-text2&nbsp;&nbsp;=&nbsp;'K&nbsp;Origin&nbsp;CO&nbsp;No'.<br />
*&nbsp;&nbsp;gs_down_0100-text3&nbsp;&nbsp;=&nbsp;'C/O&nbsp;Type'.<br />
*&nbsp;&nbsp;gs_down_0100-text4&nbsp;&nbsp;=&nbsp;'Plant'.<br />
*&nbsp;&nbsp;gs_down_0100-text5&nbsp;&nbsp;=&nbsp;'Vendor&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0100-text6&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
*&nbsp;&nbsp;gs_down_0100-text7&nbsp;&nbsp;=&nbsp;'Attach&nbsp;File'.<br />
*&nbsp;&nbsp;gs_down_0100-text8&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No'.<br />
*&nbsp;&nbsp;gs_down_0100-text9&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0100-text10&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0100-text11&nbsp;=&nbsp;'Start&nbsp;Date'.<br />
*&nbsp;&nbsp;gs_down_0100-text12&nbsp;=&nbsp;'End&nbsp;Date'.<br />
*&nbsp;&nbsp;gs_down_0100-text13&nbsp;=&nbsp;'Agreement'.<br />
*&nbsp;&nbsp;gs_down_0100-text14&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
*&nbsp;&nbsp;gs_down_0100-text15&nbsp;=&nbsp;'PSR'.<br />
*&nbsp;&nbsp;gs_down_0100-text16&nbsp;=&nbsp;'Non-originating&nbsp;Reason'.<br />
*&nbsp;&nbsp;gs_down_0100-text17&nbsp;=&nbsp;'Country'.<br />
*&nbsp;&nbsp;gs_down_0100-text18&nbsp;=&nbsp;'Supplier&nbsp;CO&nbsp;No'.<br />
*&nbsp;&nbsp;APPEND&nbsp;gs_down_0100&nbsp;TO&nbsp;gt_down_0100.<br />
*&nbsp;&nbsp;CLEAR&nbsp;gs_down_0100.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;lt_fcat&nbsp;TYPE&nbsp;lvc_t_fcat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;DEFINE&nbsp;add_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-fieldname&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;=&nbsp;&2.<br />
   </div>
   <div class="codeComment">
*&nbsp;ls_fcat-outputlen&nbsp;=&nbsp;&3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;#&nbsp;##<br />
*&nbsp;ls_fcat-just&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'L'.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;L/R/C&nbsp;##&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;lt_fcat.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;lt_fcat,&nbsp;lt_fcat[].<br />
<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT1'&nbsp;&nbsp;'Company&nbsp;Code'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT2'&nbsp;&nbsp;'K&nbsp;Origin&nbsp;CO&nbsp;No'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT3'&nbsp;&nbsp;'C/O&nbsp;Type'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT4'&nbsp;&nbsp;'Plant'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT5'&nbsp;&nbsp;'Vendor&nbsp;Code'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT6'&nbsp;&nbsp;'Vendor'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT7'&nbsp;&nbsp;'Attach&nbsp;File'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT8'&nbsp;&nbsp;'IMP.&nbsp;No'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT9'&nbsp;&nbsp;'Material&nbsp;Code'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT10'&nbsp;'HS&nbsp;Code'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT11'&nbsp;'Start&nbsp;Date'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT12'&nbsp;'End&nbsp;Date'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT13'&nbsp;'Agreement'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT14'&nbsp;'Origin&nbsp;Status'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT15'&nbsp;'PSR'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT16'&nbsp;'Non-originating&nbsp;Reason'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT17'&nbsp;'Country'.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT18'&nbsp;'Supplier&nbsp;CO&nbsp;No'.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_top-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_row_index.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;lt_row_index&nbsp;LINES&nbsp;lv_cnt.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_cnt&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;###&nbsp;###&nbsp;######.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s005&nbsp;DISPLAY&nbsp;LIKE&nbsp;zkgtp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100_top&nbsp;INTO&nbsp;gs_outtab_0100_top&nbsp;INDEX&nbsp;l_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;a~bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~cotype,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~werks,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~name1&nbsp;&nbsp;&nbsp;AS&nbsp;lifnm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~f_name,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zdeno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~mtroh&nbsp;&nbsp;&nbsp;AS&nbsp;matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~ccngnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~datab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~datbi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~coflgr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~offshr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~offshr_txt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_excel_0100<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8000&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zgft8001&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;b~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;b~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;lfa1&nbsp;AS&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~lifnr&nbsp;=&nbsp;c~lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zgft8002&nbsp;AS&nbsp;d<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;d~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;d~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~bukrs&nbsp;=&nbsp;@gs_outtab_0100_top-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;@gs_outtab_0100_top-ccno.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_excel_0100&nbsp;INTO&nbsp;gs_excel_0100.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text1&nbsp;&nbsp;=&nbsp;gs_excel_0100-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text2&nbsp;&nbsp;=&nbsp;gs_excel_0100-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text3&nbsp;&nbsp;=&nbsp;gs_excel_0100-cotype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text4&nbsp;&nbsp;=&nbsp;gs_excel_0100-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text5&nbsp;&nbsp;=&nbsp;gs_excel_0100-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text6&nbsp;&nbsp;=&nbsp;gs_excel_0100-lifnm.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text7&nbsp;&nbsp;=&nbsp;gs_excel_0100-f_name.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text8&nbsp;&nbsp;=&nbsp;gs_excel_0100-zdeno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text9&nbsp;&nbsp;=&nbsp;gs_excel_0100-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text10&nbsp;=&nbsp;gs_excel_0100-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text11&nbsp;=&nbsp;gs_excel_0100-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text12&nbsp;=&nbsp;gs_excel_0100-datbi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text13&nbsp;=&nbsp;gs_excel_0100-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text14&nbsp;=&nbsp;gs_excel_0100-coflgr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text15&nbsp;=&nbsp;gs_excel_0100-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text16&nbsp;=&nbsp;gs_excel_0100-offshr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text17&nbsp;=&nbsp;gs_excel_0100-land1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0100-text18&nbsp;=&nbsp;gs_excel_0100-cust_ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_down_0100&nbsp;TO&nbsp;gt_down_0100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_down_0100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;PERFORM&nbsp;excel_save&nbsp;USING&nbsp;gt_down_0100.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;excel_save_xlsx&nbsp;USING&nbsp;gt_down_0100&nbsp;lt_fcat.<br />
<br />
ENDFORM. " EXCEL_DOWNLOAD<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCEL_DOWNLOAD_0200<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM excel_download_0200.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_row_index&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_index&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_row&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cnt&nbsp;TYPE&nbsp;i.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq&nbsp;TYPE&nbsp;i.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_zkgt0550&nbsp;TYPE&nbsp;zkgt0550,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0500&nbsp;TYPE&nbsp;zkgt0500,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0501&nbsp;TYPE&nbsp;zkgt0501.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;lifnr&nbsp;WITH&nbsp;DEFAULT&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_lifnr_count&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_down_0200[],&nbsp;gs_down_0200,&nbsp;lt_lifnr[],&nbsp;lv_lifnr_count.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"Title<br />
*&nbsp;&nbsp;gs_down_0200-text1&nbsp;&nbsp;=&nbsp;'Company&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0200-text2&nbsp;&nbsp;=&nbsp;'Plant'.<br />
*&nbsp;&nbsp;gs_down_0200-text3&nbsp;&nbsp;=&nbsp;'Vendor'.<br />
*&nbsp;&nbsp;gs_down_0200-text4&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;No'.<br />
*&nbsp;&nbsp;gs_down_0200-text5&nbsp;&nbsp;=&nbsp;'Material&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0200-text6&nbsp;&nbsp;=&nbsp;'HS&nbsp;Code'.<br />
*&nbsp;&nbsp;gs_down_0200-text7&nbsp;&nbsp;=&nbsp;'IMP.&nbsp;Date'.<br />
*&nbsp;&nbsp;gs_down_0200-text8&nbsp;&nbsp;=&nbsp;'CC&nbsp;Type'.<br />
*&nbsp;&nbsp;gs_down_0200-text9&nbsp;&nbsp;=&nbsp;'Agreement&nbsp;Name'.<br />
*&nbsp;&nbsp;gs_down_0200-text10&nbsp;=&nbsp;'Origin&nbsp;Status'.<br />
*&nbsp;&nbsp;gs_down_0200-text11&nbsp;=&nbsp;'PSR'.<br />
*&nbsp;&nbsp;gs_down_0200-text12&nbsp;=&nbsp;'Non-originating&nbsp;Reason'.<br />
*&nbsp;&nbsp;gs_down_0200-text13&nbsp;=&nbsp;'Non-originating&nbsp;Text'.<br />
*&nbsp;&nbsp;gs_down_0200-text14&nbsp;=&nbsp;'Country'.<br />
*&nbsp;&nbsp;gs_down_0200-text15&nbsp;=&nbsp;'CO&nbsp;Group(Customer&nbsp;Co)'.<br />
*&nbsp;&nbsp;APPEND&nbsp;gs_down_0200&nbsp;TO&nbsp;gt_down_0200.<br />
*&nbsp;&nbsp;CLEAR&nbsp;gs_down_0200.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;lt_fcat&nbsp;TYPE&nbsp;lvc_t_fcat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;DEFINE&nbsp;add_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-fieldname&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-outputlen&nbsp;=&nbsp;&3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;lt_fcat.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;lt_fcat,&nbsp;lt_fcat[].<br />
<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT1'&nbsp;&nbsp;'Company&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT2'&nbsp;&nbsp;'Plant'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT3'&nbsp;&nbsp;'Vendor'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT4'&nbsp;&nbsp;'IMP.&nbsp;No'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT5'&nbsp;&nbsp;'Material&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT6'&nbsp;&nbsp;'HS&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT7'&nbsp;&nbsp;'IMP.&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT8'&nbsp;&nbsp;'CC&nbsp;Type'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT9'&nbsp;&nbsp;'Agreement&nbsp;Name'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT10'&nbsp;'Origin&nbsp;Status'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT11'&nbsp;'PSR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT12'&nbsp;'Non-originating&nbsp;Reason'&nbsp;&nbsp;&nbsp;&nbsp;28.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT13'&nbsp;'Non-originating&nbsp;Text'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT14'&nbsp;'Country'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT15'&nbsp;'CO&nbsp;Group(Customer&nbsp;Co)'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_row_index.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0200&nbsp;INTO&nbsp;gs_outtab_0200&nbsp;INDEX&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_outtab_0200-lifnr&nbsp;TO&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_lifnr.<br />
<br />
&nbsp;&nbsp;lv_lifnr_count&nbsp;=&nbsp;lines(&nbsp;lt_lifnr&nbsp;).<br />
&nbsp;&nbsp;IF&nbsp;lv_lifnr_count&nbsp;&gt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Please&nbsp;select&nbsp;only&nbsp;one&nbsp;vendor.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;lt_row_index&nbsp;LINES&nbsp;lv_cnt.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_cnt&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;###&nbsp;###&nbsp;######.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s005&nbsp;DISPLAY&nbsp;LIKE&nbsp;zkgtp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lv_seq.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0200&nbsp;INTO&nbsp;gs_outtab_0200&nbsp;INDEX&nbsp;l_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text1&nbsp;&nbsp;=&nbsp;gs_outtab_0200-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text2&nbsp;&nbsp;=&nbsp;gs_outtab_0200-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text3&nbsp;&nbsp;=&nbsp;gs_outtab_0200-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text4&nbsp;&nbsp;=&nbsp;gs_outtab_0200-zdeno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text5&nbsp;&nbsp;=&nbsp;gs_outtab_0200-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text6&nbsp;&nbsp;=&nbsp;gs_outtab_0200-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text7&nbsp;&nbsp;=&nbsp;gs_outtab_0200-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text8&nbsp;&nbsp;=&nbsp;'N'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_down_0200&nbsp;TO&nbsp;gt_down_0200.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_down_0200.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;PERFORM&nbsp;excel_save&nbsp;USING&nbsp;gt_down_0200.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;excel_save_xlsx&nbsp;USING&nbsp;gt_down_0200&nbsp;lt_fcat.<br />
<br />
ENDFORM. " EXCEL_downLOAD_0200<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCEL_DOWNLOAD_0200<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM excel_download_0200_t.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_row_index&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_index&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_row&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cnt&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_zkgt0550&nbsp;TYPE&nbsp;zkgt0550,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0500&nbsp;TYPE&nbsp;zkgt0500,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0501&nbsp;TYPE&nbsp;zkgt0501.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;lifnr&nbsp;WITH&nbsp;DEFAULT&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_lifnr_count&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_down_0200[],&nbsp;gs_down_0200,&nbsp;lt_lifnr[],&nbsp;lv_lifnr_count.<br />
<br />
&nbsp;&nbsp;"===&nbsp;FCAT&nbsp;##&nbsp;(##)&nbsp;=================================================<br />
&nbsp;&nbsp;DATA:&nbsp;lt_fcat&nbsp;TYPE&nbsp;lvc_t_fcat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;DEFINE&nbsp;add_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-fieldname&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-outputlen&nbsp;=&nbsp;&3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;lt_fcat.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;lt_fcat.<br />
<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT1'&nbsp;&nbsp;'Company&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT2'&nbsp;&nbsp;'Plant'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT3'&nbsp;&nbsp;'Vendor'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT4'&nbsp;&nbsp;'IMP.&nbsp;No'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT5'&nbsp;&nbsp;'Material&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT6'&nbsp;&nbsp;'HS&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT7'&nbsp;&nbsp;'IMP.&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT8'&nbsp;&nbsp;'CC&nbsp;Type'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT9'&nbsp;&nbsp;'Agreement&nbsp;Name'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT10'&nbsp;'Origin&nbsp;Status'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT11'&nbsp;'PSR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT12'&nbsp;'Non-originating&nbsp;Reason'&nbsp;&nbsp;&nbsp;&nbsp;28.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT13'&nbsp;'Non-originating&nbsp;Text'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT14'&nbsp;'Country'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT15'&nbsp;'CO&nbsp;Group(Customer&nbsp;Co)'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24.<br />
&nbsp;&nbsp;"&nbsp;###/###&nbsp;##&nbsp;##(17#)<br />
&nbsp;&nbsp;add_fcat&nbsp;'TEXT17'&nbsp;'Test'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.<br />
<br />
&nbsp;&nbsp;"===&nbsp;##&nbsp;#&nbsp;##&nbsp;=====================================================<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_row_index.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0200&nbsp;INTO&nbsp;gs_outtab_0200&nbsp;INDEX&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_outtab_0200-lifnr&nbsp;TO&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;lv_lifnr_count&nbsp;=&nbsp;lines(&nbsp;lt_lifnr&nbsp;).<br />
&nbsp;&nbsp;IF&nbsp;lv_lifnr_count&nbsp;&gt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Please&nbsp;select&nbsp;only&nbsp;one&nbsp;vendor.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;lt_row_index&nbsp;LINES&nbsp;lv_cnt.<br />
&nbsp;&nbsp;IF&nbsp;lv_cnt&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s005&nbsp;DISPLAY&nbsp;LIKE&nbsp;zkgtp_e.&nbsp;&nbsp;"##&nbsp;###&nbsp;###&nbsp;######.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DO&nbsp;10&nbsp;TIMES.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text17&nbsp;=&nbsp;'a'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_down_0200&nbsp;TO&nbsp;gt_down_0200.<br />
&nbsp;&nbsp;ENDDO.<br />
<br />
&nbsp;&nbsp;"===&nbsp;2)&nbsp;##&nbsp;##&nbsp;####&nbsp;11###&nbsp;##&nbsp;(MODIFY&nbsp;INDEX)&nbsp;===============<br />
&nbsp;&nbsp;DATA&nbsp;lv_base&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
&nbsp;&nbsp;DATA&nbsp;lv_target&nbsp;TYPE&nbsp;i.<br />
&nbsp;&nbsp;lv_base&nbsp;=&nbsp;lines(&nbsp;gt_down_0200&nbsp;).&nbsp;&nbsp;&nbsp;"&nbsp;=&nbsp;10<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0200&nbsp;INTO&nbsp;gs_outtab_0200&nbsp;INDEX&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_down_0200.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text1&nbsp;&nbsp;=&nbsp;gs_outtab_0200-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text2&nbsp;&nbsp;=&nbsp;gs_outtab_0200-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text3&nbsp;&nbsp;=&nbsp;gs_outtab_0200-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text4&nbsp;&nbsp;=&nbsp;gs_outtab_0200-zdeno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text5&nbsp;&nbsp;=&nbsp;gs_outtab_0200-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text6&nbsp;&nbsp;=&nbsp;gs_outtab_0200-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text7&nbsp;&nbsp;=&nbsp;gs_outtab_0200-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_down_0200-text8&nbsp;&nbsp;=&nbsp;'N'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_target&nbsp;=&nbsp;lv_base&nbsp;+&nbsp;sy-tabix.&nbsp;&nbsp;&nbsp;"&nbsp;11##&nbsp;1#&nbsp;##<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_target&nbsp;&lt;=&nbsp;lines(&nbsp;gt_down_0200&nbsp;).<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_down_0200&nbsp;FROM&nbsp;gs_down_0200&nbsp;INDEX&nbsp;sy-tabix.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_down_0200&nbsp;TO&nbsp;gt_down_0200.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"===&nbsp;##&nbsp;=============================================================<br />
&nbsp;&nbsp;PERFORM&nbsp;excel_save_xlsx&nbsp;USING&nbsp;gt_down_0200&nbsp;lt_fcat.<br />
<br />
ENDFORM. " EXCEL_DOWNLOAD_0200<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCEL_SAVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM excel_save<br />
&nbsp;&nbsp;USING&nbsp;pt_tab&nbsp;TYPE&nbsp;ANY&nbsp;TABLE.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS:&nbsp;&lt;lt_data&gt;&nbsp;TYPE&nbsp;ANY&nbsp;TABLE.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_fullpath&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;c&nbsp;LENGTH&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_return&nbsp;&nbsp;&nbsp;TYPE&nbsp;c&nbsp;LENGTH&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ftype&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;char10&nbsp;VALUE&nbsp;'DAT'.<br />
<br />
&nbsp;&nbsp;ASSIGN&nbsp;pt_tab&nbsp;TO&nbsp;&lt;lt_data&gt;.<br />
&nbsp;&nbsp;IF&nbsp;&lt;lt_data&gt;&nbsp;IS&nbsp;NOT&nbsp;ASSIGNED&nbsp;OR&nbsp;&lt;lt_data&gt;&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GUI_IS_ITS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;=&nbsp;lv_return.&nbsp;&nbsp;&nbsp;"&nbsp;'X'&nbsp;=&nbsp;WebGUI<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_return&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_mode&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_mode&nbsp;=&nbsp;'O'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DATA(lv_def)&nbsp;=&nbsp;'CO_EXCEL'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WS_FILENAME_GET'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_def<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;space<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_winsys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_batch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selection_cancel&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selection_error&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;lv_fullpath&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_return&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_fullpath&nbsp;=&nbsp;lv_fullpath&nbsp;&&&nbsp;'XLS'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_fullpath&nbsp;=&nbsp;lv_fullpath&nbsp;&&&nbsp;'.XLS'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;cl_gui_frontend_services=&gt;gui_download<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filetype&nbsp;=&nbsp;lv_ftype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codepage&nbsp;=&nbsp;'8500'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_tab&nbsp;=&nbsp;&lt;lt_data&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCEL_SAVE_XLSX_USING_SALV<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM excel_save_xlsx<br />
&nbsp;&nbsp;USING&nbsp;pt_tab&nbsp;&nbsp;TYPE&nbsp;ANY&nbsp;TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat&nbsp;TYPE&nbsp;lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS:&nbsp;&lt;lt_data&gt;&nbsp;TYPE&nbsp;ANY&nbsp;TABLE.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_is_web&nbsp;TYPE&nbsp;c&nbsp;LENGTH&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_mode&nbsp;&nbsp;&nbsp;TYPE&nbsp;c&nbsp;LENGTH&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_full&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_size&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_bin&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;solix_tab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xstr&nbsp;&nbsp;&nbsp;TYPE&nbsp;xstring.<br />
<br />
&nbsp;&nbsp;ASSIGN&nbsp;pt_tab&nbsp;TO&nbsp;&lt;lt_data&gt;.<br />
&nbsp;&nbsp;IF&nbsp;&lt;lt_data&gt;&nbsp;IS&nbsp;NOT&nbsp;ASSIGNED&nbsp;OR&nbsp;&lt;lt_data&gt;&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;zcl_itab_to_excel=&gt;conv_excel(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_itab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;lt_data&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcat&nbsp;=&nbsp;pt_fcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_excel&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;XLSX<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev_xstring&nbsp;&nbsp;=&nbsp;lv_xstr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_size<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev_bintab&nbsp;&nbsp;&nbsp;=&nbsp;lt_bin&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_xstr&nbsp;IS&nbsp;INITIAL&nbsp;OR&nbsp;lv_size&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GUI_IS_ITS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;=&nbsp;lv_is_web.&nbsp;&nbsp;&nbsp;"&nbsp;'X'&nbsp;=&nbsp;WebGUI<br />
&nbsp;&nbsp;lv_mode&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;lv_is_web&nbsp;=&nbsp;'X'&nbsp;THEN&nbsp;'S'&nbsp;ELSE&nbsp;'O'&nbsp;).<br />
<br />
&nbsp;&nbsp;DATA(lv_defname)&nbsp;=&nbsp;'CO_Excel.xlsx'.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WS_FILENAME_GET'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_filename&nbsp;=&nbsp;lv_defname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Save&nbsp;CO_Excel'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_full<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;lv_full&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_full&nbsp;NP&nbsp;'*.xlsx'&nbsp;AND&nbsp;lv_full&nbsp;NP&nbsp;'*.XLSX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_is_web&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_full&nbsp;=&nbsp;lv_full&nbsp;&&&nbsp;'XLSX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_full&nbsp;=&nbsp;lv_full&nbsp;&&&nbsp;'.XLSX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;cl_gui_frontend_services=&gt;gui_download(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_full<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filetype&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BIN'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bin_filesize&nbsp;=&nbsp;lv_size<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_tab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_bin<br />
&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CO_Create<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM co_create_0100.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_row_index&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_index&nbsp;TYPE&nbsp;lvc_s_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_outtab_0100_bot[].<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_top-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_row_index.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lines(&nbsp;lt_row_index&nbsp;)&nbsp;&lt;&gt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Please&nbsp;select&nbsp;only&nbsp;one&nbsp;line.'&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100_top&nbsp;INTO&nbsp;gs_outtab_0100_top&nbsp;INDEX&nbsp;l_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~werks,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~zdeno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~ccngnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~datab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;budat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~datab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~datbi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~cust_ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~coflgr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~offshr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~offshr_txt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~land1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~f_name,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~f_binary,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~f_path,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~f_seq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_outtab_0100<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8001&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zgft8000&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;b~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;b~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;zgft8002&nbsp;AS&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~bukrs&nbsp;=&nbsp;c~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;c~ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~bukrs&nbsp;=&nbsp;@gs_outtab_0100_top-bukrs&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;(##&nbsp;#&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~ccno&nbsp;&nbsp;=&nbsp;@gs_outtab_0100_top-ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_ccno&nbsp;&nbsp;=&nbsp;gs_outtab_0100_top-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_fname&nbsp;=&nbsp;gs_outtab_0100_top-f_name.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_cctype&nbsp;=&nbsp;gs_outtab_0100_top-cotype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_cust_ccno&nbsp;=&nbsp;gs_outtab_0100_top-cust_ccno.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;gt_outtab_0100[]&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'No&nbsp;data&nbsp;selected.'&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;110.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CO_Create_0210<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM co_create_0210.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_row_index&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row_index&nbsp;TYPE&nbsp;lvc_s_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;lifnr&nbsp;WITH&nbsp;DEFAULT&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_lifnr_count&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_outtab_0210[],&nbsp;lt_lifnr[].<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;lt_row_index.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;gv_cust_ccno,&nbsp;gv_path.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0200&nbsp;INTO&nbsp;gs_outtab_0200&nbsp;INDEX&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_outtab_0200-lifnr&nbsp;TO&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_lifnr.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_lifnr.<br />
<br />
&nbsp;&nbsp;lv_lifnr_count&nbsp;=&nbsp;lines(&nbsp;lt_lifnr&nbsp;).<br />
&nbsp;&nbsp;IF&nbsp;lv_lifnr_count&nbsp;&gt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Please&nbsp;select&nbsp;only&nbsp;one&nbsp;vendor.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_row_index&nbsp;INTO&nbsp;l_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0200&nbsp;INTO&nbsp;gs_outtab_0200&nbsp;INDEX&nbsp;l_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_outtab_0200&nbsp;TO&nbsp;gs_outtab_0210.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1&nbsp;INTO&nbsp;gs_outtab_0210-lifnm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;gs_outtab_0200-lifnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-datab&nbsp;=&nbsp;gs_outtab_0210-datbi&nbsp;=&nbsp;gs_outtab_0210-budat.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_year)&nbsp;=&nbsp;gs_outtab_0210-budat+0(4).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'0101'&nbsp;INTO&nbsp;gs_outtab_0210-datab.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'1231'&nbsp;INTO&nbsp;gs_outtab_0210-datbi.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_outtab_0210&nbsp;TO&nbsp;gt_outtab_0210.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_outtab_0210.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;gv_cctype&nbsp;=&nbsp;'N'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gt_outtab_0210[]&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'No&nbsp;data&nbsp;selected.'&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;210.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_DROPDOWN_LIST<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_dropdown_list USING io_grid TYPE REF TO cl_gui_alv_grid.<br />
&nbsp;&nbsp;DATA:&nbsp;lt_dropdown&nbsp;TYPE&nbsp;lvc_t_dral,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown&nbsp;TYPE&nbsp;lvc_s_dral,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_ddval&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;dd07v,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_ddval&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;dd07v.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;lt_dropdown.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;1)&nbsp;PFONA&nbsp;(##&nbsp;1)&nbsp;&nbsp;#&nbsp;##:&nbsp;"PFONA&nbsp;FTANA"<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;pfona,&nbsp;ftana<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0004<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@p_bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@DATA(lt_pfona).<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_pfona&nbsp;INTO&nbsp;DATA(ls_pfona).<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_dropdown.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;ls_pfona-pfona.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;ls_pfona-pfona&nbsp;}&nbsp;{&nbsp;ls_pfona-ftana&nbsp;}|.&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2)&nbsp;COFLGR&nbsp;(##&nbsp;2)&nbsp;&nbsp;#&nbsp;###&nbsp;###&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;ls_dropdown.<br />
&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;'Y'.<br />
&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Y'.&nbsp;&nbsp;&nbsp;"###&nbsp;'Y'#&nbsp;##&nbsp;#<br />
&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_dropdown.<br />
&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;'N'.<br />
&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'N'.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;3)&nbsp;OFFSHR&nbsp;(##&nbsp;4,&nbsp;###)&nbsp;#&nbsp;##:&nbsp;"##&nbsp;##"<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DD_DOMVALUES_GET'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;domname&nbsp;&nbsp;&nbsp;=&nbsp;'ZKGD_OFFSHR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;langu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-langu<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd07v_tab&nbsp;=&nbsp;lt_ddval.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_ddval&nbsp;INTO&nbsp;ls_ddval&nbsp;WHERE&nbsp;domvalue_l&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_dropdown.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;ls_ddval-domvalue_l.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;ls_ddval-domvalue_l&nbsp;}&nbsp;{&nbsp;ls_ddval-ddtext&nbsp;}|."###<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;4)&nbsp;LAND1&nbsp;(##&nbsp;5)&nbsp;#&nbsp;##:&nbsp;"####&nbsp;###"<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;DISTINCT&nbsp;g~land1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t~landx<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0005&nbsp;AS&nbsp;g<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;t005t&nbsp;AS&nbsp;t<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;t~spras&nbsp;=&nbsp;@sy-langu<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;t~land1&nbsp;=&nbsp;g~land1<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;g~bukrs&nbsp;=&nbsp;@p_bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;g~pfona&nbsp;LIKE&nbsp;'%GA'<br />
&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@DATA(lt_land).<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_land&nbsp;INTO&nbsp;DATA(ls_land).<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_dropdown.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'5'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;ls_land-land1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;ls_land-land1&nbsp;}&nbsp;{&nbsp;ls_land-landx&nbsp;}|.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;alias&nbsp;##&nbsp;##:&nbsp;###&nbsp;value(###)&nbsp;##,&nbsp;####&nbsp;int_value(##)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;io_grid-&gt;set_drop_down_table(&nbsp;it_drop_down_alias&nbsp;=&nbsp;lt_dropdown&nbsp;).<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*FORM&nbsp;alv_dropdown_list&nbsp;USING&nbsp;io_grid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_gui_alv_grid.<br />
*&nbsp;&nbsp;DATA&nbsp;:&nbsp;lt_dropdown&nbsp;TYPE&nbsp;lvc_t_dral,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown&nbsp;TYPE&nbsp;lvc_s_dral,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_ddval&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;dd07v,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_ddval&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;dd07v.<br />
*<br />
*<br />
*&nbsp;&nbsp;CLEAR:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_dropdown,&nbsp;ls_dropdown.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;pfona&nbsp;ftana&nbsp;INTO&nbsp;(&nbsp;ls_dropdown-int_value,&nbsp;ls_dropdown-value&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0004&nbsp;"PFONA&nbsp;(1#)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;p_bukrs.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'1'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-int_value&nbsp;&nbsp;=&nbsp;ls_dropdown-int_value.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;=&nbsp;ls_dropdown-value.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
*&nbsp;&nbsp;ENDSELECT.<br />
*<br />
*&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'.&nbsp;&nbsp;"COFLGR&nbsp;##&nbsp;(2#)<br />
*&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;'Y'.<br />
*&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Y'.<br />
*&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
*<br />
*&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
*&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;'N'.<br />
*&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'N'.<br />
*&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DD_DOMVALUES_GET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;domname&nbsp;&nbsp;&nbsp;=&nbsp;'ZKGD_OFFSHR'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;langu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-langu<br />
*&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd07v_tab&nbsp;=&nbsp;lt_ddval<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_ddval&nbsp;INTO&nbsp;ls_ddval.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_dropdown.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-int_value&nbsp;=&nbsp;ls_ddval-domvalue_l.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_ddval-ddtext.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;land1&nbsp;land1&nbsp;INTO&nbsp;(&nbsp;ls_dropdown-int_value,&nbsp;ls_dropdown-value&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0005<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;p_bukrs<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;LIKE&nbsp;'%GA'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'5'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-int_value&nbsp;&nbsp;=&nbsp;ls_dropdown-int_value.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_dropdown-value&nbsp;&nbsp;=&nbsp;ls_dropdown-value.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
*&nbsp;&nbsp;ENDSELECT.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;io_grid-&gt;set_drop_down_table<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_drop_down_alias&nbsp;=&nbsp;lt_dropdown.<br />
*ENDFORM.&nbsp;"ALV_CL_DROPDOWN_LIST<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DATE_CHANGE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM date_change_0100.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0100&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;fs&gt;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;gv_cctype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-datab&nbsp;=&nbsp;&lt;fs&gt;-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-datbi&nbsp;=&nbsp;&lt;fs&gt;-budat.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_year)&nbsp;=&nbsp;&lt;fs&gt;-budat+0(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'0101'&nbsp;INTO&nbsp;&lt;fs&gt;-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'1231'&nbsp;INTO&nbsp;&lt;fs&gt;-datbi.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DATE_CHANGE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM date_change_0210.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0210&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;fs&gt;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;gv_cctype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-datab&nbsp;=&nbsp;&lt;fs&gt;-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-datbi&nbsp;=&nbsp;&lt;fs&gt;-budat.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_year)&nbsp;=&nbsp;&lt;fs&gt;-budat+0(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'0101'&nbsp;INTO&nbsp;&lt;fs&gt;-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'1231'&nbsp;INTO&nbsp;&lt;fs&gt;-datbi.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHANGE_CONFIRM<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM change_confirm .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_answer&nbsp;TYPE&nbsp;c.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Change&nbsp;Confirm'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Change&nbsp;the&nbsp;C/O&nbsp;number&nbsp;manually?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Yes'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'No'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_button&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display_cancel_button&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_answer.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_answer&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;change_ccno.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;change_ccno<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM change_ccno .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_fields&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;sval,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_field&nbsp;&nbsp;TYPE&nbsp;sval.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_old_ccno&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_change&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_old_ccno&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_field.<br />
&nbsp;&nbsp;ls_field-tabname&nbsp;&nbsp;&nbsp;=&nbsp;'ZGFT8000'.<br />
&nbsp;&nbsp;ls_field-fieldname&nbsp;=&nbsp;'CCNO'.<br />
&nbsp;&nbsp;ls_field-field_obl&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_field-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_field&nbsp;TO&nbsp;lt_fields.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_GET_VALUES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;popup_title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Enter&nbsp;the&nbsp;C/O&nbsp;number'<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_in_fields&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_fields&nbsp;INTO&nbsp;ls_field&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_ccno&nbsp;=&nbsp;ls_field-value.&nbsp;&nbsp;"&nbsp;#&nbsp;C/O&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
**&---------------------------------------------------------------------*<br />
**&&nbsp;Form&nbsp;SAVE_DATA<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;save_confirm.<br />
*<br />
*&nbsp;&nbsp;DATA:&nbsp;lv_answer&nbsp;TYPE&nbsp;c.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Save&nbsp;Confirm'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Do&nbsp;you&nbsp;Want&nbsp;to&nbsp;Save?'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Yes'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'No'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_button&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display_cancel_button&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_answer.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;lv_answer&nbsp;=&nbsp;'1'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;save_data.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
*&nbsp;&nbsp;ENDIF.<br />
*<br />
*ENDFORM.<br />
<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;save_data<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM save_data_0100.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_zgft8000&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft8001&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft8002&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000&nbsp;TYPE&nbsp;zgft8000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001&nbsp;TYPE&nbsp;zgft8001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002&nbsp;TYPE&nbsp;zgft8002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8002&nbsp;&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_file_seq&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft8002-f_seq,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_file_table&nbsp;TYPE&nbsp;filetable,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_fullpath&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_filename&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_len&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_raw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;raw255&nbsp;WITH&nbsp;DEFAULT&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xstring&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;xstring.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_check_tab&nbsp;TYPE&nbsp;SORTED&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0100<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;matnr&nbsp;pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_outtab&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_outtab_0100.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ccno_check&nbsp;TYPE&nbsp;zgft8000-ccno.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;lv_answer&nbsp;TYPE&nbsp;c.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;lt_zgft8000,lt_zgft8001,lt_zgft8002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft8000[],lt_zgft8001[],lt_zgft8002[].<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;gv_path&nbsp;IS&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Upload&nbsp;File&nbsp;missing'&nbsp;TYPE&nbsp;'E'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0100&nbsp;INTO&nbsp;ls_outtab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_outtab&nbsp;INTO&nbsp;TABLE&nbsp;lt_check_tab.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lines(&nbsp;lt_check_tab&nbsp;)&nbsp;&lt;&nbsp;lines(&nbsp;gt_outtab_0100&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Please&nbsp;check&nbsp;the&nbsp;trade&nbsp;agreement.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0100&nbsp;INDEX&nbsp;1&nbsp;INTO&nbsp;gs_outtab_0100.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;land1&nbsp;FROM&nbsp;lfa1&nbsp;INTO&nbsp;@DATA(lv_land1)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@gs_outtab_0100-lifnr.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;"&nbsp;ZGFT8000<br />
&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8000.<br />
&nbsp;&nbsp;ls_zgft8000-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-bukrs.<br />
&nbsp;&nbsp;ls_zgft8000-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;ls_zgft8000-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-werks.<br />
&nbsp;&nbsp;ls_zgft8000-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-lifnr.<br />
&nbsp;&nbsp;ls_zgft8000-cctype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_cctype.<br />
&nbsp;&nbsp;ls_zgft8000-cust_ccno&nbsp;=&nbsp;gv_cust_ccno.<br />
&nbsp;&nbsp;IF&nbsp;gv_change&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cotype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cotype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ls_zgft8000-idate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;ls_zgft8000-datab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-datab.<br />
&nbsp;&nbsp;ls_zgft8000-datbi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-datbi.<br />
&nbsp;&nbsp;ls_zgft8000-imprf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'D'.<br />
&nbsp;&nbsp;ls_zgft8000-subst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;ls_zgft8000&nbsp;TO&nbsp;lt_zgft8000.<br />
<br />
&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;"&nbsp;ZGFT8002&nbsp;(####&nbsp;##&nbsp;##)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"--------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gv_path&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8002.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gv_path&nbsp;TO&nbsp;lv_fullpath.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SO_SPLIT_FILE_AND_PATH'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stripped_name&nbsp;=&nbsp;lv_filename.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;BINARY&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;cl_gui_frontend_services=&gt;gui_upload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filetype&nbsp;&nbsp;&nbsp;=&nbsp;'BIN'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filelength&nbsp;=&nbsp;lv_file_len<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_tab&nbsp;&nbsp;&nbsp;=&nbsp;lt_raw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_file_len&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'File&nbsp;attachment&nbsp;failed.&nbsp;No&nbsp;data&nbsp;was&nbsp;uploaded.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BINARY&nbsp;#&nbsp;XSTRING&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SCMS_BINARY_TO_XSTRING'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_length&nbsp;=&nbsp;lv_file_len<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_xstring<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_tab&nbsp;&nbsp;&nbsp;=&nbsp;lt_raw.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;MAX(&nbsp;f_seq&nbsp;)&nbsp;INTO&nbsp;lv_file_seq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;gs_outtab_0100-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccno&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;lv_file_seq&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_seq&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_seq&nbsp;=&nbsp;lv_file_seq&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-bukrs&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_seq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_file_seq.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_name&nbsp;&nbsp;&nbsp;=&nbsp;lv_filename.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_binary&nbsp;=&nbsp;lv_xstring.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_path&nbsp;&nbsp;&nbsp;=&nbsp;gv_path.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8002&nbsp;TO&nbsp;lt_zgft8002.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8002&nbsp;=&nbsp;lv_seq8002&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0100&nbsp;INTO&nbsp;gs_outtab_0100.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZGFT8001<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_seq8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-pfona&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-zdeno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-zdeno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-budat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-coflgr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-coflgr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-prule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-land1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-offshr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0100-offshr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-offshr_txt&nbsp;=&nbsp;gs_outtab_0100-offshr_txt.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8001&nbsp;TO&nbsp;lt_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;=&nbsp;lv_seq8001&nbsp;+&nbsp;1.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;ccno&nbsp;FROM&nbsp;zgft8000&nbsp;INTO&nbsp;lv_ccno_check<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;gs_outtab_0100-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccno&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_ucomm&nbsp;=&nbsp;'SAVE'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;=&nbsp;'Save&nbsp;changes?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Confirm'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_answer.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_answer&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;zgft8000&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8000.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;zgft8001&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;zgft8002&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8002.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Data&nbsp;has&nbsp;been&nbsp;updated&nbsp;successfully.'&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;gv_ucomm&nbsp;=&nbsp;'DELE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;=&nbsp;'Delete&nbsp;Data?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Confirm'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_answer.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_answer&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8000&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8001&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;gv_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8002&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;gv_ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Data&nbsp;has&nbsp;been&nbsp;deleted&nbsp;successfully.'&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
&nbsp;&nbsp;PERFORM&nbsp;get_data_0100.<br />
&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;save_data<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM save_data_0210.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_zgft8000&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft8001&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft8002&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000&nbsp;TYPE&nbsp;zgft8000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001&nbsp;TYPE&nbsp;zgft8001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002&nbsp;TYPE&nbsp;zgft8002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_file_seq&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft8002-f_seq,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_file_table&nbsp;TYPE&nbsp;filetable,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_fullpath&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_filename&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_len&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_raw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;raw255&nbsp;WITH&nbsp;DEFAULT&nbsp;KEY,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_raw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;w3mime&nbsp;WITH&nbsp;DEFAULT&nbsp;KEY,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xstring&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;xstring.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_check_tab&nbsp;TYPE&nbsp;SORTED&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0210<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;matnr&nbsp;pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_outtab&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_outtab_0210.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ccno_check&nbsp;TYPE&nbsp;zgft8000-ccno.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_today&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-datum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_date_txt&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq_txt&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft8000-ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq_num&nbsp;&nbsp;TYPE&nbsp;n&nbsp;LENGTH&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_answer&nbsp;&nbsp;&nbsp;TYPE&nbsp;char1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_prev_lifnr&nbsp;TYPE&nbsp;zgft8000-lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datab&nbsp;TYPE&nbsp;zgft8000-datab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datbi&nbsp;TYPE&nbsp;zgft8000-datbi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_matnr&nbsp;TYPE&nbsp;zgft8001-mtroh,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_ccno&nbsp;&nbsp;TYPE&nbsp;zgft8000-ccno.<br />
<br />
&nbsp;&nbsp;TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;ty_outtab_0300_key,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccno&nbsp;TYPE&nbsp;zgft8000-ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_outtab_0300_key.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_ccno_tab&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0300&nbsp;WITH&nbsp;EMPTY&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_tmp8000&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0300.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;question&nbsp;USING&nbsp;lv_answer.<br />
&nbsp;&nbsp;CHECK&nbsp;lv_answer&nbsp;=&nbsp;'1'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_path&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Upload&nbsp;File&nbsp;missing'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;ls_outtab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_outtab&nbsp;INTO&nbsp;TABLE&nbsp;lt_check_tab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_outtab-pfona&nbsp;=&nbsp;'PKRGA'&nbsp;AND&nbsp;ls_outtab-land1&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Input&nbsp;Country&nbsp;for&nbsp;PKRGA.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lines(&nbsp;lt_check_tab&nbsp;)&nbsp;&lt;&nbsp;lines(&nbsp;gt_outtab_0210&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Please&nbsp;check&nbsp;the&nbsp;trade&nbsp;agreement.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0210&nbsp;INDEX&nbsp;1&nbsp;INTO&nbsp;gs_outtab_0210.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;land1&nbsp;FROM&nbsp;lfa1&nbsp;INTO&nbsp;@DATA(lv_land1)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@gs_outtab_0210-lifnr.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_date_txt&nbsp;=&nbsp;|{&nbsp;lv_today+2(6)&nbsp;}|.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_outtab_0210&nbsp;BY&nbsp;lifnr&nbsp;datab&nbsp;datbi&nbsp;matnr.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;lv_prev_lifnr,&nbsp;lv_prev_datab,&nbsp;lv_prev_datbi,&nbsp;lv_prev_matnr.<br />
<br />
&nbsp;&nbsp;lv_date_txt&nbsp;=&nbsp;|{&nbsp;sy-datum&nbsp;}|.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;gs_outtab_0210.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0210-lifnr&nbsp;&lt;&gt;&nbsp;lv_prev_lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;COUNT(*)&nbsp;INTO&nbsp;@lv_seq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8000<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@gs_outtab_0210-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;idate&nbsp;=&nbsp;@sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0210-lifnr&nbsp;&lt;&gt;&nbsp;lv_prev_lifnr&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-datab&nbsp;&lt;&gt;&nbsp;lv_prev_datab&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-datbi&nbsp;&lt;&gt;&nbsp;lv_prev_datbi&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-matnr&nbsp;&lt;&gt;&nbsp;lv_prev_matnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq&nbsp;=&nbsp;lv_seq&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq_txt&nbsp;=&nbsp;|{&nbsp;lv_seq&nbsp;}|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccno&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;gs_outtab_0210-lifnr&nbsp;}{&nbsp;lv_date_txt&nbsp;}{&nbsp;lv_seq_txt&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0210-ccno&nbsp;=&nbsp;lv_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_outtab_0210&nbsp;FROM&nbsp;gs_outtab_0210.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_lifnr&nbsp;=&nbsp;gs_outtab_0210-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datab&nbsp;=&nbsp;gs_outtab_0210-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datbi&nbsp;=&nbsp;gs_outtab_0210-datbi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_matnr&nbsp;=&nbsp;gs_outtab_0210-matnr.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_outtab_0210&nbsp;BY&nbsp;ccno.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0210&nbsp;INTO&nbsp;gs_outtab_0210.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZGFT8000<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0210-ccno&nbsp;&lt;&gt;&nbsp;lv_prev_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8000.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cust_ccno&nbsp;=&nbsp;gv_cust_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cctype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_cctype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cotype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-idate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-datab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-datbi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-datbi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-imprf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-subst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-ernam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-erzet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-erdat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8000&nbsp;TO&nbsp;lt_zgft8000.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZGFT8002&nbsp;(####&nbsp;##&nbsp;##)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"--------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gv_path&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8002.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gv_path&nbsp;TO&nbsp;lv_fullpath.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SO_SPLIT_FILE_AND_PATH'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stripped_name&nbsp;=&nbsp;lv_filename.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;BINARY&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;cl_gui_frontend_services=&gt;gui_upload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;=&nbsp;lv_fullpath<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filetype&nbsp;&nbsp;&nbsp;=&nbsp;'BIN'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filelength&nbsp;=&nbsp;lv_file_len<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_tab&nbsp;&nbsp;&nbsp;=&nbsp;lt_raw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_file_len&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'File&nbsp;attachment&nbsp;failed.&nbsp;No&nbsp;data&nbsp;was&nbsp;uploaded.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;BINARY&nbsp;#&nbsp;XSTRING&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SCMS_BINARY_TO_XSTRING'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_length&nbsp;=&nbsp;lv_file_len<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_xstring<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_tab&nbsp;&nbsp;&nbsp;=&nbsp;lt_raw.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;MAX(&nbsp;f_seq&nbsp;)&nbsp;INTO&nbsp;lv_file_seq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;gs_outtab_0210-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccno&nbsp;&nbsp;=&nbsp;gv_ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0&nbsp;OR&nbsp;lv_file_seq&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_seq&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_file_seq&nbsp;=&nbsp;lv_file_seq&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-bukrs&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_seq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_file_seq.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_name&nbsp;&nbsp;&nbsp;=&nbsp;lv_filename.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_binary&nbsp;=&nbsp;lv_xstring.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-f_path&nbsp;&nbsp;&nbsp;=&nbsp;gv_path.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-ernam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-erzet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8002-erdat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8002&nbsp;TO&nbsp;lt_zgft8002.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_ccno&nbsp;=&nbsp;gs_outtab_0210-ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZGFT8001<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_seq8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-pfona&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-zdeno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-zdeno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-budat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-coflgr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-coflgr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-prule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-land1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-offshr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0210-offshr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-offshr_txt&nbsp;=&nbsp;gs_outtab_0210-offshr_txt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ernam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-erzet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-erdat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8001&nbsp;TO&nbsp;lt_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;=&nbsp;lv_seq8001&nbsp;+&nbsp;1.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;DATA(lt_ccno)&nbsp;=&nbsp;gt_outtab_0210.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_ccno&nbsp;BY&nbsp;ccno&nbsp;bukrs&nbsp;werks&nbsp;lifnr&nbsp;matnr&nbsp;budat.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_ccno<br />
&nbsp;&nbsp;COMPARING&nbsp;ccno&nbsp;bukrs&nbsp;werks&nbsp;lifnr&nbsp;matnr&nbsp;budat.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_ccno&nbsp;INTO&nbsp;DATA(ls_ccno).<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8000&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;ls_ccno-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8001&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;ls_ccno-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8002&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;ls_ccno-ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;zgft0200<br />
&nbsp;&nbsp;&nbsp;SET&nbsp;ccno&nbsp;&nbsp;=&nbsp;ls_ccno-ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aenam&nbsp;&nbsp;=&nbsp;sy-uname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aedat&nbsp;&nbsp;=&nbsp;sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aezet&nbsp;&nbsp;=&nbsp;sy-uzeit<br />
&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;ls_ccno-bukrs<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;werks&nbsp;=&nbsp;ls_ccno-werks<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;lifnr&nbsp;=&nbsp;ls_ccno-lifnr<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;=&nbsp;ls_ccno-matnr<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;budat&nbsp;=&nbsp;ls_ccno-budat.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;zgft8000&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8000.<br />
&nbsp;&nbsp;INSERT&nbsp;zgft8001&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8001.<br />
&nbsp;&nbsp;INSERT&nbsp;zgft8002&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8002.<br />
<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
&nbsp;&nbsp;MESSAGE&nbsp;'Data&nbsp;has&nbsp;been&nbsp;saved&nbsp;successfully.'&nbsp;TYPE&nbsp;'S'.<br />
<br />
&nbsp;&nbsp;SUBMIT&nbsp;(sy-repid)&nbsp;VIA&nbsp;SELECTION-SCREEN.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;save_data<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM save_data_excel.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_zgft8000&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft8001&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft8001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000&nbsp;TYPE&nbsp;zgft8000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001&nbsp;TYPE&nbsp;zgft8001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_check_tab&nbsp;TYPE&nbsp;SORTED&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0300<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;matnr&nbsp;pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_outtab&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_outtab_0300.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ccno_check&nbsp;TYPE&nbsp;zgft8000-ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;char1.<br />
<br />
<br />
&nbsp;&nbsp;TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;ty_outtab_0300_key,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccno&nbsp;TYPE&nbsp;zgft8000-ccno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_outtab_0300_key.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_ccno_tab&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0300&nbsp;WITH&nbsp;EMPTY&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_tmp8000&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_outtab_0300.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;question&nbsp;USING&nbsp;lv_answer.<br />
&nbsp;&nbsp;CHECK&nbsp;lv_answer&nbsp;=&nbsp;'1'.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_outtab_0300&nbsp;INTO&nbsp;ls_outtab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;icon&nbsp;=&nbsp;icon_led_red.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Check&nbsp;Data'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;lt_tmp8000&nbsp;=&nbsp;gt_outtab_0300.<br />
&nbsp;&nbsp;SORT&nbsp;lt_tmp8000&nbsp;BY&nbsp;ccno.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_tmp8000&nbsp;COMPARING&nbsp;ccno.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_tmp8000&nbsp;INTO&nbsp;ls_outtab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8000.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cust_ccno&nbsp;=&nbsp;ls_outtab-cust_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-werks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;ls_outtab-lifnr&nbsp;ALPHA&nbsp;=&nbsp;IN&nbsp;}|.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-lifnr.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cctype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-cctype.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-cotype&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-idate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-datab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-datbi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_outtab-datbi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-imprf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-subst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'4'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-ernam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-erdat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8000-erzet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uzeit.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8000&nbsp;TO&nbsp;lt_zgft8000.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_outtab_0300&nbsp;BY&nbsp;ccno.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0300&nbsp;INTO&nbsp;gs_outtab_0300.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;NEW&nbsp;ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;land1&nbsp;FROM&nbsp;lfa1&nbsp;INTO&nbsp;@DATA(lv_land1)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@gs_outtab_0300-lifnr.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZGFT8001<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_seq8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-pfona&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-zdeno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-zdeno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-budat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-coflgr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-coflgr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-ccngnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-prule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-land1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-offshr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_outtab_0300-offshr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-offshr_txt&nbsp;=&nbsp;gs_outtab_0300-offshr_txt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-ernam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-erdat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_zgft8001-erzet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-uzeit.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_zgft8001&nbsp;TO&nbsp;lt_zgft8001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_seq8001&nbsp;=&nbsp;lv_seq8001&nbsp;+&nbsp;1.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_tmp8000&nbsp;INTO&nbsp;DATA(ls_tmp8000).<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8000&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;ls_tmp8000-ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft8001&nbsp;WHERE&nbsp;ccno&nbsp;=&nbsp;ls_tmp8000-ccno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;zgft0200<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;ccno&nbsp;&nbsp;=&nbsp;ls_tmp8000-ccno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aenam&nbsp;&nbsp;=&nbsp;sy-uname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aedat&nbsp;&nbsp;=&nbsp;sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aezet&nbsp;&nbsp;=&nbsp;sy-uzeit<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;ls_tmp8000-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;werks&nbsp;=&nbsp;ls_tmp8000-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;lifnr&nbsp;=&nbsp;ls_tmp8000-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;=&nbsp;ls_tmp8000-matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;budat&nbsp;=&nbsp;ls_tmp8000-budat.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;zgft8000&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8000.<br />
&nbsp;&nbsp;INSERT&nbsp;zgft8001&nbsp;FROM&nbsp;TABLE&nbsp;lt_zgft8001.<br />
<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
&nbsp;&nbsp;MESSAGE&nbsp;'Data&nbsp;has&nbsp;been&nbsp;saved&nbsp;successfully.'&nbsp;TYPE&nbsp;'S'.<br />
<br />
&nbsp;&nbsp;SUBMIT&nbsp;(sy-repid)&nbsp;VIA&nbsp;SELECTION-SCREEN.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGFB0001F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;TAB_SCREEN_SET<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM tab_screen_set .<br />
<br />
&nbsp;&nbsp;tab1&nbsp;=&nbsp;'Inquiry'."##<br />
&nbsp;&nbsp;tab2&nbsp;=&nbsp;'Register'."##<br />
&nbsp;&nbsp;tab3&nbsp;=&nbsp;'Mass&nbsp;Upload'."Rule&nbsp;####<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;get_latest_tab(zgf_form_sub_routine)&nbsp;USING&nbsp;sy-repid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;g_dynnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-activetab.<br />
<br />
&nbsp;&nbsp;IF&nbsp;g_dynnr&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;tabb1-dynnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;101.<br />
&nbsp;&nbsp;&nbsp;&nbsp;tabb1-activetab&nbsp;=&nbsp;'PUSH1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;g_dynnr&nbsp;=&nbsp;tabb1-dynnr.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;tabb1-dynnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;g_dynnr.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.                    " TAB_SCREEN_SET<br />
   </div>
   <div class="codeComment">
**&---------------------------------------------------------------------*<br />
**&&nbsp;Form&nbsp;DATA_CONVERT_0300<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
**&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
**&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM data_convert_0300.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;char4,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_today&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-datum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_date_txt&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_curr_seq&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq_txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_local_count&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_temp_ccno&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;zgft8000-ccno&nbsp;WITH&nbsp;EMPTY&nbsp;KEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300&nbsp;TYPE&nbsp;ty_outtab_0300,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;string.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_prev_lifnr&nbsp;TYPE&nbsp;zgft8000-lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datab&nbsp;TYPE&nbsp;zgft8000-datab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datbi&nbsp;TYPE&nbsp;zgft8000-datbi,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_matnr&nbsp;TYPE&nbsp;zgft8001-mtroh.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_outtab_0300.<br />
<br />
&nbsp;&nbsp;lv_today&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;lv_date_txt&nbsp;&nbsp;=&nbsp;|{&nbsp;lv_today+2(6)&nbsp;}|.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&lt;gt_excel&gt;&nbsp;ASSIGNING&nbsp;&lt;gs_excel&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;&lt;gs_excel&gt;&nbsp;TO&nbsp;gs_outtab_0300.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-lifnr&nbsp;=&nbsp;|{&nbsp;gs_outtab_0300-lifnr&nbsp;ALPHA&nbsp;=&nbsp;IN&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-cctype&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_year&nbsp;=&nbsp;gs_outtab_0300-budat+0(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'0101'&nbsp;INTO&nbsp;gs_outtab_0300-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;lv_year&nbsp;'1231'&nbsp;INTO&nbsp;gs_outtab_0300-datbi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-datab&nbsp;=&nbsp;gs_outtab_0300-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-datbi&nbsp;=&nbsp;gs_outtab_0300-budat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-icon&nbsp;=&nbsp;icon_led_green.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_outtab_0300-msg.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Agreement&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@DATA(lv_pfona_check)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0004<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;pfona&nbsp;=&nbsp;@gs_outtab_0300-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datuv&nbsp;&lt;=&nbsp;@gs_outtab_0300-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;add_error_message&nbsp;USING&nbsp;'Check&nbsp;Agreement'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_outtab_0300-icon&nbsp;gs_outtab_0300-msg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Origin&nbsp;Status&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-coflgr&nbsp;&lt;&gt;&nbsp;'Y'&nbsp;AND&nbsp;gs_outtab_0300-coflgr&nbsp;&lt;&gt;&nbsp;'N'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;add_error_message&nbsp;USING&nbsp;'Check&nbsp;Origin&nbsp;Status'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_outtab_0300-icon&nbsp;gs_outtab_0300-msg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Land1&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-pfona&nbsp;=&nbsp;'PKRGA'&nbsp;AND&nbsp;gs_outtab_0300-land1&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;add_error_message&nbsp;USING&nbsp;'Input&nbsp;Country&nbsp;for&nbsp;PKRGA'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_outtab_0300-icon&nbsp;gs_outtab_0300-msg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-pfona&nbsp;&lt;&gt;&nbsp;'PKRGA'&nbsp;AND&nbsp;gs_outtab_0300-land1&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;add_error_message&nbsp;USING&nbsp;'Cannot&nbsp;Input&nbsp;Country&nbsp;for&nbsp;non-PKRGA'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_outtab_0300-icon&nbsp;gs_outtab_0300-msg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;PSR&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;rct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@DATA(lv_rct_check)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;&nbsp;=&nbsp;@gs_outtab_0300-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;&nbsp;=&nbsp;@gs_outtab_0300-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngn&nbsp;&nbsp;=&nbsp;@gs_outtab_0300-ccngnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;rct&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;@gs_outtab_0300-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0&nbsp;AND&nbsp;lv_rct_check&nbsp;&lt;&gt;&nbsp;gs_outtab_0300-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;add_error_message&nbsp;USING&nbsp;'Check&nbsp;PSR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_outtab_0300-icon&nbsp;gs_outtab_0300-msg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Origin&nbsp;=&nbsp;Y&nbsp;#&nbsp;#&nbsp;offshr&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-coflgr&nbsp;=&nbsp;'Y'&nbsp;AND&nbsp;gs_outtab_0300-offshr&nbsp;CP&nbsp;'[!0-9]'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;add_error_message&nbsp;USING&nbsp;'Check&nbsp;Non-Originating&nbsp;Reason&nbsp;Code'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_outtab_0300-icon&nbsp;gs_outtab_0300-msg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1&nbsp;INTO&nbsp;gs_outtab_0300-lifnm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;gs_outtab_0300-lifnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_outtab_0300&nbsp;TO&nbsp;gt_outtab_0300.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_outtab_0300&nbsp;BY&nbsp;lifnr&nbsp;datab&nbsp;datbi&nbsp;matnr.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;lv_prev_lifnr,&nbsp;lv_prev_datab,&nbsp;lv_prev_datbi,&nbsp;lv_prev_matnr.<br />
<br />
&nbsp;&nbsp;lv_date_txt&nbsp;=&nbsp;|{&nbsp;sy-datum&nbsp;}|.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_outtab_0300&nbsp;INTO&nbsp;gs_outtab_0300.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-lifnr&nbsp;&lt;&gt;&nbsp;lv_prev_lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;COUNT(*)&nbsp;INTO&nbsp;@lv_seq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft8000<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@gs_outtab_0300-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;idate&nbsp;=&nbsp;@sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_outtab_0300-lifnr&nbsp;&lt;&gt;&nbsp;lv_prev_lifnr&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-datab&nbsp;&lt;&gt;&nbsp;lv_prev_datab&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-datbi&nbsp;&lt;&gt;&nbsp;lv_prev_datbi&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-matnr&nbsp;&lt;&gt;&nbsp;lv_prev_matnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq&nbsp;=&nbsp;lv_seq&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_seq_txt&nbsp;=&nbsp;|{&nbsp;lv_seq&nbsp;}|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccno&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|{&nbsp;gs_outtab_0300-lifnr&nbsp;}{&nbsp;lv_date_txt&nbsp;}{&nbsp;lv_seq_txt&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_outtab_0300-ccno&nbsp;=&nbsp;lv_ccno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_outtab_0300&nbsp;FROM&nbsp;gs_outtab_0300.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_lifnr&nbsp;=&nbsp;gs_outtab_0300-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datab&nbsp;=&nbsp;gs_outtab_0300-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_datbi&nbsp;=&nbsp;gs_outtab_0300-datbi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_prev_matnr&nbsp;=&nbsp;gs_outtab_0300-matnr.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;add_error_message<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM add_error_message USING    pv_text TYPE string<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;pv_icon&nbsp;TYPE&nbsp;icon_d<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_msg&nbsp;&nbsp;TYPE&nbsp;string.<br />
<br />
&nbsp;&nbsp;pv_icon&nbsp;=&nbsp;icon_led_red.<br />
&nbsp;&nbsp;IF&nbsp;pv_msg&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;pv_msg&nbsp;=&nbsp;pv_text.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;pv_msg&nbsp;'&nbsp;/&nbsp;'&nbsp;pv_text&nbsp;INTO&nbsp;pv_msg.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;INTERNAL_DATA_SET_0300<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM internal_data_set_0300.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_dref&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;data,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_dref&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;data.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;lt_dref&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_excel_0200.<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;ls_dref&nbsp;TYPE&nbsp;ty_excel_0200.<br />
<br />
&nbsp;&nbsp;ASSIGN&nbsp;lt_dref-&gt;*&nbsp;TO&nbsp;&lt;gt_excel&gt;.<br />
&nbsp;&nbsp;ASSIGN&nbsp;ls_dref-&gt;*&nbsp;TO&nbsp;&lt;gs_excel&gt;.<br />
<br />
ENDFORM.                    " INTERNAL_DATA_SET_0200<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCEL_UPLOAD_EXEC_0300<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM excel_upload_exec_0300.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;l_index&nbsp;LIKE&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_xls_tab.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;fs1&gt;&nbsp;TYPE&nbsp;any.<br />
<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zgf_excel_to_internal_tab/zgf_excel_to_internal_tab.html">'ZGF_EXCEL_TO_INTERNAL_TAB'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_fname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_begin_col&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_begin_row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_end_col&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;15<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_end_row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;500000<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_xls_tab<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inconsistent_parameters&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upload_ole&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s004&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;gt_xls_tab&nbsp;LINES&nbsp;sy-tfill.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-tfill&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s136&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;STOP.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_xls_tab&nbsp;BY&nbsp;row&nbsp;.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_xls_tab&nbsp;INTO&nbsp;gs_xls_tab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gs_xls_tab-col&nbsp;TO&nbsp;l_index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;COMPONENT&nbsp;l_index&nbsp;OF&nbsp;STRUCTURE&nbsp;&lt;gs_excel&gt;&nbsp;TO&nbsp;&lt;fs1&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gs_xls_tab-value&nbsp;TO&nbsp;&lt;fs1&gt;.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;gs_excel&gt;&nbsp;TO&nbsp;&lt;gt_excel&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;&lt;gs_excel&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " EXCEL_UPLOAD_EXEC_0300<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;TAB_SCREEN_POSTION_SET<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM tab_screen_postion_set .<br />
<br />
&nbsp;&nbsp;gv_ucomm&nbsp;=&nbsp;sy-ucomm.<br />
&nbsp;&nbsp;CLEAR:&nbsp;sy-ucomm.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;gv_ucomm.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PUSH1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-dynnr&nbsp;=&nbsp;101.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-activetab&nbsp;=&nbsp;'PUSH1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_dynnr&nbsp;=&nbsp;tabb1-dynnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PUSH2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-dynnr&nbsp;=&nbsp;102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-activetab&nbsp;=&nbsp;'PUSH2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_dynnr&nbsp;=&nbsp;tabb1-dynnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PUSH3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-dynnr&nbsp;=&nbsp;103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-activetab&nbsp;=&nbsp;'PUSH3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_dynnr&nbsp;=&nbsp;tabb1-dynnr.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;set_latest_tab(zgf_form_sub_routine)&nbsp;USING&nbsp;sy-repid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_dynnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabb1-activetab.<br />
<br />
ENDFORM.                    " TAB_SCREEN_POSTION_SET<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHANGE_CODE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM change_code .<br />
&nbsp;&nbsp;IF&nbsp;s_lifnr&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1&nbsp;INTO&nbsp;s_litxt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;EQ&nbsp;s_lifnr-low<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;spras&nbsp;EQ&nbsp;sy-langu.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INPUT_CHECK<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM input_check .<br />
<br />
&nbsp;&nbsp;"&nbsp;101&nbsp;##<br />
&nbsp;&nbsp;IF&nbsp;g_dynnr&nbsp;=&nbsp;'101'&nbsp;AND&nbsp;p_bukrs2&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Company&nbsp;Code&nbsp;is&nbsp;mandatory.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;102&nbsp;##<br />
&nbsp;&nbsp;IF&nbsp;g_dynnr&nbsp;=&nbsp;'102'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;p_bukrs&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Company&nbsp;Code&nbsp;is&nbsp;mandatory.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_budat-low&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Start&nbsp;Date&nbsp;is&nbsp;mandatory.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_budat-high&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'End&nbsp;Date&nbsp;is&nbsp;mandatory.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;##<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_budat-low&nbsp;IS&nbsp;NOT&nbsp;INITIAL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;s_budat-high&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_budat-low(4)&nbsp;&lt;&gt;&nbsp;s_budat-high(4).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Start&nbsp;Date&nbsp;and&nbsp;End&nbsp;Date&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;same&nbsp;year.'&nbsp;TYPE&nbsp;'E'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM. "DATE_CHECK<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;QUESTION<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ANSWER&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM question  USING  p_answer.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;p_answer.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Save&nbsp;Confirm'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Do&nbsp;You&nbsp;Want&nbsp;to&nbsp;save?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'YES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icon_button_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ICON_OKAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'NO'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icon_button_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ICON_CANCEL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display_cancel_button&nbsp;=&nbsp;'&nbsp;'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_not_found&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
ENDFORM.                    " QUESTION<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_base_data_0200<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_base_data_0200 CHANGING pv_ng.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gv_zcust_no,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_zcust_no_5,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_ng.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;zcust_no<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft2004<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;gv_zcust_no<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;pernr&nbsp;=&nbsp;sy-uname.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;pv_ng&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s000&nbsp;WITH&nbsp;TEXT-e01&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;gv_zcust_no_5&nbsp;=&nbsp;gv_zcust_no+0(5).<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 756</td>
   </tr>
</table>
</body>
</html>
