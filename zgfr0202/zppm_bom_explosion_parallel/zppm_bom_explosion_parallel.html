<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZPPM_BOM_EXPLOSION_PARALLEL</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for function ZPPM_BOM_EXPLOSION_PARALLEL</h2>
<h3> Description: BoM Explosion Function(Parallel)</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
FUNCTION ZPPM_BOM_EXPLOSION_PARALLEL.<br />
   </div>
   <div class="codeComment">
*"----------------------------------------------------------------------<br />
*"*"Local Interface:<br />
*"  IMPORTING<br />
*"     VALUE(IV_UP_DW) TYPE  CHAR01 DEFAULT 'F'<br />
*"     VALUE(IV_MEHRS) TYPE  CHAR01 DEFAULT 'S'<br />
*"     VALUE(IV_MDMPS) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_FBSTP) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_SEOPF) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_LEVEL) TYPE  NUMC2 DEFAULT '99'<br />
*"     VALUE(IV_EITEM) TYPE  Z_EITEM OPTIONAL<br />
*"     VALUE(IV_STO) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_HINFO) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_WULPVCK) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_HALI) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_FSTO) TYPE  CHAR01 OPTIONAL<br />
*"     VALUE(IV_PARAL) TYPE  I OPTIONAL<br />
*"  EXPORTING<br />
*"     VALUE(EV_TYPE) TYPE  Z_PTYPE<br />
*"     VALUE(EV_MESSAGE) TYPE  RTC_MESSAGE<br />
*"  TABLES<br />
*"      IT_MATL STRUCTURE  ZSPPM0110<br />
*"      ET_BOMS STRUCTURE  ZSPPM0111 OPTIONAL<br />
*"----------------------------------------------------------------------<br />
********************************************************************<br />
* System       : Mando Next ERP PJT.<br />
* Modules      : PPM.<br />
* Program ID   : ZPPM_BOM_EXPLOSION_PARALLEL.<br />
* T_CODE       : N/A.<br />
* Ref. Program : N/A.<br />
* TYPE         : Function.<br />
* Program Desc.: BoM Explosion_Parallel.<br />
* Create Date  : 2022.07.19.<br />
* Create User  : nerp.tbjung.<br />
********************************************************************<br />
*                         Change History                           *<br />
* ---------  ----------  -----------  -----------------------------*<br />
* Chg. No    Chg. Date   Chg. User          Change Desc.           *<br />
* ---------  ----------  ----------  ------------------------------*<br />
*     N      2022.07.19  nerp.tbjung       ## ##.<br />
*  CN-001    2022.10.27 Header Material# ### Insert # # ###<br />
*  iv_hinfo parameter #### ## ###.<br />
********************************************************************<br />
*---------------------------------------------------------------------*<br />
* description<br />
* - it_matl #### ### BOM #### #### #### #### ##.<br />
<br />
*       Global data declarations<br />
<br />
* input parameters<br />
* - lv_up_dw : f:forward, r:reverse.<br />
* - iv_mehrs : Multilevel Explosion.<br />
* - iv_mdmps : Phantom item indicator.<br />
* - iv_fbstp : Sub-Contract indicator.<br />
* - iv_seopf : Stop Explosion of Purchases<br />
* - iv_level : Max Explosion Level.<br />
<br />
* input tables.<br />
* - it_matl : BOM ## # ## ##.<br />
<br />
* output tables.<br />
* - et_boms : ## # BOM ##.<br />
*---------------------------------------------------------------------*<br />
<br />

<div class="codeComment">*       <a href ="global-zppm_bom_explosion_parallel.html">Global data declarations</a></div><br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;lv_cnt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_maxcnt&nbsp;&nbsp;&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;500.<br />
   </div>
   <div class="codeComment">
*        lv_maxcnt   TYPE i VALUE 1000.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;iv_paral&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-sysid&nbsp;EQ&nbsp;'NRD'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_paral&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;sy-sysid&nbsp;EQ&nbsp;'NRQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_paral&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_paral&nbsp;=&nbsp;20.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;it_matl&nbsp;LINES&nbsp;lv_cnt.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_cnt&nbsp;LE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_type&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_message&nbsp;=&nbsp;text-m01.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_cnt&nbsp;LE&nbsp;lv_maxcnt.<br />
   </div>
   <div class="codeComment">
*   --- BoM ## ## ZPPM_BOM_EXPLOSION ####.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;IF&nbsp;iv_fsto&nbsp;IS&nbsp;INITIAL.&nbsp;&nbsp;"KSLEE&nbsp;20230424<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="../zppm_bom_explosion/zppm_bom_explosion.html">'ZPPM_BOM_EXPLOSION'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_up_dw&nbsp;&nbsp;&nbsp;=&nbsp;iv_up_dw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_mehrs&nbsp;&nbsp;&nbsp;=&nbsp;iv_mehrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_mdmps&nbsp;&nbsp;&nbsp;=&nbsp;iv_mdmps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_seopf&nbsp;&nbsp;&nbsp;=&nbsp;iv_seopf<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_fbstp&nbsp;&nbsp;&nbsp;=&nbsp;iv_fbstp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_level&nbsp;&nbsp;&nbsp;=&nbsp;iv_level<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_eitem&nbsp;&nbsp;&nbsp;=&nbsp;iv_eitem<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_sto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_sto<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_hinfo&nbsp;&nbsp;&nbsp;=&nbsp;iv_hinfo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_wulpvck&nbsp;=&nbsp;iv_wulpvck<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_hali&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_hali<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_matl&nbsp;&nbsp;&nbsp;=&nbsp;it_matl<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_boms&nbsp;&nbsp;&nbsp;=&nbsp;et_boms.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.&nbsp;"KSLEE&nbsp;20230424&nbsp;S<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="../zppm_bom_explosion_sto/zppm_bom_explosion_sto.html">'ZPPM_BOM_EXPLOSION_STO'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_up_dw&nbsp;&nbsp;&nbsp;=&nbsp;iv_up_dw<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_mehrs&nbsp;&nbsp;&nbsp;=&nbsp;iv_mehrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_mdmps&nbsp;&nbsp;&nbsp;=&nbsp;iv_mdmps<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_seopf&nbsp;&nbsp;&nbsp;=&nbsp;iv_seopf<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_fbstp&nbsp;&nbsp;&nbsp;=&nbsp;iv_fbstp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_level&nbsp;&nbsp;&nbsp;=&nbsp;iv_level<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_eitem&nbsp;&nbsp;&nbsp;=&nbsp;iv_eitem<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_sto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_sto<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_hinfo&nbsp;&nbsp;&nbsp;=&nbsp;iv_hinfo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv_hali&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_hali<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_matl&nbsp;&nbsp;&nbsp;=&nbsp;it_matl<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_boms&nbsp;&nbsp;&nbsp;=&nbsp;et_boms.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.&nbsp;&nbsp;"KSLEE&nbsp;20230424&nbsp;E<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;gt_boms,&nbsp;gt_boms[],&nbsp;gs_bpara.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-up_dw&nbsp;&nbsp;&nbsp;=&nbsp;iv_up_dw&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-mehrs&nbsp;&nbsp;&nbsp;=&nbsp;iv_mehrs&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-mdmps&nbsp;&nbsp;&nbsp;=&nbsp;iv_mdmps&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-fbstp&nbsp;&nbsp;&nbsp;=&nbsp;iv_fbstp&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-seopf&nbsp;&nbsp;&nbsp;=&nbsp;iv_seopf&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-level&nbsp;&nbsp;&nbsp;=&nbsp;iv_level&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-eitem&nbsp;&nbsp;&nbsp;=&nbsp;iv_eitem&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-sto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_sto&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-hinfo&nbsp;&nbsp;&nbsp;=&nbsp;iv_hinfo&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-wulpvck&nbsp;=&nbsp;iv_wulpvck.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-hali&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_hali&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_bpara-fsto&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;iv_fsto&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;bom_explosion_parallel&nbsp;TABLES&nbsp;it_matl<br />
   </div>
   <div class="codeComment">
*                                   USING iv_up_dw<br />
*                                         iv_mehrs<br />
*                                         iv_mdmps<br />
*                                         iv_fbstp<br />
*                                         iv_seopf<br />
*                                         iv_level<br />
*                                         iv_eitem<br />
*                                         iv_hinfo<br />
*                                         iv_wulpvck<br />
*                                         iv_hali<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;iv_paral<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev_message.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;et_boms[]&nbsp;=&nbsp;gt_boms[].<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ev_message&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_type&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;et_boms[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_type&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_s.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_message&nbsp;=&nbsp;text-m02.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_type&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ev_message&nbsp;=&nbsp;text-m03.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFUNCTION.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 756</td>
   </tr>
</table>
</body>
</html>
