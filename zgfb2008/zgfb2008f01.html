<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZGFB2008F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZGFB2008F01</h2>
<h3> Description: Include ZKGR0010F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGFR0010F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_item,&nbsp;gt_item[],&nbsp;gt_disp,&nbsp;gt_disp[].<br />
<br />
&nbsp;&nbsp;gv_begda&nbsp;=&nbsp;|{&nbsp;p_spmon&nbsp;}01|.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;day_in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_begda<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_day_of_month&nbsp;=&nbsp;gv_endda.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;gr_budat.<br />
&nbsp;&nbsp;gr_budat&nbsp;=&nbsp;VALUE&nbsp;#(&nbsp;(&nbsp;sign&nbsp;=&nbsp;'I'&nbsp;option&nbsp;=&nbsp;'BT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;&nbsp;=&nbsp;gv_begda<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high&nbsp;=&nbsp;gv_endda&nbsp;)&nbsp;).<br />
<br />
&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;abap_true.&nbsp;&nbsp;"&nbsp;Import<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;get_data_import.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;abap_true.&nbsp;&nbsp;"&nbsp;Export<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;get_data_export.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.                    " GET_DATA<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_grid_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0110 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;Field&nbsp;catalog<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container_0110<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'G_CCONTA'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid_0110<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container_0110<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0110.<br />
&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_0110&nbsp;gt_item_rp[]&nbsp;gt_lvc_fcat[].<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_0110&nbsp;gt_disp_rp[]&nbsp;gt_lvc_fcat[].<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_grid_0120<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0120 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container_0120<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'G_CCONTB'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid_0120<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container_0120<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0120.<br />
&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_0120&nbsp;gt_item[]&nbsp;gt_lvc_fcat[].<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_0120&nbsp;gt_disp[]&nbsp;gt_lvc_fcat[].<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_grid_0200<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_grid_0200 .<br />
<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_ui_functions[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_lvc_fcat[].<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Custom&nbsp;Container&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_container_0200<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'CUSTOM_MG'.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;Grid&nbsp;Object<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lcl_grid_0200<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lcl_container_0200<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_appl_events&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;layout_attribute&nbsp;CHANGING&nbsp;gs_layo.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Grid&nbsp;Layout<br />
&nbsp;&nbsp;PERFORM&nbsp;toolbar_part&nbsp;&nbsp;USING&nbsp;'GT_UI_FUNCTIONS'.&nbsp;&nbsp;"&nbsp;Tool&nbsp;Bar<br />
&nbsp;&nbsp;PERFORM&nbsp;form_fcat&nbsp;TABLES&nbsp;gt_lvc_fcat.<br />
&nbsp;&nbsp;PERFORM&nbsp;event_handler_register_0200.<br />
&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_0200&nbsp;gt_item_mg[]&nbsp;gt_lvc_fcat[].<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;alv_display_part&nbsp;USING&nbsp;lcl_grid_0200&nbsp;gt_disp_mg[]&nbsp;gt_lvc_fcat[].<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;LAYOUT_ATTRIBUTE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GS_LAYO<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM layout_attribute  CHANGING ps_lvc_layo TYPE lvc_s_layo.<br />
<br />
&nbsp;&nbsp;ps_lvc_layo-cwidth_opt&nbsp;=&nbsp;'A'.&nbsp;&nbsp;"Optimize&nbsp;column&nbsp;width<br />
&nbsp;&nbsp;ps_lvc_layo-zebra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.&nbsp;&nbsp;"Alternating&nbsp;line&nbsp;color&nbsp;(striped)<br />
&nbsp;&nbsp;ps_lvc_layo-sel_mode&nbsp;&nbsp;&nbsp;=&nbsp;'D'.&nbsp;&nbsp;"Selection&nbsp;mode<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ps_lvc_layo-sel_mode&nbsp;&nbsp;&nbsp;=&nbsp;'A'.&nbsp;&nbsp;"Selection&nbsp;mode<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ps_lvc_layo-ctab_fname&nbsp;=&nbsp;'COLTAB'.<br />
&nbsp;&nbsp;ps_lvc_layo-stylefname&nbsp;=&nbsp;'CELLTAB'.<br />
&nbsp;&nbsp;ps_lvc_layo-smalltitle&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ps_lvc_layo-no_rowmark&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;ps_lvc_layo-no_merging&nbsp;=&nbsp;''.<br />
<br />
&nbsp;&nbsp;gs_variant-report&nbsp;=&nbsp;sy-repid.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;toolbar_part<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM toolbar_part  USING p_t_ui_functions.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;:&nbsp;&lt;table&gt;&nbsp;TYPE&nbsp;ui_functions.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;l_table_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;feld-name.<br />
<br />
&nbsp;&nbsp;CONCATENATE&nbsp;p_t_ui_functions&nbsp;'[]'&nbsp;INTO&nbsp;&nbsp;l_table_name.<br />
&nbsp;&nbsp;ASSIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(l_table_name)&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;&lt;table&gt;.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;append_exclude_functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES&nbsp;&nbsp;&lt;table&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;:&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_undo,&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_auf,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;????&nbsp;&AUF<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_AVERAGE,&nbsp;&nbsp;"&nbsp;&AVERAGE<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_back_classic,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CALL_ABC,&nbsp;"&nbsp;&ABC<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_chain,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_crbatch,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_crweb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_lineitems,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_master_data,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_more,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CALL_REPORT,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_call_xint,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CALL_XXL,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_col_invisible,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_col_optimize,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CURRENT_VARIANT,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_data_save,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_DELETE_FILTER,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_DESELECT_ALL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_DETAIL,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expcrdata,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expcrdesig,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expcrtempl,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_expmdb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_extend,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_f4,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_FILTER,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_FIND,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_FIX_COLUMNS,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_graph,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_help,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_info,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOAD_VARIANT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_COPY,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;?&nbsp;??<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_html,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_copy_row,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;?&nbsp;??<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_cut,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;??<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_delete_row,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;???<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_insert_row,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;???<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_move_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_append_row,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;????<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_paste,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;????<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_loc_paste_new_row,&nbsp;"&nbsp;????<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_MAINTAIN_VARIANT,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_maximum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_minimum,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PC_FILE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT_BACK,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT_PREV,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_reprep,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SAVE_VARIANT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SELECT_ALL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SEND,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SEPARATOR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SORT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SORT_ASC,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SORT_DSC,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SUBTOT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_SUM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_TO_OFFICE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_TO_REP_TREE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_UNFIX_COLUMNS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEWS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEW_CRYSTAL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEW_EXCEL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEW_GRID,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_WORD_PROCESSOR,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_refresh,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_gui_alv_grid=&gt;mc_fc_check.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;append_exclude_functions<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;&lt;TABLE&gt;<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_UND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM append_exclude_functions   TABLES pt_table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;p_value&nbsp;&nbsp;TYPE&nbsp;&nbsp;any.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;ls_exclude&nbsp;TYPE&nbsp;ui_func.<br />
<br />
&nbsp;&nbsp;ls_exclude&nbsp;=&nbsp;p_value.<br />
&nbsp;&nbsp;APPEND&nbsp;ls_exclude&nbsp;TO&nbsp;pt_table.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;FORM_FCAT_disp<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_LVC_FCAT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM form_fcat  TABLES pt_fcat_alv TYPE lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_fcat&nbsp;TYPE&nbsp;lvc_s_fcat.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;pt_fcat_alv,&nbsp;pt_fcat_alv[].<br />
<br />
&nbsp;&nbsp;DEFINE&nbsp;add_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-fieldname&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-col_pos&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-outputlen&nbsp;=&nbsp;&3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-coltext&nbsp;&nbsp;&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_l&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_m&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-scrtext_s&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_fcat&nbsp;TO&nbsp;&5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_fcat.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;-------------------------------------------------------------<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FIELD,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POS,&nbsp;LEN,&nbsp;&nbsp;&nbsp;TEXT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FCAT<br />
*&nbsp;-------------------------------------------------------------<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;gv_dynnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0110'.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;"=====&nbsp;IMPORT&nbsp;RP&nbsp;:&nbsp;GT_ITEM_RP&nbsp;=====<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LIFNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;10&nbsp;'Supplier'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-convexit&nbsp;&nbsp;=&nbsp;'ALPHA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'NAME1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;20&nbsp;'Supplier&nbsp;Name'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LAND1_IMP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;5&nbsp;'Country2'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'T005'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TYP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;30&nbsp;'Typ&nbsp;Transakcji'&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TRANSP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;20&nbsp;'Transport'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'INCO1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;10&nbsp;'Incoterms'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'CCNGN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;12&nbsp;'HS&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'DESC'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;30&nbsp;'T#UMACZENIE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'AMOUNT_PLN'&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;15&nbsp;'Amount&nbsp;[PLN]'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-do_sum&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TOTAL_WEIGHT'&nbsp;10&nbsp;16&nbsp;'Total&nbsp;Weight[kg]'&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-do_sum&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;"=====&nbsp;EXPORT&nbsp;RP&nbsp;:&nbsp;GT_DISP_RP&nbsp;=====<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'STCEG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;20&nbsp;'NIP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'INCO1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;10&nbsp;'Incoterms'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TYP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;30&nbsp;'Nr&nbsp;transakcji'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TRANSP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;20&nbsp;'Nr&nbsp;transport'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'CCNGN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;12&nbsp;'HS&nbsp;CODE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'REMARK'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;30&nbsp;'T#UMACZENIE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'AMOUNT_PLN'&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;15&nbsp;'Total&nbsp;amount&nbsp;[PLN]'&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-do_sum&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TOTAL_WEIGHT'&nbsp;&nbsp;8&nbsp;16&nbsp;'Total&nbsp;weight[kg]'&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-do_sum&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0120'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LIFNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;10&nbsp;'Supplier'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-convexit&nbsp;&nbsp;=&nbsp;'ALPHA'.&nbsp;&nbsp;"&nbsp;&lt;--&nbsp;ALPHA&nbsp;Conversion<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LAND1_SUP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;5&nbsp;'Country1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'NAME1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;20&nbsp;'Supplier&nbsp;Desc.'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'MATNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;18&nbsp;'Material'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'MAKTX'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;25&nbsp;'Material&nbsp;Desc.'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'BUDAT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;10&nbsp;'Posting&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'ERFMG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;13&nbsp;'Receipt&nbsp;Qty'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'NETPR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;15&nbsp;'Net&nbsp;Price'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'WAERS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;5&nbsp;'Curr.'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'PEINH'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;5&nbsp;'Price&nbsp;Unit'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'UNIT_PRICE'&nbsp;&nbsp;&nbsp;11&nbsp;15&nbsp;'Unit&nbsp;Price'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'AMOUNT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;15&nbsp;'Amount'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'EX_RATE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;10&nbsp;'Ex-Rate'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'AMOUNT_PLN'&nbsp;&nbsp;&nbsp;14&nbsp;15&nbsp;'Amount&nbsp;[PLN]'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'WEIGHT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;10&nbsp;'Unit&nbsp;Weight[kg]'&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TOTAL_WEIGHT'&nbsp;16&nbsp;15&nbsp;'Total&nbsp;Weight[kg]'&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'CCNGN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;10&nbsp;'Hs&nbsp;code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'REMARK'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;20&nbsp;'Remark'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LAND1_IMP'&nbsp;&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;5&nbsp;'Country2'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'INCO1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;10&nbsp;'Incoterms'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'BUKRS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;6&nbsp;&nbsp;'Company'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'FKDAT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;10&nbsp;&nbsp;'Billing&nbsp;Date'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'KUNWE_ANA'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;10&nbsp;&nbsp;'Ship-to'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LAND1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;'Country'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'XEGLD'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;5&nbsp;&nbsp;'Region'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'KUNWE_NM'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;20&nbsp;&nbsp;'Ship-to&nbsp;Desc.'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'MATNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;18&nbsp;&nbsp;'Material'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'KDMAT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;18&nbsp;&nbsp;'Cust.&nbsp;Material'&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'FKIMG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;13&nbsp;&nbsp;'Billed&nbsp;Qty.'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'KBETR_ZPR1'&nbsp;&nbsp;&nbsp;10&nbsp;15&nbsp;&nbsp;'Sales&nbsp;Price'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'NETWR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;15&nbsp;&nbsp;'Net&nbsp;Amount'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'WAERK'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;5&nbsp;&nbsp;'Curr.'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'STCEG'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;20&nbsp;&nbsp;'NIP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'UNIT_PRICE'&nbsp;&nbsp;&nbsp;14&nbsp;15&nbsp;&nbsp;'Unit&nbsp;Price'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'AMOUNT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;15&nbsp;&nbsp;'Amount'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'EX_RATE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;10&nbsp;&nbsp;'Ex-Rate'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'AMOUNT_PLN'&nbsp;&nbsp;&nbsp;17&nbsp;15&nbsp;&nbsp;'Amount&nbsp;[PLN]'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'WEIGHT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;10&nbsp;&nbsp;'Unit&nbsp;Weight[kg]'&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'TOTAL_WEIGHT'&nbsp;19&nbsp;15&nbsp;&nbsp;'Total&nbsp;Weight[kg]'&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'REMARK'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;20&nbsp;&nbsp;'Description'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'CCNGN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21&nbsp;10&nbsp;&nbsp;'HS&nbsp;Code'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'INCO1'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;10&nbsp;&nbsp;'Incoterms'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0200'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;pt_fcat_alv[].<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;lv_idx&nbsp;&nbsp;TYPE&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"=====&nbsp;Supplier&nbsp;Management&nbsp;:&nbsp;ty_item_mg&nbsp;/&nbsp;gt_item_mg&nbsp;=====<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'BUKRS'&nbsp;1&nbsp;6&nbsp;&nbsp;'Company'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'T001'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_false.&nbsp;&nbsp;"&nbsp;410&nbsp;##&nbsp;#&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LIFNR'&nbsp;&nbsp;2&nbsp;10&nbsp;'Supplier'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-convexit&nbsp;&nbsp;=&nbsp;'ALPHA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'NAME1'&nbsp;&nbsp;3&nbsp;25&nbsp;'Supplier&nbsp;Name'&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_false.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'INCO1'&nbsp;&nbsp;4&nbsp;10&nbsp;'Incoterms'&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'EKKO'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;####<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'INCO1'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'MATNR'&nbsp;&nbsp;5&nbsp;18&nbsp;'Material'&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'MARA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-convexit&nbsp;&nbsp;=&nbsp;'MATN1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#&nbsp;Country&nbsp;##&nbsp;###&nbsp;#####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'LAND1'&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;'Country'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'T005'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'LAND1'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"=====&nbsp;Customer&nbsp;Management&nbsp;:&nbsp;ty_disp_mg&nbsp;/&nbsp;gt_disp_mg&nbsp;=====<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'BUKRS'&nbsp;1&nbsp;6&nbsp;&nbsp;'Company'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'T001'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'BUKRS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_false.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'KUNNR'&nbsp;2&nbsp;10&nbsp;'Customer'&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'KNA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'KUNNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-convexit&nbsp;&nbsp;=&nbsp;'ALPHA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'NAME1'&nbsp;3&nbsp;25&nbsp;'Customer&nbsp;Name'&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'KNA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_false.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'STCEG'&nbsp;&nbsp;&nbsp;4&nbsp;20&nbsp;'NIP'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'KNA1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'STCEG'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EU&nbsp;VAT&nbsp;No.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_fcat&nbsp;'INCO1'&nbsp;5&nbsp;10&nbsp;'Incoterms'&nbsp;&nbsp;&nbsp;pt_fcat_alv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;LINES&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_fcat_alv&nbsp;INTO&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'VBAK'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;####<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-ref_field&nbsp;=&nbsp;'INCO1'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;pt_fcat_alv&nbsp;FROM&nbsp;ls_fcat&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_REGISTER_0110<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0110.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0110-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0110-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
*&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_toolbar&nbsp;FOR&nbsp;lcl_grid.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid_0110.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid_0110.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_double_click&nbsp;FOR&nbsp;lcl_grid_0110.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_hotspot_click&nbsp;FOR&nbsp;lcl_grid_0110.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_REGISTER_0120<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0120.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0120-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0120-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
*&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_toolbar&nbsp;FOR&nbsp;lcl_grid.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;FOR&nbsp;lcl_grid_0120.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;FOR&nbsp;lcl_grid_0120.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_double_click&nbsp;FOR&nbsp;lcl_grid_0120.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_hotspot_click&nbsp;FOR&nbsp;lcl_grid_0120.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;EVENT_HANDLER_REGISTER_0200<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM event_handler_register_0200.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_input&nbsp;TYPE&nbsp;int4.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0200-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE-DIS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;lv_input&nbsp;=&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_INPUT&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0200-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;lv_input.<br />
<br />
   </div>
   <div class="codeComment">
*--Creating&nbsp;an&nbsp;instance&nbsp;for&nbsp;the&nbsp;event&nbsp;handler<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;gr_event_handler.<br />
   </div>
   <div class="codeComment">
*--Registering&nbsp;handler&nbsp;methods&nbsp;to&nbsp;handle&nbsp;ALV&nbsp;Grid&nbsp;events<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_toolbar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;lcl_grid_0200.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_user_command&nbsp;&nbsp;FOR&nbsp;lcl_grid_0200.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_data_changed&nbsp;&nbsp;FOR&nbsp;lcl_grid_0200.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_double_click&nbsp;&nbsp;FOR&nbsp;lcl_grid_0200.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;gr_event_handler-&gt;handle_hotspot_click&nbsp;FOR&nbsp;lcl_grid_0200.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_DISPLAY_PART<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM alv_display_part USING io_grid     TYPE REF TO cl_gui_alv_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcat&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_t_fcat.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;io_grid-&gt;set_table_for_first_display<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_toolbar_excluding&nbsp;=&nbsp;gt_ui_functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_default&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;it_outtab[]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;it_fieldcat[].<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_data_import<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data_import .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;DISTINCT&nbsp;a~key1,&nbsp;a~key2,&nbsp;a~key3,&nbsp;a~key4,&nbsp;a~key5,&nbsp;a~key6<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;matdoc&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'4101'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~budat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;@gr_budat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~cancelled&nbsp;=&nbsp;@space<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~bwart&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;('101','122','161')<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@DATA(lt_matdoc).<br />
<br />
<br />
WITH<br />
&nbsp;&nbsp;+mseg&nbsp;AS&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;DISTINCT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~mblnr,&nbsp;a~mjahr,&nbsp;a~zeile,&nbsp;a~lfbja,&nbsp;a~lfbnr,&nbsp;a~lfpos,&nbsp;a~budat,&nbsp;a~z_revlv,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~shipment_no,&nbsp;a~line_no,&nbsp;a~lifnr,&nbsp;a~werks,&nbsp;a~matnr,&nbsp;a~lgort,&nbsp;a~erfme,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~erfmg,&nbsp;a~xblnr,&nbsp;a~bwart,&nbsp;a~shkzg,&nbsp;a~usnam,&nbsp;a~ebeln,&nbsp;a~ebelp,&nbsp;a~bktxt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAST(&nbsp;left(&nbsp;a~budat,&nbsp;6&nbsp;)&nbsp;AS&nbsp;NUMC(&nbsp;6&nbsp;)&nbsp;)&nbsp;AS&nbsp;spmon,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;land1_sup,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~name1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;name1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e~maktx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;maktx,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~weight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;weight,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~remark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;remark<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;@lt_matdoc&nbsp;AS&nbsp;f<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;matdoc&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~key1&nbsp;=&nbsp;f~key1&nbsp;AND&nbsp;a~key2&nbsp;=&nbsp;f~key2&nbsp;AND&nbsp;a~key3&nbsp;=&nbsp;f~key3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~key4&nbsp;=&nbsp;f~key4&nbsp;AND&nbsp;a~key5&nbsp;=&nbsp;f~key5&nbsp;AND&nbsp;a~key6&nbsp;=&nbsp;f~key6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;lfa1&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;b~lifnr&nbsp;=&nbsp;a~lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;t005&nbsp;AS&nbsp;eu<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;eu~land1&nbsp;=&nbsp;b~land1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;eu~xegld&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zgft0003&nbsp;AS&nbsp;c<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;c~matnr&nbsp;=&nbsp;a~matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~bukrs&nbsp;=&nbsp;'M410'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~datab&nbsp;&lt;&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~datbi&nbsp;&gt;&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;makt&nbsp;AS&nbsp;e<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;e~matnr&nbsp;=&nbsp;a~matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;e~spras&nbsp;=&nbsp;@sy-langu<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;b~land1&nbsp;&lt;&gt;&nbsp;'PL'&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;),<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;###&nbsp;(##&nbsp;##)<br />
&nbsp;&nbsp;+imp_mat&nbsp;AS&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;lifnr,&nbsp;matnr,&nbsp;land1,&nbsp;inco1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft2008_imp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;matnr&nbsp;IS&nbsp;NOT&nbsp;INITIAL<br />
&nbsp;&nbsp;),<br />
<br />
&nbsp;&nbsp;"&nbsp;#####(##&nbsp;##)&nbsp;#&nbsp;(##)<br />
&nbsp;&nbsp;+imp_vnd&nbsp;AS&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;lifnr,&nbsp;land1,&nbsp;inco1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft2008_imp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;matnr&nbsp;IS&nbsp;INITIAL<br />
&nbsp;&nbsp;),<br />
<br />
&nbsp;&nbsp;+po&nbsp;AS&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;DISTINCT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~werks,&nbsp;a~lifnr,&nbsp;a~mblnr,&nbsp;a~mjahr,&nbsp;a~zeile,&nbsp;a~ebeln,&nbsp;a~ebelp,&nbsp;a~budat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~netpr,&nbsp;c~peinh,&nbsp;d~waers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;+mseg&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ekbe&nbsp;&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;b~werks&nbsp;=&nbsp;a~werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~ebeln&nbsp;=&nbsp;a~ebeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~ebelp&nbsp;=&nbsp;a~ebelp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~belnr&nbsp;=&nbsp;a~mblnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~gjahr&nbsp;=&nbsp;a~mjahr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~buzei&nbsp;=&nbsp;a~zeile<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~vgabe&nbsp;=&nbsp;'1'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~bewtp&nbsp;=&nbsp;'E'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ekpo&nbsp;&nbsp;AS&nbsp;c&nbsp;ON&nbsp;c~ebeln&nbsp;=&nbsp;b~ebeln&nbsp;AND&nbsp;c~ebelp&nbsp;=&nbsp;b~ebelp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ekko&nbsp;&nbsp;AS&nbsp;d&nbsp;ON&nbsp;d~ebeln&nbsp;=&nbsp;a~ebeln<br />
&nbsp;&nbsp;)<br />
<br />
SELECT DISTINCT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~lifnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~land1_sup,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~name1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~maktx,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~budat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~erfmg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p~netpr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p~waers,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p~peinh,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~weight,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~remark,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;###&nbsp;#&nbsp;##,&nbsp;###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;dm~lifnr&nbsp;IS&nbsp;NOT&nbsp;NULL&nbsp;THEN&nbsp;dm~land1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;dv~land1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;AS&nbsp;land1_imp,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;dm~lifnr&nbsp;IS&nbsp;NOT&nbsp;NULL&nbsp;THEN&nbsp;dm~inco1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;dv~inco1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;AS&nbsp;inco1<br />
<br />
&nbsp;&nbsp;FROM&nbsp;+mseg&nbsp;AS&nbsp;a<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;+po&nbsp;AS&nbsp;p<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;p~werks&nbsp;=&nbsp;a~werks<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;p~ebeln&nbsp;=&nbsp;a~ebeln<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;p~ebelp&nbsp;=&nbsp;a~ebelp<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;p~mblnr&nbsp;=&nbsp;a~mblnr<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;p~mjahr&nbsp;=&nbsp;a~mjahr<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;p~zeile&nbsp;=&nbsp;a~zeile<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;+imp_mat&nbsp;AS&nbsp;dm<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;dm~lifnr&nbsp;=&nbsp;a~lifnr<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;dm~matnr&nbsp;=&nbsp;a~matnr<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;+imp_vnd&nbsp;AS&nbsp;dv<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;dv~lifnr&nbsp;=&nbsp;a~lifnr<br />
<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_item.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WITH<br />
*&nbsp;&nbsp;+mseg&nbsp;AS&nbsp;(<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;DISTINCT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~mblnr,&nbsp;a~mjahr,&nbsp;a~zeile,&nbsp;a~lfbja,&nbsp;a~lfbnr,&nbsp;a~lfpos,&nbsp;a~budat,&nbsp;a~z_revlv,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~shipment_no,&nbsp;a~line_no,&nbsp;a~lifnr,&nbsp;a~werks,&nbsp;a~matnr,&nbsp;a~lgort,&nbsp;a~erfme,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~erfmg,&nbsp;a~xblnr,&nbsp;a~bwart,&nbsp;a~shkzg,&nbsp;a~usnam,&nbsp;a~ebeln,&nbsp;a~ebelp,&nbsp;a~bktxt,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAST(&nbsp;left(&nbsp;a~budat,&nbsp;6&nbsp;)&nbsp;AS&nbsp;NUMC(&nbsp;6&nbsp;)&nbsp;)&nbsp;AS&nbsp;spmon,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;land1_sup,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~name1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;name1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e~maktx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;maktx,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~weight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;weight,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~ccngn,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~remark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;remark,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;land1_imp,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS&nbsp;inco1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;@lt_matdoc&nbsp;AS&nbsp;f<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;matdoc&nbsp;AS&nbsp;a<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;a~key1&nbsp;=&nbsp;f~key1&nbsp;AND&nbsp;a~key2&nbsp;=&nbsp;f~key2&nbsp;AND&nbsp;a~key3&nbsp;=&nbsp;f~key3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;a~key4&nbsp;=&nbsp;f~key4&nbsp;AND&nbsp;a~key5&nbsp;=&nbsp;f~key5&nbsp;AND&nbsp;a~key6&nbsp;=&nbsp;f~key6<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;lfa1&nbsp;AS&nbsp;b<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;b~lifnr&nbsp;=&nbsp;a~lifnr<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;t005&nbsp;AS&nbsp;eu<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;eu~land1&nbsp;=&nbsp;b~land1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;eu~xegld&nbsp;=&nbsp;'X'<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zgft0003&nbsp;AS&nbsp;c<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;c~matnr&nbsp;=&nbsp;a~matnr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~bukrs&nbsp;=&nbsp;'M410'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~datab&nbsp;&lt;&nbsp;@sy-datum<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;c~datbi&nbsp;&gt;&nbsp;@sy-datum<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;zgft2008_imp&nbsp;AS&nbsp;d<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;d~matnr&nbsp;=&nbsp;a~matnr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;d~lifnr&nbsp;=&nbsp;a~lifnr<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;makt&nbsp;AS&nbsp;e<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;e~matnr&nbsp;=&nbsp;a~matnr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;e~spras&nbsp;=&nbsp;@sy-langu<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;b~land1&nbsp;&lt;&gt;&nbsp;'PL'&nbsp;&nbsp;&nbsp;"&nbsp;#&nbsp;###&nbsp;###&nbsp;##&nbsp;(Intrastat&nbsp;##)<br />
*&nbsp;&nbsp;),<br />
*<br />
*&nbsp;&nbsp;+po&nbsp;AS&nbsp;(<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;DISTINCT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~werks,&nbsp;a~lifnr,&nbsp;a~mblnr,&nbsp;a~mjahr,&nbsp;a~zeile,&nbsp;a~ebeln,&nbsp;a~ebelp,&nbsp;a~budat,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~netpr,&nbsp;c~peinh,&nbsp;d~waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##/##/##<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;+mseg&nbsp;AS&nbsp;a<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ekbe&nbsp;&nbsp;AS&nbsp;b<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;b~werks&nbsp;=&nbsp;a~werks<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~ebeln&nbsp;=&nbsp;a~ebeln<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~ebelp&nbsp;=&nbsp;a~ebelp<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~belnr&nbsp;=&nbsp;a~mblnr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~gjahr&nbsp;=&nbsp;a~mjahr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~buzei&nbsp;=&nbsp;a~zeile<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~vgabe&nbsp;=&nbsp;'1'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;b~bewtp&nbsp;=&nbsp;'E'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ekpo&nbsp;&nbsp;AS&nbsp;c&nbsp;ON&nbsp;c~ebeln&nbsp;=&nbsp;b~ebeln&nbsp;AND&nbsp;c~ebelp&nbsp;=&nbsp;b~ebelp<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ekko&nbsp;&nbsp;AS&nbsp;d&nbsp;ON&nbsp;d~ebeln&nbsp;=&nbsp;a~ebeln<br />
*&nbsp;&nbsp;)<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;DISTINCT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~lifnr,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~land1_sup,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~name1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~matnr,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~maktx,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~budat,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~erfmg,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p~netpr,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p~waers,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p~peinh,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~weight,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~ccngn,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~remark,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~land1_imp,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~inco1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;+mseg&nbsp;AS&nbsp;a<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;+po&nbsp;AS&nbsp;p<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;p~werks&nbsp;=&nbsp;a~werks<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;p~ebeln&nbsp;=&nbsp;a~ebeln<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;p~ebelp&nbsp;=&nbsp;a~ebelp<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;p~mblnr&nbsp;=&nbsp;a~mblnr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;p~mjahr&nbsp;=&nbsp;a~mjahr<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;p~zeile&nbsp;=&nbsp;a~zeile<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@gt_item.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;gt_item.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;gt_item.<br />
<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_item&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;r&gt;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;r&gt;-peinh&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-unit_price&nbsp;=&nbsp;&lt;r&gt;-netpr&nbsp;/&nbsp;&lt;r&gt;-peinh.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-amount&nbsp;=&nbsp;&lt;r&gt;-unit_price&nbsp;*&nbsp;&lt;r&gt;-erfmg.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;&lt;r&gt;-ex_rate.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;&lt;r&gt;-waers.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'USD'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-ex_rate&nbsp;=&nbsp;p_usd.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'EUR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-ex_rate&nbsp;=&nbsp;p_eur.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;r&gt;-ex_rate&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-amount_pln&nbsp;=&nbsp;&lt;r&gt;-amount&nbsp;*&nbsp;&lt;r&gt;-ex_rate.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;r&gt;-weight&nbsp;IS&nbsp;NOT&nbsp;INITIAL&nbsp;AND&nbsp;&lt;r&gt;-erfmg&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-total_weight&nbsp;=&nbsp;&lt;r&gt;-weight&nbsp;*&nbsp;&lt;r&gt;-erfmg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_rp_hash&nbsp;TYPE&nbsp;HASHED&nbsp;TABLE&nbsp;OF&nbsp;ty_item_rp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;lifnr&nbsp;land1_imp&nbsp;ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_item_rp.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS:&nbsp;&lt;s&gt;&nbsp;&nbsp;TYPE&nbsp;ty_item,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;rs&gt;&nbsp;TYPE&nbsp;ty_item_rp.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_item_rp[],&nbsp;lt_rp_hash[].<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_item&nbsp;ASSIGNING&nbsp;&lt;s&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_rp_hash&nbsp;ASSIGNING&nbsp;&lt;rs&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;TABLE&nbsp;KEY&nbsp;lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;land1_imp&nbsp;=&nbsp;&lt;s&gt;-land1_imp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-ccngn.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_rp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-name1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-name1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-land1_imp&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-land1_imp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-typ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'11&nbsp;-&nbsp;KUPNO&nbsp;SPRZEDA#'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-transp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'3&nbsp;-&nbsp;DROGOWY'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-inco1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-ccngn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-desc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-remark.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;T#UMACZENIE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-amount_pln&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-total_weight&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_rp&nbsp;INTO&nbsp;TABLE&nbsp;lt_rp_hash&nbsp;ASSIGNING&nbsp;&lt;rs&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;rs&gt;-name1&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;&lt;s&gt;-name1&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;rs&gt;-name1&nbsp;=&nbsp;&lt;s&gt;-name1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;rs&gt;-inco1&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;&lt;s&gt;-inco1&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;rs&gt;-inco1&nbsp;=&nbsp;&lt;s&gt;-inco1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;rs&gt;-desc&nbsp;&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;&lt;s&gt;-remark&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;rs&gt;-desc&nbsp;&nbsp;=&nbsp;&lt;s&gt;-remark.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;rs&gt;-amount_pln&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;rs&gt;-amount_pln&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&lt;s&gt;-amount_pln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;rs&gt;-total_weight&nbsp;&nbsp;=&nbsp;&lt;rs&gt;-total_weight&nbsp;&nbsp;+&nbsp;&lt;s&gt;-total_weight.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;gt_item_rp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;lt_rp_hash&nbsp;).<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_item_rp&nbsp;BY&nbsp;lifnr&nbsp;name1&nbsp;land1_imp&nbsp;ccngn.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;get_data_export<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data_export .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;lv_rate&nbsp;TYPE&nbsp;p&nbsp;LENGTH&nbsp;16&nbsp;DECIMALS&nbsp;6.<br />
<br />
&nbsp;&nbsp;"---------------------------<br />
&nbsp;&nbsp;"&nbsp;1)&nbsp;RAW&nbsp;#&nbsp;gt_disp&nbsp;(Export)<br />
&nbsp;&nbsp;"---------------------------<br />
&nbsp;&nbsp;DATA:&nbsp;lt_disp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ty_disp.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_disp[],&nbsp;lt_disp[].<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;vbrk~bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrk~fkdat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrp~kunwe_ana,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kna1~land1&nbsp;AS&nbsp;land1,&nbsp;&nbsp;&nbsp;"&nbsp;####:&nbsp;###&nbsp;#&nbsp;KNA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t005~xegld,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kna1~name1&nbsp;AS&nbsp;kunwe_nm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrp~matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrp~kdmat,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrp~fkimg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrp~netwr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbrk~waerk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zexp~stceg,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;NIP&nbsp;(##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coalesce(&nbsp;zexp~inco1,&nbsp;vbrk~inco1&nbsp;)&nbsp;AS&nbsp;inco1,&nbsp;&nbsp;"&nbsp;##&nbsp;###&nbsp;####&nbsp;INCO1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z3~weight,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z3~ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z3~remark<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@lt_disp<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;vbrk<br />
&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;vbrp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;vbrk~vbeln&nbsp;=&nbsp;vbrp~vbeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;&nbsp;JOIN&nbsp;kna1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;kna1~kunnr&nbsp;=&nbsp;vbrp~kunwe_ana<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;&nbsp;JOIN&nbsp;t005<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;t005~land1&nbsp;=&nbsp;kna1~land1<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;&nbsp;JOIN&nbsp;zgft0003&nbsp;AS&nbsp;z3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;z3~matnr&nbsp;=&nbsp;vbrp~matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;z3~bukrs&nbsp;=&nbsp;@c_bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;z3~datab&nbsp;&lt;=&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;z3~datbi&nbsp;&gt;=&nbsp;@sy-datum<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;&nbsp;JOIN&nbsp;zgft2008_exp&nbsp;AS&nbsp;zexp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;zexp~bukrs&nbsp;=&nbsp;vbrk~bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;zexp~kunnr&nbsp;=&nbsp;vbrp~kunwe_ana<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;vbrk~fksto&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;vbrk~bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQ&nbsp;@p_bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;M410&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;vbrk~fkdat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;@gr_budat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;1#~##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;t005~xegld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EU&nbsp;###<br />
<br />
&nbsp;&nbsp;"&nbsp;###:&nbsp;##/##/##/##<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_disp&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;d&gt;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##:&nbsp;##&nbsp;#&nbsp;/&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;d&gt;-fkimg&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;d&gt;-unit_price&nbsp;=&nbsp;&lt;d&gt;-netwr&nbsp;/&nbsp;&lt;d&gt;-fkimg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##(####)&nbsp;#&nbsp;PLN&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;d&gt;-amount&nbsp;=&nbsp;&lt;d&gt;-netwr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;&lt;d&gt;-ex_rate.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;&lt;d&gt;-waerk.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'USD'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;d&gt;-ex_rate&nbsp;=&nbsp;p_usd.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'EUR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;d&gt;-ex_rate&nbsp;=&nbsp;p_eur.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;d&gt;-ex_rate&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;d&gt;-amount_pln&nbsp;=&nbsp;&lt;d&gt;-amount&nbsp;*&nbsp;&lt;d&gt;-ex_rate.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;=&nbsp;(####&nbsp;*&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;d&gt;-weight&nbsp;IS&nbsp;NOT&nbsp;INITIAL&nbsp;AND&nbsp;&lt;d&gt;-fkimg&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;d&gt;-total_weight&nbsp;=&nbsp;&lt;d&gt;-weight&nbsp;*&nbsp;&lt;d&gt;-fkimg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;gt_disp&nbsp;=&nbsp;lt_disp.<br />
<br />
&nbsp;&nbsp;"===========================<br />
&nbsp;&nbsp;"&nbsp;2)&nbsp;gt_disp&nbsp;#&nbsp;gt_disp_rp&nbsp;##<br />
&nbsp;&nbsp;"===========================<br />
&nbsp;&nbsp;DATA:&nbsp;lt_rp_hash&nbsp;TYPE&nbsp;HASHED&nbsp;TABLE&nbsp;OF&nbsp;ty_disp_rp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;stceg&nbsp;ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_disp_rp.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS:&nbsp;&lt;s&gt;&nbsp;TYPE&nbsp;ty_disp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;&nbsp;TYPE&nbsp;ty_disp_rp.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_disp_rp[],&nbsp;lt_rp_hash[].<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_disp&nbsp;ASSIGNING&nbsp;&lt;s&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###:&nbsp;NIP&nbsp;+&nbsp;HS&nbsp;CODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_rp_hash&nbsp;ASSIGNING&nbsp;&lt;r&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;TABLE&nbsp;KEY&nbsp;stceg&nbsp;=&nbsp;&lt;s&gt;-stceg<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;=&nbsp;&lt;s&gt;-ccngn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_rp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-stceg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-stceg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-inco1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-typ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'11&nbsp;-&nbsp;KUPNO&nbsp;SPRZEDA#'.&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-transp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'3&nbsp;-&nbsp;DROGOWY'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-ccngn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-remark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;s&gt;-remark.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-amount_pln&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rp-total_weight&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_rp&nbsp;INTO&nbsp;TABLE&nbsp;lt_rp_hash&nbsp;ASSIGNING&nbsp;&lt;r&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;r&gt;-inco1&nbsp;&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;&lt;s&gt;-inco1&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.&nbsp;&lt;r&gt;-inco1&nbsp;&nbsp;=&nbsp;&lt;s&gt;-inco1.&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;r&gt;-remark&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;&lt;s&gt;-remark&nbsp;IS&nbsp;NOT&nbsp;INITIAL.&nbsp;&lt;r&gt;-remark&nbsp;=&nbsp;&lt;s&gt;-remark.&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-amount_pln&nbsp;&nbsp;&nbsp;=&nbsp;&lt;r&gt;-amount_pln&nbsp;&nbsp;&nbsp;+&nbsp;&lt;s&gt;-amount_pln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;r&gt;-total_weight&nbsp;=&nbsp;&lt;r&gt;-total_weight&nbsp;+&nbsp;&lt;s&gt;-total_weight.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;gt_disp_rp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;lt_rp_hash&nbsp;).<br />
&nbsp;&nbsp;SORT&nbsp;gt_disp_rp&nbsp;BY&nbsp;stceg&nbsp;ccngn.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;handle_toolbar<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_OBJECT<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_INTERACTIVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_toolbar USING i_object TYPE REF TO cl_alv_event_toolbar_set<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_interactive&nbsp;.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_toolbar&nbsp;TYPE&nbsp;stb_button.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_dynnr&nbsp;=&nbsp;200.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_toolbar.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-function&nbsp;=&nbsp;'INSL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-butn_type&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-icon&nbsp;=&nbsp;icon_insert_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-quickinfo&nbsp;=&nbsp;'INSERT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-text&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-disabled&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_toolbar&nbsp;TO&nbsp;i_object-&gt;mt_toolbar.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ls_toolbar.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-function&nbsp;=&nbsp;'DELL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-butn_type&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-icon&nbsp;=&nbsp;icon_delete_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-quickinfo&nbsp;=&nbsp;'DELETE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-text&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_toolbar-disabled&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_toolbar&nbsp;TO&nbsp;i_object-&gt;mt_toolbar.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_IF_SELECTED<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GV_ANSWER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_if_selected.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_selected&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_selected_rows.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lcl_grid_0200-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;gt_selected_rows.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_UCOMM<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;SENDER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_user_command   USING p_ucomm TYPE sy-ucomm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sender&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_gui_alv_grid.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;p_ucomm.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'INSL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;check_if_selected.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;insert_new_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DELL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;check_if_selected.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;delete_selected.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DELETE_SELECTED<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM delete_selected .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_idx&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_selected_rows&nbsp;INTO&nbsp;DATA(ls_rows).<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_rows-index&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_rows-index&nbsp;TO&nbsp;lt_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;IF&nbsp;lt_idx&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_idx&nbsp;DESCENDING.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_idx.<br />
<br />
&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_lines_imp)&nbsp;=&nbsp;lines(&nbsp;gt_item_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_idx&nbsp;INTO&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_idx&nbsp;BETWEEN&nbsp;1&nbsp;AND&nbsp;lv_lines_imp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;gt_item_mg&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA(lv_lines_exp)&nbsp;=&nbsp;lines(&nbsp;gt_disp_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_idx&nbsp;INTO&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_idx&nbsp;BETWEEN&nbsp;1&nbsp;AND&nbsp;lv_lines_exp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;gt_disp_mg&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;lcl_grid_0200-&gt;refresh_table_display(&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INSERT_NEW_ROW<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM insert_new_row.<br />
<br />
&nbsp;&nbsp;CONSTANTS&nbsp;c_bukrs&nbsp;TYPE&nbsp;bukrs&nbsp;VALUE&nbsp;'M410'.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_idx&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_selected_rows&nbsp;INTO&nbsp;ls_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_row-index&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_row-index&nbsp;TO&nbsp;lt_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;SORT&nbsp;lt_idx&nbsp;DESCENDING.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_idx.<br />
<br />
&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"=====&nbsp;Supplier&nbsp;Mg&nbsp;=====<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ls_new_item&nbsp;TYPE&nbsp;ty_item_mg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_new_item-bukrs&nbsp;=&nbsp;c_bukrs.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_idx&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_new_item&nbsp;INTO&nbsp;gt_item_mg&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(total_imp)&nbsp;=&nbsp;lines(&nbsp;gt_item_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_idx&nbsp;INTO&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_idx&nbsp;&lt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;lv_idx&nbsp;&gt;&nbsp;total_imp&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;=&nbsp;total_imp&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_new_item&nbsp;INTO&nbsp;gt_item_mg&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_imp&nbsp;=&nbsp;total_imp&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"=====&nbsp;Customer&nbsp;Mg&nbsp;=====<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ls_new_disp&nbsp;TYPE&nbsp;ty_disp_mg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_new_disp-bukrs&nbsp;=&nbsp;c_bukrs.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_idx&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_new_disp&nbsp;INTO&nbsp;gt_disp_mg&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(total_exp)&nbsp;=&nbsp;lines(&nbsp;gt_disp_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_idx&nbsp;INTO&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_idx&nbsp;&lt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;lv_idx&nbsp;&gt;&nbsp;total_exp&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_idx&nbsp;=&nbsp;total_exp&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ls_new_disp&nbsp;INTO&nbsp;gt_disp_mg&nbsp;INDEX&nbsp;lv_idx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_exp&nbsp;=&nbsp;total_exp&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;#&nbsp;ALV&nbsp;##<br />
&nbsp;&nbsp;lcl_grid_0200-&gt;refresh_table_display(&nbsp;).<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;handle_data_changed<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_DATA_CHANGED<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_data_changed    USING rr_data_changed TYPE REF TO cl_alv_changed_data_protocol.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_mod&nbsp;TYPE&nbsp;lvc_s_modi.<br />
<br />
&nbsp;&nbsp;"&nbsp;0200&nbsp;#####&nbsp;##<br />
&nbsp;&nbsp;IF&nbsp;gv_dynnr&nbsp;&lt;&gt;&nbsp;'0200'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;rr_data_changed-&gt;mt_good_cells&nbsp;INTO&nbsp;ls_mod.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"========================<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Supplier&nbsp;Mg&nbsp;(IMP):&nbsp;LIFNR&nbsp;-&gt;&nbsp;NAME1<br />
&nbsp;&nbsp;&nbsp;&nbsp;"========================<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'&nbsp;AND&nbsp;ls_mod-fieldname&nbsp;=&nbsp;'LIFNR'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;lv_lifnr&nbsp;TYPE&nbsp;lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;lv_name1&nbsp;TYPE&nbsp;name1_gp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_lifnr&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALPHA&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'CONVERSION_EXIT_ALPHA_INPUT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input&nbsp;&nbsp;=&nbsp;lv_lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;lv_lifnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@lv_name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@lv_lifnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_item_mg&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;ls_item&gt;)&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0&nbsp;AND&nbsp;&lt;ls_item&gt;&nbsp;IS&nbsp;ASSIGNED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ls_item&gt;-lifnr&nbsp;=&nbsp;lv_lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ls_item&gt;-name1&nbsp;=&nbsp;lv_name1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mod-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'LIFNR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_lifnr&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mod-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'NAME1'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_name1&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'&nbsp;AND&nbsp;ls_mod-fieldname&nbsp;=&nbsp;'KUNNR'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;lv_kunnr&nbsp;TYPE&nbsp;kunnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;lv_cname&nbsp;TYPE&nbsp;name1_gp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_kunnr&nbsp;=&nbsp;ls_mod-value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'CONVERSION_EXIT_ALPHA_INPUT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input&nbsp;&nbsp;=&nbsp;lv_kunnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;lv_kunnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@lv_cname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;kna1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;kunnr&nbsp;=&nbsp;@lv_kunnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_disp_mg&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;ls_disp&gt;)&nbsp;INDEX&nbsp;ls_mod-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0&nbsp;AND&nbsp;&lt;ls_disp&gt;&nbsp;IS&nbsp;ASSIGNED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ls_disp&gt;-kunnr&nbsp;=&nbsp;lv_kunnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ls_disp&gt;-name1&nbsp;=&nbsp;lv_cname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mod-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'KUNNR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_kunnr&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr_data_changed-&gt;modify_cell(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_mod-row_id<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'NAME1'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_cname&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;DATA(ls_stbl)&nbsp;=&nbsp;VALUE&nbsp;lvc_s_stbl(&nbsp;row&nbsp;=&nbsp;abap_true&nbsp;col&nbsp;=&nbsp;abap_true&nbsp;).<br />
&nbsp;&nbsp;lcl_grid_0200-&gt;refresh_table_display(&nbsp;EXPORTING&nbsp;is_stable&nbsp;=&nbsp;ls_stbl&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_CELL_TAB_0210<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM modify_cell_tab_0200.<br />
<br />
&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_item_mg&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;fs&gt;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;gt_celltab[],&nbsp;gs_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-fieldname&nbsp;=&nbsp;'LAND1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs&gt;-matnr&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_enabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_celltab-style&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_style_disabled.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_celltab&nbsp;TO&nbsp;gt_celltab.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;-celltab&nbsp;=&nbsp;gt_celltab[].<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM save_data .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_answer&nbsp;TYPE&nbsp;c.<br />
<br />
&nbsp;&nbsp;"&nbsp;----&nbsp;###&nbsp;###&nbsp;----<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ins_cnt&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_upd_cnt&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_del_cnt&nbsp;TYPE&nbsp;i&nbsp;VALUE&nbsp;0.<br />
<br />
&nbsp;&nbsp;"&nbsp;----&nbsp;DB&nbsp;##&nbsp;##&nbsp;(##&nbsp;INSERT/UPDATE/DELETE&nbsp;##)&nbsp;----<br />
&nbsp;&nbsp;DATA:&nbsp;lt_zgft2008_imp&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_imp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft2008_exp&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_exp.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_imp_to_ins&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_imp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_imp_to_upd&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_imp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_imp_to_del&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_imp.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_exp_to_ins&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_exp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_exp_to_upd&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_exp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_exp_to_del&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_exp.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_imp_db&nbsp;TYPE&nbsp;HASHED&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_imp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;bukrs&nbsp;lifnr&nbsp;matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_exp_db&nbsp;TYPE&nbsp;HASHED&nbsp;TABLE&nbsp;OF&nbsp;zgft2008_exp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;bukrs&nbsp;kunnr.<br />
<br />
&nbsp;&nbsp;"&nbsp;----&nbsp;#####&nbsp;(GT&nbsp;###)&nbsp;----<br />
&nbsp;&nbsp;DATA:&nbsp;lt_item_mg_work&nbsp;LIKE&nbsp;gt_item_mg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_disp_mg_work&nbsp;LIKE&nbsp;gt_disp_mg.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_new_cmp_imp&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_item_mg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_old_cmp_imp&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_item_mg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_new_cmp_exp&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_disp_mg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_old_cmp_exp&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_disp_mg.<br />
<br />
&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;"&nbsp;1)&nbsp;##&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;titlebar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Save'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_question&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Do&nbsp;you&nbsp;want&nbsp;to&nbsp;save?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Yes'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_button_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'No'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_button&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display_cancel_button&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;answer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_answer.<br />
&nbsp;&nbsp;IF&nbsp;lv_answer&nbsp;&lt;&gt;&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;lv_ins_cnt,&nbsp;lv_upd_cnt,&nbsp;lv_del_cnt.<br />
<br />
&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;"&nbsp;2)&nbsp;IMP&nbsp;##&nbsp;(Vendor&nbsp;##)<br />
&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;IF&nbsp;r_imp&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lt_item_mg_work&nbsp;=&nbsp;gt_item_mg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;lt_item_mg_work&nbsp;BY&nbsp;bukrs&nbsp;lifnr&nbsp;matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_item_mg_work&nbsp;COMPARING&nbsp;bukrs&nbsp;lifnr&nbsp;matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lines(&nbsp;lt_item_mg_work&nbsp;)&nbsp;&lt;&gt;&nbsp;lines(&nbsp;gt_item_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Data&nbsp;duplicated,&nbsp;check&nbsp;data.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft2008_imp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;gt_item_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_zgft2008_imp&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;s_imp&gt;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-bukrs&nbsp;=&nbsp;c_bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;s_imp&gt;-matnr&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;&lt;s_imp&gt;-land1&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;land1&nbsp;INTO&nbsp;@&lt;s_imp&gt;-land1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;@&lt;s_imp&gt;-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft2008_imp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@lt_imp_db<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@c_bukrs.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_zgft2008_imp&nbsp;ASSIGNING&nbsp;&lt;s_imp&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_imp_db&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;db_imp&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;TABLE&nbsp;KEY&nbsp;bukrs&nbsp;=&nbsp;&lt;s_imp&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lifnr&nbsp;=&nbsp;&lt;s_imp&gt;-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnr&nbsp;=&nbsp;&lt;s_imp&gt;-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-erdat&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-erzet&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-ernam&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;&lt;s_imp&gt;-aedat,&nbsp;&lt;s_imp&gt;-aezet,&nbsp;&lt;s_imp&gt;-aenam.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;s_imp&gt;&nbsp;TO&nbsp;lt_imp_to_ins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_new_cmp_imp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;&lt;s_imp&gt;&nbsp;&nbsp;).&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#####&nbsp;#(##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_old_cmp_imp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;&lt;db_imp&gt;&nbsp;).&nbsp;&nbsp;&nbsp;"&nbsp;DB&nbsp;####&nbsp;##&nbsp;###&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_new_cmp_imp&nbsp;&lt;&gt;&nbsp;ls_old_cmp_imp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-erdat&nbsp;=&nbsp;&lt;db_imp&gt;-erdat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-erzet&nbsp;=&nbsp;&lt;db_imp&gt;-erzet.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-ernam&nbsp;=&nbsp;&lt;db_imp&gt;-ernam.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-aedat&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-aezet&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_imp&gt;-aenam&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;s_imp&gt;&nbsp;TO&nbsp;lt_imp_to_upd.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_imp_db&nbsp;ASSIGNING&nbsp;&lt;db_imp&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_zgft2008_imp&nbsp;WITH&nbsp;KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bukrs&nbsp;=&nbsp;&lt;db_imp&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lifnr&nbsp;=&nbsp;&lt;db_imp&gt;-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnr&nbsp;=&nbsp;&lt;db_imp&gt;-matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;db_imp&gt;&nbsp;TO&nbsp;lt_imp_to_del.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_imp_to_ins&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;zgft2008_imp&nbsp;FROM&nbsp;TABLE&nbsp;lt_imp_to_ins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ins_cnt&nbsp;=&nbsp;sy-dbcnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_imp_to_upd&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;zgft2008_imp&nbsp;FROM&nbsp;TABLE&nbsp;lt_imp_to_upd.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_upd_cnt&nbsp;=&nbsp;sy-dbcnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_imp_to_del&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_imp_to_del&nbsp;ASSIGNING&nbsp;&lt;db_imp&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft2008_imp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@&lt;db_imp&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;lifnr&nbsp;=&nbsp;@&lt;db_imp&gt;-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;=&nbsp;@&lt;db_imp&gt;-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_del_cnt&nbsp;=&nbsp;lv_del_cnt&nbsp;+&nbsp;sy-dbcnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;3)&nbsp;EXP&nbsp;##&nbsp;(Customer&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;ELSEIF&nbsp;r_exp&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lt_disp_mg_work&nbsp;=&nbsp;gt_disp_mg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;lt_disp_mg_work&nbsp;BY&nbsp;bukrs&nbsp;kunnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_disp_mg_work&nbsp;COMPARING&nbsp;bukrs&nbsp;kunnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lines(&nbsp;lt_disp_mg_work&nbsp;)&nbsp;&lt;&gt;&nbsp;lines(&nbsp;gt_disp_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Data&nbsp;duplicated,&nbsp;check&nbsp;data.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lt_zgft2008_exp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;gt_disp_mg&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_zgft2008_exp&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;s_exp&gt;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-bukrs&nbsp;=&nbsp;c_bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft2008_exp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@lt_exp_db<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@c_bukrs.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_zgft2008_exp&nbsp;ASSIGNING&nbsp;&lt;s_exp&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_exp_db&nbsp;ASSIGNING&nbsp;FIELD-SYMBOL(&lt;db_exp&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;TABLE&nbsp;KEY&nbsp;bukrs&nbsp;=&nbsp;&lt;s_exp&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kunnr&nbsp;=&nbsp;&lt;s_exp&gt;-kunnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-erdat&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-erzet&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-ernam&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;&lt;s_exp&gt;-aedat,&nbsp;&lt;s_exp&gt;-aezet,&nbsp;&lt;s_exp&gt;-aenam.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;s_exp&gt;&nbsp;TO&nbsp;lt_exp_to_ins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_new_cmp_exp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;&lt;s_exp&gt;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_old_cmp_exp&nbsp;=&nbsp;CORRESPONDING&nbsp;#(&nbsp;&lt;db_exp&gt;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ls_new_cmp_exp&nbsp;&lt;&gt;&nbsp;ls_old_cmp_exp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-erdat&nbsp;=&nbsp;&lt;db_exp&gt;-erdat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-erzet&nbsp;=&nbsp;&lt;db_exp&gt;-erzet.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-ernam&nbsp;=&nbsp;&lt;db_exp&gt;-ernam.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-aedat&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-aezet&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s_exp&gt;-aenam&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;s_exp&gt;&nbsp;TO&nbsp;lt_exp_to_upd.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_exp_db&nbsp;ASSIGNING&nbsp;&lt;db_exp&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_zgft2008_exp&nbsp;WITH&nbsp;KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bukrs&nbsp;=&nbsp;&lt;db_exp&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kunnr&nbsp;=&nbsp;&lt;db_exp&gt;-kunnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;&lt;db_exp&gt;&nbsp;TO&nbsp;lt_exp_to_del.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_exp_to_ins&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;zgft2008_exp&nbsp;FROM&nbsp;TABLE&nbsp;lt_exp_to_ins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ins_cnt&nbsp;=&nbsp;sy-dbcnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_exp_to_upd&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;zgft2008_exp&nbsp;FROM&nbsp;TABLE&nbsp;lt_exp_to_upd.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_upd_cnt&nbsp;=&nbsp;sy-dbcnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lt_exp_to_del&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_exp_to_del&nbsp;ASSIGNING&nbsp;&lt;db_exp&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;zgft2008_exp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;@&lt;db_exp&gt;-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;kunnr&nbsp;=&nbsp;@&lt;db_exp&gt;-kunnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_del_cnt&nbsp;=&nbsp;lv_del_cnt&nbsp;+&nbsp;sy-dbcnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;"&nbsp;4)&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;"-----------------------------<br />
&nbsp;&nbsp;DATA(lv_tag)&nbsp;=&nbsp;COND&nbsp;string(&nbsp;WHEN&nbsp;r_imp&nbsp;=&nbsp;'X'&nbsp;THEN&nbsp;'[IMP]&nbsp;'&nbsp;WHEN&nbsp;r_exp&nbsp;=&nbsp;'X'&nbsp;THEN&nbsp;'[EXP]&nbsp;'&nbsp;ELSE&nbsp;''&nbsp;).<br />
&nbsp;&nbsp;DATA(lv_msg)&nbsp;=&nbsp;|{&nbsp;lv_tag&nbsp;}{&nbsp;lv_ins_cnt&nbsp;}&nbsp;Insert,&nbsp;{&nbsp;lv_upd_cnt&nbsp;}&nbsp;Update,&nbsp;{&nbsp;lv_del_cnt&nbsp;}&nbsp;Delete&nbsp;completed&nbsp;(BUKRS&nbsp;{&nbsp;c_bukrs&nbsp;}).|.<br />
&nbsp;&nbsp;MESSAGE&nbsp;lv_msg&nbsp;TYPE&nbsp;'S'.<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 756</td>
   </tr>
</table>
</body>
</html>
