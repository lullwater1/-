<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZGFR0000</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZGFR0000</h2>
<h3> Description: [Global FTA] Origin Determination</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;PROGRAM&nbsp;ID&nbsp;&nbsp;:&nbsp;ZGFR0000<br />
*&nbsp;Title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;##&nbsp;##<br />
*&nbsp;Created&nbsp;By&nbsp;&nbsp;:&nbsp;KPMG<br />
*&nbsp;Created&nbsp;On&nbsp;&nbsp;:&nbsp;0000-00-00<br />
*&nbsp;Category&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Origin<br />
*&nbsp;Description&nbsp;:&nbsp;##&nbsp;##<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFICATION&nbsp;LOG<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;Date.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Author.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description.<br />
*----------------------------------------------------------------------*<br />
*<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
REPORT  zgfr0000 NO STANDARD PAGE HEADING MESSAGE-ID zgfmc.<br />
<br />
TYPE-POOLS: zgftp.<br />
TABLES: zgft0400,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgft0004,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t001w.<br />
<br />
TABLES : mara.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;Constants<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CONSTANTS: gc_rule_search_count    TYPE i    VALUE 4.    "PSR(RULE) ## ##<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;Type&nbsp;Def<br />
*----------------------------------------------------------------------*<br />
*&nbsp;RULE&nbsp;###<br />
   </div>
   <div class="code">
TYPES: BEGIN OF ty_rule_s,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datab&nbsp;&nbsp;LIKE&nbsp;zgft0001-datab&nbsp;,&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pfona&nbsp;&nbsp;LIKE&nbsp;zgft0001-pfona&nbsp;,&nbsp;"##&nbsp;##&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;LIKE&nbsp;zgft0001-ccngn&nbsp;,&nbsp;"##&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;LIKE&nbsp;zgft0001-ccngns,&nbsp;"HS###&nbsp;##&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-rseq&nbsp;&nbsp;,&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rcn&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-rcn&nbsp;&nbsp;&nbsp;,&nbsp;"###&nbsp;###&nbsp;-&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rct&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-rct&nbsp;&nbsp;&nbsp;,&nbsp;"###&nbsp;###&nbsp;-&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wor&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-wor&nbsp;&nbsp;&nbsp;,&nbsp;"######&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cthr&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-cthr&nbsp;&nbsp;,&nbsp;"######&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdr&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-bdr&nbsp;&nbsp;&nbsp;,&nbsp;"BD&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bur&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-bur&nbsp;&nbsp;&nbsp;,&nbsp;"BU&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ncr&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-ncr&nbsp;&nbsp;&nbsp;,&nbsp;"NC&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcr&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-mcr&nbsp;&nbsp;&nbsp;,&nbsp;"MC&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dmu&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-dmu&nbsp;&nbsp;&nbsp;,&nbsp;"##&nbsp;###&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dmr&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-dmr&nbsp;&nbsp;&nbsp;,&nbsp;"####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exsign&nbsp;LIKE&nbsp;zgft0001-exsign,&nbsp;"####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gid&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0001-gid&nbsp;&nbsp;&nbsp;,&nbsp;"#&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_rule_s.<br />
<br />
DATA: BEGIN OF ty_t0007_s,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pfona&nbsp;LIKE&nbsp;zgft0007-pfona,&nbsp;"FTA&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datab&nbsp;LIKE&nbsp;zgft0007-datab,&nbsp;"##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datbi&nbsp;LIKE&nbsp;zgft0007-datbi,&nbsp;"##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ftana&nbsp;LIKE&nbsp;zgft0007-ftana,&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cdmr&nbsp;&nbsp;LIKE&nbsp;zgft0007-cdmr&nbsp;,&nbsp;"###&nbsp;####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crvcr&nbsp;LIKE&nbsp;zgft0007-crvcr,&nbsp;"###&nbsp;####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inco&nbsp;&nbsp;LIKE&nbsp;zgft0004-inco,&nbsp;&nbsp;"####&nbsp;(##&nbsp;1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_t0007_s.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;Internal&nbsp;Table&nbsp;Def<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA: gs_rule TYPE ty_rule_s,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_rule&nbsp;LIKE&nbsp;gs_rule&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gs_t0002 LIKE zgft0002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0002&nbsp;LIKE&nbsp;zgft0002&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gt_zkgt0004 TYPE TABLE OF zgft0004    WITH HEADER LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_zkgt0007&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgft0007&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gs_inhead TYPE zgft0400,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_inhead&nbsp;LIKE&nbsp;gs_inhead&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_initem&nbsp;TYPE&nbsp;zgft0401,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_initem&nbsp;LIKE&nbsp;gs_initem&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_prhead&nbsp;LIKE&nbsp;gs_inhead&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_pritem&nbsp;LIKE&nbsp;gs_initem&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gs_maggr LIKE zgft0480,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_maggr&nbsp;LIKE&nbsp;gs_maggr&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gs_imhscd LIKE zgft0006,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_imhscd&nbsp;LIKE&nbsp;gs_imhscd&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gs_t5011 LIKE zgft5011,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t5011&nbsp;LIKE&nbsp;gs_t5011&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
DATA: gs_t5013 LIKE zgft5013,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t5013&nbsp;LIKE&nbsp;gs_t5013&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
" ###<br />
DATA: BEGIN OF gs_maktx,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matnr&nbsp;LIKE&nbsp;makt-matnr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maktx&nbsp;LIKE&nbsp;makt-maktx,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;gs_maktx.<br />
DATA: gt_maktx LIKE SORTED TABLE OF gs_maktx<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
" ## ## ##.<br />
DATA: gs_t0510 LIKE zgft0510,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511&nbsp;LIKE&nbsp;zgft0511,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512&nbsp;LIKE&nbsp;zgft0512,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0510&nbsp;LIKE&nbsp;zgft0510&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511&nbsp;LIKE&nbsp;zgft0511&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0512&nbsp;LIKE&nbsp;zgft0512&nbsp;&nbsp;&nbsp;&nbsp;OCCURS&nbsp;0&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;Field-symbols<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FIELD-SYMBOLS: &lt;gf_inhead&gt; LIKE zgft0400,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_initem&gt;&nbsp;LIKE&nbsp;zgft0401.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;Vari&nbsp;Def<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA: g_code   LIKE sy-ucomm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok_code&nbsp;&nbsp;LIKE&nbsp;sy-ucomm,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_answer&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_exit&nbsp;&nbsp;&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_check&nbsp;&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_error&nbsp;&nbsp;TYPE&nbsp;c.<br />
<br />
DATA: g_spmon LIKE zgft0400-spmon,       "###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_detp&nbsp;&nbsp;TYPE&nbsp;zgft0400-detp.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;##/##&nbsp;##<br />
<br />
RANGES: gr_detp    FOR zgft0400-detp.    "##/## ##<br />
<br />
RANGES: gr_pfona   FOR zgft0004-pfona.        "FTA AGREEMENT<br />
<br />
DATA g_guid_ref TYPE zkge_guid_ref.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;Macro<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DEFINE _ranges.<br />
&nbsp;&nbsp;&1-sign&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&1-option&nbsp;=&nbsp;&3.<br />
&nbsp;&nbsp;&1-low&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&4.<br />
&nbsp;&nbsp;&1-high&nbsp;&nbsp;&nbsp;=&nbsp;&5.<br />
&nbsp;&nbsp;APPEND&nbsp;&1.<br />
END-OF-DEFINITION.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;SELECTION&nbsp;-&nbsp;SCREEN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.<br />
   </div>
   <div class="codeComment">
*&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(23)&nbsp;&nbsp;&nbsp;papretp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;24.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PARAMETERS:&nbsp;pa_pretp&nbsp;AS&nbsp;LISTBOX&nbsp;LIKE&nbsp;zgft0400-pretp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VISIBLE&nbsp;LENGTH&nbsp;30<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBLIGATORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USER-COMMAND&nbsp;chg.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(23)&nbsp;&nbsp;&nbsp;padetp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;24.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PARAMETERS:&nbsp;pa_detp&nbsp;TYPE&nbsp;zkge_svalue&nbsp;AS&nbsp;LISTBOX&nbsp;VISIBLE&nbsp;LENGTH&nbsp;30<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBLIGATORY.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(23)&nbsp;&nbsp;&nbsp;pabukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;24.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PARAMETERS:&nbsp;pa_bukrs&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;t001-bukrs&nbsp;&nbsp;OBLIGATORY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;COMMENT&nbsp;45(40)&nbsp;p_butxt."U01&nbsp;##<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;&nbsp;sdatuv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_datuv&nbsp;FOR&nbsp;zgft0400-datuv<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO-EXTENSION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT&nbsp;sy-datlo&nbsp;TO&nbsp;sy-datlo&nbsp;MODIF&nbsp;ID&nbsp;tpi.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;sspmon.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_spmon&nbsp;FOR&nbsp;zgft0400-spmon<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO-EXTENSION&nbsp;NO&nbsp;INTERVALS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT&nbsp;sy-datlo(06)&nbsp;MODIF&nbsp;ID&nbsp;tpg.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;##/####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;&nbsp;ssalno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_salno&nbsp;FOR&nbsp;zgft0400-salno&nbsp;MODIF&nbsp;ID&nbsp;cls.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;&nbsp;szivno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_zivno&nbsp;FOR&nbsp;zgft0400-zivno&nbsp;MODIF&nbsp;ID&nbsp;cls.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;&nbsp;smatnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_matnr&nbsp;FOR&nbsp;zgft0400-matnr&nbsp;MODIF&nbsp;ID&nbsp;cls.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;FTA&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;&nbsp;spfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_pfona&nbsp;FOR&nbsp;zgft0004-pfona&nbsp;"NO-EXTENSION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;INTERVALS.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;COMMENT&nbsp;1(20)&nbsp;&nbsp;&nbsp;swerks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;POSITION&nbsp;&nbsp;21.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT-OPTIONS:&nbsp;s_werks&nbsp;FOR&nbsp;t001w-werks&nbsp;"NO-EXTENSION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;INTERVALS.<br />
&nbsp;&nbsp;SELECTION-SCREEN&nbsp;&nbsp;END&nbsp;&nbsp;&nbsp;OF&nbsp;LINE.<br />
<br />
SELECTION-SCREEN END OF BLOCK b1.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;INITIALIZATION.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
INITIALIZATION.<br />
&nbsp;&nbsp;PERFORM&nbsp;set_init.<br />
&nbsp;&nbsp;PERFORM&nbsp;check_bukrs.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;AT&nbsp;SELECTION-SCREEN&nbsp;OUTPUT.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
AT SELECTION-SCREEN OUTPUT.<br />
&nbsp;&nbsp;PERFORM&nbsp;list_box_set.<br />
&nbsp;&nbsp;PERFORM&nbsp;set_screen_move_radiobt.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;START-OF-SELECTION.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
&nbsp;&nbsp;PERFORM&nbsp;auth_bukrs(zgf_form_sub_routine)&nbsp;USING&nbsp;pa_bukrs.<br />
&nbsp;&nbsp;PERFORM&nbsp;initial_set.<br />
&nbsp;&nbsp;PERFORM&nbsp;set_screen_check.<br />
&nbsp;&nbsp;CHECK&nbsp;g_exit&nbsp;NE&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;selected_oc_preference_data.<br />
&nbsp;&nbsp;CHECK&nbsp;g_exit&nbsp;NE&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;executed_preference.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SET_SCREEN_CHECK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_screen_check .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;pa_pretp.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###,&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-intermediate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;zgftp_pretp-good_issue.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_datuv[]&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s016&nbsp;&nbsp;WITH&nbsp;TEXT-m01&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_exit&nbsp;=&nbsp;zgftp_on.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-closing.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_spmon[]&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s016&nbsp;&nbsp;WITH&nbsp;TEXT-m01&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_exit&nbsp;=&nbsp;zgftp_on.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.                    " SET_SCREEN_CHECK<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SELECTED_OC_PREFERENCE_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INPUT&nbsp;data#&nbsp;####.<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM selected_oc_preference_data .<br />
<br />
&nbsp;&nbsp;RANGES:&nbsp;lr_datuv&nbsp;FOR&nbsp;zgft0400-datuv,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lr_mtype&nbsp;FOR&nbsp;zgft0400-msgty.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_sdate&nbsp;TYPE&nbsp;datum,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_edate&nbsp;TYPE&nbsp;datum.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;pfona&nbsp;AS&nbsp;low&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gr_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0004.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;pa_pretp.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####,&nbsp;####,###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-closing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;zgftp_pretp-free_subcont<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;zgftp_pretp-intermediate.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;s_spmon&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_spmon&nbsp;=&nbsp;s_spmon-low.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;g_spmon&nbsp;'01'&nbsp;INTO&nbsp;lv_sdate.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;g_spmon&nbsp;'31'&nbsp;INTO&nbsp;lv_edate.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ranges:&nbsp;s_datuv&nbsp;&nbsp;zgftp_in&nbsp;zgftp_bt&nbsp;lv_sdate&nbsp;lv_edate,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lr_mtype&nbsp;zgftp_in&nbsp;zgftp_ne&nbsp;zgftp_e&nbsp;&nbsp;space.&nbsp;"ERROR<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ranges:&nbsp;lr_mtype&nbsp;zgftp_in&nbsp;zgftp_ne&nbsp;zgftp_e&nbsp;&nbsp;&nbsp;&nbsp;space.&nbsp;"ERROR<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;s_datuv&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_spmon&nbsp;=&nbsp;s_datuv-high.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;##/##&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;pa_detp.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_detp-export.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_detp&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_detp-export.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'IEQ'&nbsp;zgftp_detp-export&nbsp;&nbsp;INTO&nbsp;gr_detp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gr_detp.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_detp-local.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_detp&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_detp-local.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_detp-sign&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_detp-option&nbsp;=&nbsp;&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_detp-low&nbsp;=&nbsp;zgftp_detp-local&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gr_detp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS."U01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_detp&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_detp-subcontract.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'IEQ'&nbsp;zgftp_detp-subcontract&nbsp;&nbsp;INTO&nbsp;gr_detp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gr_detp.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;selected&nbsp;data&nbsp;-&nbsp;input&nbsp;-&nbsp;head<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_inhead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0400<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;pretp&nbsp;EQ&nbsp;pa_pretp&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;detp&nbsp;&nbsp;IN&nbsp;gr_detp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##/##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;IN&nbsp;s_pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;PFONA&nbsp;IN&nbsp;GR_PFONA&nbsp;-&nbsp;USMCA<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datuv&nbsp;IN&nbsp;s_datuv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;salno&nbsp;IN&nbsp;s_salno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;zivno&nbsp;IN&nbsp;s_zivno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ZIVNO&nbsp;no<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;IN&nbsp;s_matnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;werks&nbsp;IN&nbsp;s_werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ocsts&nbsp;EQ&nbsp;zgftp_a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;msgty&nbsp;NE&nbsp;zgftp_e&nbsp;&nbsp;&nbsp;&nbsp;"Input&nbsp;error#&nbsp;#####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;EQ&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;pa_pretp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-intermediate.&nbsp;"&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s006&nbsp;&nbsp;WITH&nbsp;'###'(m05)&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-free_subcont.&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s006&nbsp;&nbsp;WITH&nbsp;'####'(m04)&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-good_issue.&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s006&nbsp;&nbsp;WITH&nbsp;'##&nbsp;##'(m03)&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-closing.&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s006&nbsp;&nbsp;WITH&nbsp;'##&nbsp;##'(m02)&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;g_exit&nbsp;=&nbsp;zgftp_on.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gt_inhead[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_initem<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0400&nbsp;AS&nbsp;a&nbsp;INNER&nbsp;JOIN&nbsp;zgft0401&nbsp;AS&nbsp;b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;b~guid&nbsp;EQ&nbsp;a~guid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;gt_inhead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a~guid&nbsp;&nbsp;=&nbsp;&nbsp;gt_inhead-guid.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT:&nbsp;gt_inhead&nbsp;&nbsp;BY&nbsp;guid,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_initem&nbsp;&nbsp;BY&nbsp;guid&nbsp;seq.<br />
<br />
ENDFORM.                    " SELECTED_OC_PREFERENCE_DATA<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SELECTED_PFONA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INPUT&nbsp;DATA#&nbsp;###&nbsp;###&nbsp;####.<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM selected_pfona .<br />
<br />
&nbsp;&nbsp;RANGES:&nbsp;lr_imyn&nbsp;FOR&nbsp;zgft0004-imyn.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;BEGIN&nbsp;OF&nbsp;ls_pfona&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pfona&nbsp;LIKE&nbsp;zgft0001-pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ls_pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_pfona&nbsp;LIKE&nbsp;SORTED&nbsp;TABLE&nbsp;OF&nbsp;ls_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;UNIQUE&nbsp;KEY&nbsp;pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_datab&nbsp;LIKE&nbsp;sy-datlo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_datec&nbsp;LIKE&nbsp;sy-datlo.<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_zkgt0004,&nbsp;gt_zkgt0004[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_zkgt0007,&nbsp;gt_zkgt0007[].<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_inhead.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lt_pfona-pfona&nbsp;=&nbsp;gt_inhead-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;TABLE&nbsp;lt_pfona.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;##&nbsp;###&nbsp;##&nbsp;range&nbsp;setting.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;pa_pretp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-intermediate.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ranges&nbsp;lr_imyn&nbsp;zgftp_in&nbsp;zgftp_eq&nbsp;zgftp_yes&nbsp;space.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-good_issue<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;zgftp_pretp-closing.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;[KG]&nbsp;FTA&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0004<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_zkgt0004<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;lt_pfona<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;pfona&nbsp;=&nbsp;lt_pfona-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;=&nbsp;pa_bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;dele&nbsp;&nbsp;=&nbsp;zgftp_false.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s007&nbsp;WITH&nbsp;'#####'(m06)&nbsp;'##'(m07)&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;g_exit&nbsp;=&nbsp;zgftp_on.&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_zkgt0004&nbsp;BY&nbsp;pfona&nbsp;datuv&nbsp;DESCENDING.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;RULE&nbsp;Buffer&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0007<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_zkgt0007<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;lt_pfona<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;pfona&nbsp;=&nbsp;lt_pfona-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;=&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_zkgt0007&nbsp;BY&nbsp;pfona&nbsp;datab.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;&nbsp;selected&nbsp;rule&nbsp;max&nbsp;yaer<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;l_date&nbsp;LIKE&nbsp;sy-datlo.<br />
&nbsp;&nbsp;IF&nbsp;g_spmon&nbsp;&lt;&gt;&nbsp;'000000'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_date&nbsp;=&nbsp;g_spmon.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_date+06(02)&nbsp;=&nbsp;'01'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_date&nbsp;=&nbsp;l_date&nbsp;+&nbsp;32.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_date+06(02)&nbsp;=&nbsp;'01'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_date&nbsp;=&nbsp;l_date&nbsp;-&nbsp;1.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_date&nbsp;=&nbsp;s_datuv-low.<br />
&nbsp;&nbsp;&nbsp;&nbsp;g_spmon&nbsp;=&nbsp;l_date.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;BEGIN&nbsp;OF&nbsp;lt_datab&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datab&nbsp;LIKE&nbsp;zgft0001-datab,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pfona&nbsp;LIKE&nbsp;zgft0001-pfona,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;lt_datab.<br />
<br />
&nbsp;&nbsp;RANGES&nbsp;:&nbsp;lr_pfona&nbsp;FOR&nbsp;zgft0001-pfona.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;lr_pfona,&nbsp;lr_pfona[].<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lr_pfona-sign&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lr_pfona-option&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lr_pfona-low&nbsp;=&nbsp;lt_pfona-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;lr_pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lr_pfona.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;datab&nbsp;pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;lt_datab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0001<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;pfona&nbsp;IN&nbsp;lr_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;EQ&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;lt_datab&nbsp;BY&nbsp;datab&nbsp;pfona&nbsp;DESCENDING.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;lt_datab&nbsp;COMPARING&nbsp;pfona.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;lt_datab<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;datab&nbsp;EQ&nbsp;lt_datab-datab<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;EQ&nbsp;lt_datab-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;EQ&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s007&nbsp;WITH&nbsp;'##'(m07)&nbsp;&nbsp;'FTA&nbsp;RULE&nbsp;###'(m08)&nbsp;DISPLAY&nbsp;LIKE&nbsp;zgftp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;g_exit&nbsp;=&nbsp;zgftp_on.&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_rule&nbsp;BY&nbsp;&nbsp;datab&nbsp;DESCENDING<br />
&nbsp;&nbsp;pfona&nbsp;ccngn&nbsp;ccngns&nbsp;rseq.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;lt_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;datab&nbsp;EQ&nbsp;'20000101'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;EQ&nbsp;lt_pfona-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;EQ&nbsp;pa_bukrs.<br />
&nbsp;&nbsp;SORT&nbsp;gt_t0002&nbsp;BY&nbsp;pfona&nbsp;ccngn&nbsp;ccngns&nbsp;rseq&nbsp;exty.<br />
<br />
ENDFORM.                    " SELECTED_PFONA<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXECUTED_PREFERENCE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM executed_preference.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;Selected&nbsp;PFONA<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;selected_pfona.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;g_exit&nbsp;NE&nbsp;zgftp_on.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;Rule&nbsp;Priority<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;get_rule_priority_data.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;######<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;get_cthr_digit_data.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;cert_origin_pref.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;save_data_rtn.<br />
<br />
ENDFORM.                    " EXECUTED_PREFERENCE<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CERT_ORIGIN_PREF<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;1.&nbsp;###&nbsp;####&nbsp;####&nbsp;###.<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM cert_origin_pref .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_subhead&nbsp;LIKE&nbsp;zgft0511&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;g_guid_ref.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;GUID&nbsp;REF&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;uuid_create(zgf_form_sub_routine)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;g_guid_ref.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_inhead&nbsp;ASSIGNING&nbsp;&lt;gf_inhead&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_subhead.<br />
&nbsp;&nbsp;&nbsp;&nbsp;FREE:&nbsp;&nbsp;lt_subhead.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_head_data.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;###&nbsp;###&nbsp;##&nbsp;##&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;-coflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HS&nbsp;CODE&nbsp;##.&nbsp;(##&nbsp;LEVEL)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_sub_head_item_data&nbsp;&nbsp;TABLES&nbsp;&nbsp;&nbsp;lt_subhead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgftp_in.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HS&nbsp;CODE&nbsp;##.&nbsp;(##&nbsp;LEVEL)&nbsp;:&nbsp;##&nbsp;HSCCODE&nbsp;&lt;&gt;&nbsp;HSCODE<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngnk&nbsp;IS&nbsp;NOT&nbsp;INITIAL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngn&nbsp;&lt;&gt;&nbsp;&lt;gf_inhead&gt;-ccngnk.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngn&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngnk.&nbsp;"##&nbsp;HS&nbsp;CODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_sub_head_item_data&nbsp;&nbsp;TABLES&nbsp;&nbsp;&nbsp;lt_subhead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgftp_ex.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HEAD&nbsp;##&nbsp;###.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_head_final_data&nbsp;&nbsp;TABLES&nbsp;&nbsp;&nbsp;lt_subhead.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;###&nbsp;###&nbsp;##&nbsp;###&nbsp;##&nbsp;#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_head_final_data_goods&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " CERT_ORIGIN_PREF<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_RULE_PRIORITY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_rule_priority_data .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;prule&nbsp;prort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_t5013<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft5013<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_t5013&nbsp;BY&nbsp;prort.<br />
<br />
ENDFORM.                    " GET_RULE_PRIORITY_DATA<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_OC_HEAD_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_oc_head_data.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_t0510.<br />
<br />
&nbsp;&nbsp;gs_t0510-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"guid&nbsp;key<br />
&nbsp;&nbsp;gs_t0510-guid_ref&nbsp;&nbsp;&nbsp;=&nbsp;g_guid_ref.<br />
&nbsp;&nbsp;gs_t0510-pretp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;pa_pretp.<br />
&nbsp;&nbsp;gs_t0510-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;pa_bukrs.<br />
&nbsp;&nbsp;gs_t0510-spmon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;g_spmon.<br />
&nbsp;&nbsp;gs_t0510-kunag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-kunag.&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;gs_t0510-salno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-salno.&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;##&nbsp;/&nbsp;Invoice&nbsp;No<br />
&nbsp;&nbsp;gs_t0510-pfona&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-pfona.&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;gs_t0510-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-werks.&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;gs_t0510-datuv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-datuv.<br />
&nbsp;&nbsp;gs_t0510-matnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-matnr.&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;gs_t0510-detp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-detp&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;"##/##&nbsp;##<br />
&nbsp;&nbsp;gs_t0510-kdmat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-kdmat.&nbsp;&nbsp;&nbsp;&nbsp;"######<br />
&nbsp;&nbsp;gs_t0510-goods&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-goods.&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;gs_t0510-exwpr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-exwpr.&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;(Ex&nbsp;Works)<br />
&nbsp;&nbsp;gs_t0510-fobpr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-fobpr.&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;(Free&nbsp;On&nbsp;Board)<br />
&nbsp;&nbsp;gs_t0510-ncspr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ncspr.&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;(Net&nbsp;Cost)<br />
&nbsp;&nbsp;gs_t0510-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-waers.&nbsp;&nbsp;&nbsp;&nbsp;"#####<br />
&nbsp;&nbsp;gs_t0510-subct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-subct.&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;gs_t0510-prctr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-prctr.&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;gs_t0510-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;-CODE<br />
&nbsp;&nbsp;gs_t0510-ccngnk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngnk.&nbsp;&nbsp;&nbsp;"##HS-CODE(/2016.07.07)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_T0510-NOVAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;GF_INHEAD&gt;-NOVAS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;##&nbsp;#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_t0510-coflg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-coflg.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_T0510-LIFNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;GF_INHEAD&gt;-LIFNR.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_t0510-zivdt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-zivdt.<br />
&nbsp;&nbsp;gs_t0510-zivno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-zivno.<br />
&nbsp;&nbsp;gs_t0510-vkorg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-vkorg.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_T0510-SLDAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;GF_INHEAD&gt;-SLDAT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_t0510-coflgbf&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0510-coflg.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;get_matnr_text&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510-matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_t0510-maktx.<br />
<br />
ENDFORM.                    " MAKE_OC_HEAD_DATA<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_SUB_HEAD_DATA_GOODS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_sub_head_data_goods.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0511.<br />
<br />
&nbsp;&nbsp;gs_t0511-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"guid&nbsp;KEY<br />
&nbsp;&nbsp;gs_t0511-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0511-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_t0511-hstyp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;zgftp_in.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;hs&nbsp;code.<br />
&nbsp;&nbsp;gs_t0511-inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-inco1.&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;(##&nbsp;1)<br />
&nbsp;&nbsp;gs_t0511-prule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-prule.&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-coflgr.&nbsp;&nbsp;&nbsp;"##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;gs_t0511-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-waers.<br />
<br />
ENDFORM.                    " MAKE_SUB_HEAD_DATA_GOODS<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_SUB_HEAD_DATA_GOODS_KUNAG<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_sub_head_data_goods_kunag.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_rate(02)&nbsp;TYPE&nbsp;n,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20(20)&nbsp;&nbsp;TYPE&nbsp;c.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0511.<br />
<br />
&nbsp;&nbsp;gs_t0511-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"GUID&nbsp;KEY<br />
&nbsp;&nbsp;gs_t0511-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;level&nbsp;)<br />
&nbsp;&nbsp;gs_t0511-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_t0511-hstyp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;zgftp_ex.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;hs&nbsp;code.<br />
&nbsp;&nbsp;gs_t0511-inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-inco1.&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;(##&nbsp;1)<br />
&nbsp;&nbsp;gs_t0511-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-waers.<br />
<br />
&nbsp;&nbsp;"{<br />
&nbsp;&nbsp;PERFORM&nbsp;get_find_fta_rule_goods.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;g_exit&nbsp;=&nbsp;zgftp_on.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;gs_rule&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;"PRULE&nbsp;###.<br />
&nbsp;&nbsp;CASE&nbsp;gs_rule-rct.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BD'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_rate&nbsp;=&nbsp;gs_rule-bdr.&nbsp;"###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20&nbsp;=&nbsp;l_rate.&nbsp;CONDENSE&nbsp;l_c20.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;gs_rule-rct&nbsp;l_c20&nbsp;INTO&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONDENSE&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_rate&nbsp;=&nbsp;gs_rule-bur.&nbsp;"###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20&nbsp;=&nbsp;l_rate.&nbsp;CONDENSE&nbsp;l_c20.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;gs_rule-rct&nbsp;l_c20&nbsp;INTO&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONDENSE&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_rate&nbsp;=&nbsp;gs_rule-mcr.&nbsp;"###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20&nbsp;=&nbsp;l_rate.&nbsp;CONDENSE&nbsp;l_c20.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;gs_rule-rct&nbsp;l_c20&nbsp;INTO&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONDENSE&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'B'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_rate&nbsp;=&nbsp;gs_rule-mcr.&nbsp;"###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20&nbsp;=&nbsp;l_rate.&nbsp;CONDENSE&nbsp;l_c20.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;gs_rule-rct&nbsp;l_c20&nbsp;INTO&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONDENSE&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule&nbsp;=&nbsp;gs_rule-rct.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;&nbsp;PRULE&nbsp;####.<br />
<br />
*--&nbsp;&nbsp;##<br />
*&nbsp;&nbsp;&nbsp;##&nbsp;PRULE#&nbsp;INPUT-PRULE#&nbsp;####&nbsp;##&nbsp;#&nbsp;###&nbsp;##.<br />
*&nbsp;&nbsp;&nbsp;BD&nbsp;or&nbsp;BU###&nbsp;##&nbsp;PRULE#&nbsp;###&nbsp;##&nbsp;##<br />
*&nbsp;&nbsp;&nbsp;MC###&nbsp;##&nbsp;PRULE#&nbsp;###&nbsp;##&nbsp;##<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0511-prule(02)&nbsp;EQ&nbsp;'BD'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule(02)&nbsp;EQ&nbsp;'BU'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule(02)&nbsp;EQ&nbsp;'NC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-prule&nbsp;LE&nbsp;&lt;gf_initem&gt;-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;gs_t0511-prule(02)&nbsp;EQ&nbsp;'MC'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule(02)&nbsp;EQ&nbsp;'B'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-prule&nbsp;GE&nbsp;&lt;gf_initem&gt;-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gs_t0511-coflg&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*--<br />
<br />
   </div>
   <div class="code">
ENDFORM.                    " MAKE_SUB_HEAD_DATA_GOODS_KUNAG<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_ITEM_DATA_GOODS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_item_data_goods TABLES pt_t0512 STRUCTURE zgft0512.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0512.<br />
<br />
&nbsp;&nbsp;gs_t0512-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"KEY<br />
&nbsp;&nbsp;gs_t0512-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0512-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_t0512-seq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-seq.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;gs_t0512-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-werks_roh.&nbsp;"###<br />
&nbsp;&nbsp;gs_t0512-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-mtroh.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;gs_t0512-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-ccngnr.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;###&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0512-coflgr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-coflgr.&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;gs_t0512-ova&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-valpr&nbsp;*&nbsp;&lt;gf_initem&gt;-mnglg.<br />
&nbsp;&nbsp;gs_t0512-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-waers.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#####<br />
&nbsp;&nbsp;gs_t0512-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-land1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;gs_t0512&nbsp;TO&nbsp;pt_t0512.<br />
<br />
ENDFORM.                    " MAKE_ITEM_DATA_GOODS<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_FIND_FTA_RULE_GOODS<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_find_fta_rule_goods .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_rule.<br />
<br />
&nbsp;&nbsp;"BDR&nbsp;OR&nbsp;MCR&nbsp;#&nbsp;##&nbsp;##&nbsp;##&nbsp;1&nbsp;##.<br />
&nbsp;&nbsp;"RSEQ&nbsp;1##&nbsp;####&nbsp;2##.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_rule&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;=&nbsp;gs_t0510-pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETP&nbsp;&nbsp;=&nbsp;&lt;GF_INHEAD&gt;-DETP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;=&nbsp;gs_t0511-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_rule&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;=&nbsp;gs_t0510-pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETP&nbsp;&nbsp;=&nbsp;ZGFTP_DETP-ALL<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;=&nbsp;gs_t0511-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;END&nbsp;OF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_rule&nbsp;FROM&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gt_rule-rseq&nbsp;EQ&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gt_rule&nbsp;TO&nbsp;gs_rule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gt_rule-rct&nbsp;EQ&nbsp;'BD'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_rule-rct&nbsp;EQ&nbsp;'BU'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_rule-rct&nbsp;EQ&nbsp;'MC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gt_rule&nbsp;TO&nbsp;gs_rule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;ccngn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--&nbsp;error&nbsp;##&nbsp;##()&nbsp;#&nbsp;hs&nbsp;code#&nbsp;##&nbsp;rule#&nbsp;####.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " GET_FIND_FTA_RULE_GOODS<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_SUB_HEAD_DATA_GOODS_FINAL<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_sub_head_data_goods_final TABLES pt_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRUCTURE&nbsp;zgft0511.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0511.<br />
<br />
&nbsp;&nbsp;gs_t0511-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"input&nbsp;key.<br />
&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;zgftp_yes.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
<br />
&nbsp;&nbsp;IF&nbsp;&lt;gf_inhead&gt;-ccngnk&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-ccngn&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngnk.&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-ccngn&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;pt_t0511.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;pt_t0511-hstyp&nbsp;EQ&nbsp;zgftp_ex.&nbsp;"##&nbsp;HS&nbsp;CODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule&nbsp;=&nbsp;pt_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;pt_t0511-prule&nbsp;IS&nbsp;INITIAL.&nbsp;"###&nbsp;##&nbsp;LEVEL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule&nbsp;=&nbsp;pt_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;pt_t0511-coflg&nbsp;EQ&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"####&nbsp;table<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_t0511&nbsp;TO&nbsp;pt_t0511.<br />
&nbsp;&nbsp;APPEND&nbsp;pt_t0511.<br />
<br />
&nbsp;&nbsp;"head&nbsp;update<br />
&nbsp;&nbsp;gs_t0510-prule&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;gs_t0510-coflg&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0511-coflg.<br />
&nbsp;&nbsp;gs_t0510-coflgbf&nbsp;=&nbsp;gs_t0511-coflgbf.<br />
<br />
ENDFORM.                    " MAKE_SUB_HEAD_DATA_GOODS_FINAL<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_SUB_HEAD_DATA_MAT_FINAL<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;1.&nbsp;###,&nbsp;######&nbsp;####.<br />
*&nbsp;2.&nbsp;2####&nbsp;###,&nbsp;####&nbsp;###&nbsp;##&nbsp;#####&nbsp;##&nbsp;####<br />
*&nbsp;&nbsp;&nbsp;&nbsp;####.<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_sub_head_data_mat_final TABLES pt_rseq  STRUCTURE zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_t0511&nbsp;STRUCTURE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;pv_append<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_hstyp.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_t0511_y&nbsp;TYPE&nbsp;&nbsp;TABLE&nbsp;OF&nbsp;zgft0511&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0511_n&nbsp;TYPE&nbsp;&nbsp;TABLE&nbsp;OF&nbsp;zgft0511&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;ls_t0511_used&nbsp;TYPE&nbsp;zgft0511.<br />
<br />
&nbsp;&nbsp;lt_t0511_y[]&nbsp;=&nbsp;pt_t0511[].&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###<br />
&nbsp;&nbsp;lt_t0511_n[]&nbsp;=&nbsp;pt_t0511[].&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###<br />
   </div>
   <div class="codeComment">
***&nbsp;###&nbsp;###&nbsp;Rule&nbsp;###&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_t0511_y.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;lt_t0511_y-prule(1)&nbsp;&lt;&gt;&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t5013&nbsp;WITH&nbsp;KEY&nbsp;prule&nbsp;=&nbsp;lt_t0511_y-prule(2).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t5013&nbsp;WITH&nbsp;KEY&nbsp;prule&nbsp;=&nbsp;lt_t0511_y-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gt_t5013-prort&nbsp;TO&nbsp;lt_t0511_y-prort.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_t0511_y.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'04'&nbsp;TO&nbsp;lt_t0511_y-prort.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_t0511_y.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
***&nbsp;###&nbsp;###&nbsp;Rule&nbsp;###&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_t0511_n.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;lt_t0511_n-prule(1)&nbsp;&lt;&gt;&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t5013&nbsp;WITH&nbsp;KEY&nbsp;prule&nbsp;=&nbsp;lt_t0511_n-prule(2).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t5013&nbsp;WITH&nbsp;KEY&nbsp;prule&nbsp;=&nbsp;lt_t0511_n-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gt_t5013-prort&nbsp;TO&nbsp;lt_t0511_n-prort.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_t0511_n.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'04'&nbsp;TO&nbsp;lt_t0511_n-prort.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;lt_t0511_n.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;DELETE&nbsp;lt_t0511_y&nbsp;WHERE&nbsp;coflgbf&nbsp;&lt;&gt;&nbsp;zgftp_y.<br />
&nbsp;&nbsp;DELETE&nbsp;lt_t0511_n&nbsp;WHERE&nbsp;coflgbf&nbsp;&lt;&gt;&nbsp;zgftp_n.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SORT:&nbsp;LT_T0511_Y&nbsp;BY&nbsp;CCNGN&nbsp;CCNGNS&nbsp;RSEQ,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_T0511_N&nbsp;BY&nbsp;CCNGN&nbsp;CCNGNS&nbsp;RSEQ.<br />
***&nbsp;Rule&nbsp;###&nbsp;###&nbsp;##&nbsp;##&nbsp;##.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT:&nbsp;lt_t0511_y&nbsp;BY&nbsp;ccngn&nbsp;ccngns&nbsp;prort,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0511_n&nbsp;BY&nbsp;ccngn&nbsp;ccngns&nbsp;prort.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lt_t0511_y[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_t0511_y&nbsp;INTO&nbsp;ls_t0511_used&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;ELSE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_t0511_n&nbsp;INTO&nbsp;ls_t0511_used&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;##&nbsp;###&nbsp;###&nbsp;###&nbsp;&nbsp;True&nbsp;##&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CHECK&nbsp;ls_t0511_used&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;MOVE&nbsp;zgftp_true&nbsp;TO&nbsp;ls_t0511_used-hused.<br />
<br />
&nbsp;&nbsp;MODIFY&nbsp;pt_t0511&nbsp;FROM&nbsp;ls_t0511_used<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;hused<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;guid&nbsp;&nbsp;&nbsp;=&nbsp;ls_t0511_used-guid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngn&nbsp;&nbsp;=&nbsp;ls_t0511_used-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngns&nbsp;=&nbsp;ls_t0511_used-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;rseq&nbsp;&nbsp;&nbsp;=&nbsp;ls_t0511_used-rseq.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;##&nbsp;###&nbsp;##&nbsp;##&nbsp;###&nbsp;###&nbsp;####&nbsp;##&nbsp;####.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:&nbsp;pt_rseq.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ls_t0511_used&nbsp;TO&nbsp;pt_rseq.<br />
&nbsp;&nbsp;APPEND&nbsp;pt_rseq.<br />
<br />
ENDFORM.                    " MAKE_SUB_HEAD_DATA_MAT_FINAL<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_SUB_HEAD_DATA_MAT_PFONA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_sub_head_data_mat_pfona  USING    pv_hstyp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_cdmr&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_cdmr&nbsp;"##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead&nbsp;STRUCTURE&nbsp;zgft0400.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_zkgt0001&nbsp;TYPE&nbsp;zgft0001.<br />
&nbsp;&nbsp;DATA:&nbsp;lv_rct.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0511.<br />
<br />
   </div>
   <div class="codeComment">
*-----------------------------------------------------------<br />
*&nbsp;&nbsp;&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;ps_inhead-goods&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-ccngns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_rule-ccngns.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"hs&nbsp;code&nbsp;##&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_rule-rseq.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-hstyp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;pv_hstyp.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"hs&nbsp;code&nbsp;TYPE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_inhead&gt;-inco1.&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;(##&nbsp;1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_inhead&gt;-waers.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-exsign&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_rule-exsign.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;##&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-exsign&nbsp;EQ&nbsp;zgftp_true.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUB-HEAD&nbsp;####&nbsp;###&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;subhead_excep_origin&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;gs_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_t0511.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_rule&nbsp;TO&nbsp;ls_zkgt0001.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;get_rule_data(zgf_form_sub_routine)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_t0511-prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvc<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-cthr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_rule-cthr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"######&nbsp;#<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_T0511-DMU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RULE-DMU.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#####&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_rule-dmr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;##&nbsp;##<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;RULE#&nbsp;##&nbsp;or&nbsp;####&nbsp;###&nbsp;###.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_rct&nbsp;=&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMR&nbsp;##.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-dmr&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmrbf&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0511-dmr&nbsp;-&nbsp;pv_cdmr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-guid&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0510-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-hstyp&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;pv_hstyp.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"hs&nbsp;code&nbsp;TYPE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;pv_prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0510-coflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;=&nbsp;&nbsp;gs_t0510-coflg.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;pv_hstyp&nbsp;=&nbsp;zgftp_ex.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0511&nbsp;WITH&nbsp;KEY&nbsp;guid&nbsp;=&nbsp;gs_t0511-guid.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gt_t0511-coflg&nbsp;=&nbsp;'N'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-prule&nbsp;=&nbsp;gs_t0511-prule&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-ccngn&nbsp;=&nbsp;gs_t0511-ccngn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;gt_t0511-coflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;=&nbsp;gt_t0511-coflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;mandt&nbsp;INTO&nbsp;sy-mandt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft0004<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;dele&nbsp;=&nbsp;zgftp_false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;pfona&nbsp;=&nbsp;ps_inhead-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;bukrs&nbsp;=&nbsp;ps_inhead-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;orule1(20),&nbsp;orule2(20),&nbsp;nrule1(20),&nbsp;nrule2(20).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gt_t0511-prule&nbsp;=&nbsp;'CC'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-prule&nbsp;=&nbsp;'CTH'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-prule&nbsp;=&nbsp;'CTSH'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orule1&nbsp;=&nbsp;gt_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;gt_t0511-prule+00(02)&nbsp;=&nbsp;'BD'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-prule+00(02)&nbsp;=&nbsp;'BU'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-prule+00(02)&nbsp;=&nbsp;'MC'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t0511-prule+00(02)&nbsp;=&nbsp;'NC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orule2&nbsp;=&nbsp;gt_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLIT&nbsp;gt_t0511-prule&nbsp;AT&nbsp;'+'&nbsp;INTO&nbsp;orule1&nbsp;orule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-prule&nbsp;=&nbsp;'CC'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule&nbsp;=&nbsp;'CTH'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule&nbsp;=&nbsp;'CTSH'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrule1&nbsp;=&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;gs_t0511-prule+00(02)&nbsp;=&nbsp;'BD'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule+00(02)&nbsp;=&nbsp;'BU'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule+00(02)&nbsp;=&nbsp;'MC'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-prule+00(02)&nbsp;=&nbsp;'NC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrule2&nbsp;=&nbsp;gt_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLIT&nbsp;gs_t0511-prule&nbsp;AT&nbsp;'+'&nbsp;INTO&nbsp;nrule1&nbsp;nrule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;orule2&nbsp;&lt;&gt;&nbsp;''&nbsp;AND&nbsp;nrule2&nbsp;&lt;&gt;&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;orule2&nbsp;&gt;&nbsp;nrule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;orule2+00(02)&nbsp;'H'&nbsp;INTO&nbsp;orule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;nrule2+00(02)&nbsp;'L'&nbsp;INTO&nbsp;nrule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;orule2&nbsp;&lt;&nbsp;nrule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;orule2+00(02)&nbsp;'L'&nbsp;INTO&nbsp;orule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;nrule2+00(02)&nbsp;'H'&nbsp;INTO&nbsp;nrule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;orule2+00(02)&nbsp;'M'&nbsp;INTO&nbsp;orule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;nrule2+00(02)&nbsp;'M'&nbsp;INTO&nbsp;nrule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;orule2&nbsp;&lt;&gt;&nbsp;''&nbsp;AND&nbsp;nrule2&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;orule2+00(02)&nbsp;''&nbsp;INTO&nbsp;orule2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510-coflg&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0511-coflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510-coflgbf&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0511-coflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " MAKE_SUB_HEAD_DATA_MAT_PFONA<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_SUB_HEAD_DATA_MAT_INTER<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;####&nbsp;##&nbsp;#####&nbsp;###&nbsp;###.<br />
*"##&nbsp;RULE#&nbsp;##&nbsp;##&nbsp;##&nbsp;####&nbsp;#####&nbsp;##.<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_sub_head_data_mat_inter TABLES pt_t0511 STRUCTURE zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;p_hstyp.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_rate(02)&nbsp;TYPE&nbsp;n,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20(20)&nbsp;&nbsp;TYPE&nbsp;c.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0511.<br />
<br />
&nbsp;&nbsp;gs_t0511-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"GUID&nbsp;KEY<br />
&nbsp;&nbsp;gs_t0511-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0511-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_t0511-hstyp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_hstyp.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"hs&nbsp;code&nbsp;TYPE.<br />
&nbsp;&nbsp;gs_t0511-inco1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-inco1.&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;(##&nbsp;1)<br />
&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;zgftp_yes.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;gs_t0511-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-waers.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;get_find_fta_rule_mat_inter.<br />
<br />
&nbsp;&nbsp;gs_t0511-prule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_rule-cthr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;gs_t0511-cthr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_rule-cthr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"######&nbsp;#<br />
&nbsp;&nbsp;gs_t0511-dmr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_rule-dmr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;##&nbsp;##<br />
<br />
&nbsp;&nbsp;IF&nbsp;gs_rule-bdr&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvc&nbsp;&nbsp;=&nbsp;'BD'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcr&nbsp;=&nbsp;gs_rule-bdr.<br />
&nbsp;&nbsp;ELSEIF&nbsp;gs_rule-bur&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvc&nbsp;&nbsp;=&nbsp;'BU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcr&nbsp;=&nbsp;gs_rule-bur.<br />
&nbsp;&nbsp;ELSEIF&nbsp;gs_rule-ncr&nbsp;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvc&nbsp;&nbsp;=&nbsp;'NC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcr&nbsp;=&nbsp;gs_rule-ncr.<br />
&nbsp;&nbsp;ELSEIF&nbsp;gs_rule-mcr&nbsp;&gt;&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcr&nbsp;=&nbsp;gs_rule-mcr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;&lt;gf_inhead&gt;-pfona.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvc&nbsp;&nbsp;=&nbsp;'MC'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gs_t0511-prule&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvc&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_rate&nbsp;=&nbsp;gs_t0511-rvcr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_c20&nbsp;=&nbsp;l_c20.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;gs_t0511-prule&nbsp;zgftp_plus&nbsp;gs_t0511-rvc&nbsp;l_c20<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_rate&nbsp;=&nbsp;gs_t0511-rvcr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_c20&nbsp;=&nbsp;l_c20.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;gs_t0511-rvc&nbsp;l_c20&nbsp;INTO&nbsp;gs_t0511-prule.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_t0511&nbsp;TO&nbsp;pt_t0511.<br />
&nbsp;&nbsp;APPEND&nbsp;pt_t0511.<br />
<br />
ENDFORM.                    " MAKE_SUB_HEAD_DATA_MAT_INTER<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_FIND_FTA_RULE_MAT_INTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_find_fta_rule_mat_inter .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_rule.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_rule&nbsp;INTO&nbsp;gs_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;=&nbsp;gs_t0510-pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETP&nbsp;&nbsp;=&nbsp;&lt;GF_INHEAD&gt;-DETP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;=&nbsp;gs_t0511-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_rule&nbsp;INTO&nbsp;gs_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;=&nbsp;gs_t0510-pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETP&nbsp;&nbsp;=&nbsp;ZGFTP_DETP-ALL<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;=&nbsp;gs_t0511-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;END&nbsp;OF.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"*--&nbsp;ERROR&nbsp;MESSAGE&nbsp;##.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " GET_FIND_FTA_RULE_MAT_INTER<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_ITEM_DATA_MAT_INTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_item_data_mat_inter TABLES pt_t0512.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_t0512.<br />
<br />
&nbsp;&nbsp;gs_t0512-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"GUID&nbsp;KEY<br />
&nbsp;&nbsp;gs_t0512-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0512-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_t0512-seq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-seq.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;gs_t0512-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-werks_roh.&nbsp;"###<br />
&nbsp;&nbsp;gs_t0512-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-mtroh.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;gs_t0512-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-ccngnr.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;###&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0512-coflgr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-coflgr.&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;gs_t0512-ova&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-valpr&nbsp;*&nbsp;&lt;gf_initem&gt;-mnglg.<br />
&nbsp;&nbsp;gs_t0512-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-waers.<br />
&nbsp;&nbsp;gs_t0512-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-land1.<br />
<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_t0512&nbsp;TO&nbsp;pt_t0512.<br />
&nbsp;&nbsp;APPEND&nbsp;pt_t0512.<br />
<br />
ENDFORM.                    " MAKE_ITEM_DATA_MAT_INTER<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_OC_ITEM_DATA_MAT_CCNGN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_oc_item_data_mat_ccngn  CHANGING cv_cthcoflg_ex93<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex95.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_xexist_excep.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_t0512.<br />
<br />
&nbsp;&nbsp;gs_t0512-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0510-guid.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##KEY<br />
&nbsp;&nbsp;gs_t0512-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngn.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;##&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0512-ccngns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_rule-ccngns.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;##&nbsp;##.<br />
&nbsp;&nbsp;gs_t0512-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;gs_rule-rseq.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_t0512-seq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-seq.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;gs_t0512-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-werks_roh.&nbsp;"###<br />
&nbsp;&nbsp;gs_t0512-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-mtroh.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
<br />
&nbsp;&nbsp;gs_t0512-coflgr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-coflgr.&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;gs_t0512-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-ccngnr.&nbsp;&nbsp;&nbsp;&nbsp;"HS&nbsp;CODE&nbsp;(&nbsp;###&nbsp;LEVEL&nbsp;)<br />
&nbsp;&nbsp;gs_t0512-fngbl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-fngbl.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;###<br />
&nbsp;&nbsp;gs_t0512-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-lifnr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####(##)(/2016.05.24&nbsp;##)<br />
&nbsp;&nbsp;gs_t0512-lifnrstr&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-lifnrstr.&nbsp;&nbsp;"####&nbsp;##(/2016.05.24&nbsp;##)<br />
&nbsp;&nbsp;gs_t0512-mnglg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-mnglg.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##(/2016.06.14&nbsp;-&nbsp;##)<br />
&nbsp;&nbsp;gs_t0512-mnein&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-mnein.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;##(/2016.06.14&nbsp;-&nbsp;##)<br />
&nbsp;&nbsp;gs_t0512-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-waers.<br />
&nbsp;&nbsp;gs_t0512-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-land1.<br />
<br />
<br />
&nbsp;&nbsp;"####&nbsp;###<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;&lt;gf_initem&gt;-coflgr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512-ova&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_initem&gt;-valpr&nbsp;*&nbsp;&lt;gf_initem&gt;-mnglg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;gs_t0512-ova&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0511-ovas.&nbsp;&nbsp;&nbsp;"sub&nbsp;head&nbsp;sum<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512-nov&nbsp;&nbsp;=&nbsp;&lt;gf_initem&gt;-valpr&nbsp;*&nbsp;&lt;gf_initem&gt;-mnglg.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;####&nbsp;###&nbsp;0#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0512-nov&nbsp;&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ZGFTP_OVERFLOW&nbsp;&nbsp;TO&nbsp;GS_T0512-NOV,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGFTP_OVERFLOW&nbsp;&nbsp;TO&nbsp;GS_T0511-NOVAS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;gs_t0512-nov&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0511-novas.&nbsp;&nbsp;"sub&nbsp;head&nbsp;sum<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*-----------------------------------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"{####<br />
&nbsp;&nbsp;IF&nbsp;gs_t0511-exsign&nbsp;EQ&nbsp;zgftp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.&nbsp;"######.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;ITEM&nbsp;####&nbsp;###&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0511-exsign&nbsp;EQ&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex93<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex95<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xexist_excep.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;"}<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;##&nbsp;##&nbsp;###&nbsp;##&nbsp;##&nbsp;(&nbsp;###&nbsp;###&nbsp;###&nbsp;###&nbsp;#&nbsp;##&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;##&nbsp;##&nbsp;###&nbsp;####&nbsp;##&nbsp;PSR&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_rule-cthr&nbsp;IS&nbsp;NOT&nbsp;INITIAL<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;gs_t0512-coflgr&nbsp;=&nbsp;zgftp_coflg-no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;(&nbsp;gs_t0511-exty&nbsp;=&nbsp;'91'&nbsp;OR&nbsp;gs_t0511-exty&nbsp;=&nbsp;'92'&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;lv_xexist_excep&nbsp;IS&nbsp;INITIAL&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;gs_t0511-exty&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t5011&nbsp;WITH&nbsp;KEY&nbsp;cthr&nbsp;=&nbsp;gs_rule-cthr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;gf_initem&gt;-ccngnr&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_initem&gt;-ccngnr&nbsp;&nbsp;=&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;gf_inhead&gt;-ccngn(gt_t5011-digit)&nbsp;EQ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_initem&gt;-ccngnr(gt_t5011-digit).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512-cthcoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-cthcoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_no.&nbsp;&nbsp;"SUB&nbsp;HEAD&nbsp;###<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512-cthcoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_yes.&nbsp;"###<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-cthcoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_yes.&nbsp;&nbsp;"SUB&nbsp;HEAD&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##2&nbsp;:&nbsp;EXHS##&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0512-exhs&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;gs_t0511-exty.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'8'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512-cthcoflg&nbsp;=&nbsp;zgftp_n.&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-cthcoflg&nbsp;=&nbsp;zgftp_n.&nbsp;&nbsp;"SUB&nbsp;HEAD&nbsp;###<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'3'&nbsp;OR&nbsp;'4'&nbsp;OR&nbsp;'6'&nbsp;OR&nbsp;'15'&nbsp;OR&nbsp;'91'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0512-nov&nbsp;=&nbsp;zgftp_overflow.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;###&nbsp;####&nbsp;##&nbsp;###&nbsp;##<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;ZGFTP_OVERFLOW&nbsp;TO&nbsp;GS_T0511-EXNOVAS.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;gs_t0512-nov&nbsp;TO&nbsp;gs_t0511-exnovas.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"--&nbsp;ERROR&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;####&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0512-cthcoflg&nbsp;EQ&nbsp;zgftp_no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0512-dmnov&nbsp;=&nbsp;&lt;gf_initem&gt;-valpr&nbsp;*&nbsp;&lt;gf_initem&gt;-mnglg.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0512-dmnov&nbsp;&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ZGFTP_OVERFLOW&nbsp;TO&nbsp;GS_T0512-DMNOV,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGFTP_OVERFLOW&nbsp;TO&nbsp;GS_T0511-DMNOVAS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUB&nbsp;HEAD#&nbsp;SUM##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;gs_t0512-dmnov&nbsp;TO&nbsp;gs_t0511-dmnovas.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " MAKE_OC_ITEM_DATA_MAT_CCNGN<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_OC_SUB_HEAD_DATA_MAT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_oc_sub_head_data_mat  USING    pv_inco             TYPE inco1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_crvcr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_crvcr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_item_coflg_cnt&nbsp;&nbsp;&nbsp;TYPE&nbsp;i<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_item_ncoflg_cnt&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;l_oref&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cx_root.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_field&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;fieldname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(02).<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS:&nbsp;&lt;fs_value&gt;&nbsp;TYPE&nbsp;any,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_calc&gt;&nbsp;&nbsp;TYPE&nbsp;any.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;2015/08/10&nbsp;###&nbsp;##<br />
*--&nbsp;##&nbsp;####&nbsp;##&nbsp;###&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;pv_item_ncoflg_cnt&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0511-exsign&nbsp;EQ&nbsp;zgftp_e.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_no.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-exsign&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ELSE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;gs_t0511-exty.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;#####&nbsp;ITEM&nbsp;#&nbsp;&gt;&nbsp;###&nbsp;#####&nbsp;ITEM&nbsp;#<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'13'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-novas&nbsp;&gt;&nbsp;gs_t0511-ovas.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'3'&nbsp;OR&nbsp;'4'&nbsp;OR&nbsp;'6'&nbsp;OR&nbsp;'15'&nbsp;OR&nbsp;'91'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-exnovas&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'GS_T0510-'&nbsp;pv_inco&nbsp;'PR'&nbsp;INTO&nbsp;lv_field.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;(lv_field)&nbsp;TO&nbsp;&lt;fs_value&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs_value&gt;&nbsp;IS&nbsp;ASSIGNED.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;####&nbsp;##&nbsp;##&nbsp;####&nbsp;###&nbsp;#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-exnovas&nbsp;&gt;&nbsp;&lt;fs_value&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-exrco&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'100.00'.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-exrco&nbsp;=&nbsp;gs_t0511-exnovas&nbsp;/<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_value&gt;&nbsp;*&nbsp;100.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"%<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-exr&nbsp;&gt;=&nbsp;gs_t0511-exrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_sy_zerodivide&nbsp;INTO&nbsp;l_oref.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;####&nbsp;###&nbsp;#####&nbsp;###&nbsp;hscode&nbsp;#&nbsp;###&nbsp;###<br />
*&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;####<br />
*&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;##&nbsp;##&nbsp;##&nbsp;###&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'7'&nbsp;OR&nbsp;'10'&nbsp;OR&nbsp;'11'&nbsp;OR&nbsp;'12'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-excoflg&nbsp;&lt;&gt;&nbsp;zgftp_y.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;=&nbsp;zgftp_n.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'93'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;pv_item_coflg_cnt&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-cthr&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-cthcoflg&nbsp;&nbsp;=&nbsp;&nbsp;gs_t0511-excoflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'94'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;pv_item_ncoflg_cnt&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0511-dmnovas&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"2019.10.30&nbsp;-&nbsp;USMCA#&nbsp;##&nbsp;##&nbsp;####&nbsp;-&nbsp;Start<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;gs_rule-pfona(5).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PUSMC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'GS_T0510-'&nbsp;'NCS'&nbsp;'PR'&nbsp;INTO&nbsp;lv_field.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;(lv_field)&nbsp;TO&nbsp;&lt;fs_value&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'GS_T0510-'&nbsp;pv_inco&nbsp;'PR'&nbsp;INTO&nbsp;lv_field.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;(lv_field)&nbsp;TO&nbsp;&lt;fs_value&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"2019.10.30&nbsp;-&nbsp;USMCA#&nbsp;##&nbsp;##&nbsp;####&nbsp;-&nbsp;End<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;fs_value&gt;&nbsp;IS&nbsp;ASSIGNED.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;####&nbsp;##&nbsp;##&nbsp;####&nbsp;###&nbsp;#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-dmnovas&nbsp;&gt;&nbsp;&lt;fs_value&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmrco&nbsp;&nbsp;&nbsp;=&nbsp;'100.00'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmrco&nbsp;=&nbsp;gs_t0511-dmnovas&nbsp;/<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_value&gt;&nbsp;*&nbsp;100.&nbsp;"%<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_sy_zerodivide&nbsp;INTO&nbsp;l_oref.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-dmr&nbsp;&gt;=&nbsp;gs_t0511-dmrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmcoflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmcoflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-dmrbf&nbsp;&gt;=&nbsp;gs_t0511-dmrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmbfflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-dmbfflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gs_t0511-rvc&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;gs_t0511-rvc.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BD'.<br />
   </div>
   <div class="codeComment">
*--&nbsp;####&nbsp;##&nbsp;##&nbsp;####&nbsp;###&nbsp;#&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-novas&nbsp;&gt;&nbsp;gs_t0510-fobpr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;=&nbsp;(&nbsp;(&nbsp;gs_t0510-fobpr&nbsp;-&nbsp;gs_t0511-novas&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;gs_t0510-fobpr&nbsp;)&nbsp;*&nbsp;100.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;+&nbsp;pv_crvcr.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;+&nbsp;pv_crvcr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-ovas&nbsp;&gt;&nbsp;gs_t0510-fobpr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;=&nbsp;(&nbsp;gs_t0511-ovas&nbsp;/&nbsp;gs_t0510-fobpr&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;100.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;+&nbsp;pv_crvcr.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;+&nbsp;pv_crvcr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'NC'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;###&nbsp;####&nbsp;##&nbsp;0##&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-novas&nbsp;&gt;&nbsp;gs_t0510-ncspr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;=&nbsp;(&nbsp;(&nbsp;gs_t0510-ncspr&nbsp;-&nbsp;gs_t0511-novas&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;gs_t0510-ncspr&nbsp;)&nbsp;*&nbsp;100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;+&nbsp;pv_crvcr.<br />
<br />
   </div>
   <div class="codeComment">
*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-novas&nbsp;&gt;&nbsp;gs_t0510-exwpr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;&nbsp;&nbsp;=&nbsp;'100.00'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;=&nbsp;(&nbsp;gs_t0511-novas&nbsp;/&nbsp;gs_t0510-exwpr&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;100.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;-&nbsp;pv_crvcr.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;-&nbsp;pv_crvcr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'B'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-novas&nbsp;&gt;&nbsp;gs_t0510-fobpr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;&nbsp;&nbsp;=&nbsp;'100.00'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrco&nbsp;=&nbsp;(&nbsp;gs_t0511-novas&nbsp;/&nbsp;gs_t0510-fobpr&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcrbf&nbsp;=&nbsp;gs_t0511-rvcr&nbsp;-&nbsp;pv_crvcr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_sy_zerodivide&nbsp;INTO&nbsp;l_oref.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"*--ERROR&nbsp;##<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;gs_t0511-rvc.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BD'&nbsp;OR&nbsp;'BU'&nbsp;OR&nbsp;'NC'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcrco&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcr&nbsp;&lt;=&nbsp;gs_t0511-rvcrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvccoflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvccoflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvccoflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MC'&nbsp;OR&nbsp;'B'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcrco&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcr&nbsp;&gt;=&nbsp;gs_t0511-rvcrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvccoflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvccoflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvccoflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
&nbsp;&nbsp;CASE&nbsp;gs_t0511-rvc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BD'&nbsp;OR&nbsp;'BU'&nbsp;OR&nbsp;'NC'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcrbf&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcrbf&nbsp;&lt;=&nbsp;gs_t0511-rvcrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcbfflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcbfflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcbfflg&nbsp;=&nbsp;gs_t0511-rvccoflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MC'&nbsp;OR&nbsp;'B'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcrbf&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-rvcrbf&nbsp;GE&nbsp;gs_t0511-rvcrco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcbfflg&nbsp;=&nbsp;zgftp_yes.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcbfflg&nbsp;=&nbsp;zgftp_no.&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-rvcbfflg&nbsp;=&nbsp;gs_t0511-rvccoflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;##.<br />
*--&nbsp;COFLG<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;gs_t0511-cthcoflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_yes.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;BEGIN&nbsp;OF&nbsp;2016.05.13&nbsp;-&nbsp;##&nbsp;92#&nbsp;######&nbsp;###.&nbsp;###&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-exty&nbsp;=&nbsp;'92'&nbsp;AND&nbsp;gs_t0511-dmbfflg&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;END&nbsp;OF&nbsp;2016.05.13.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-dmcoflg&nbsp;EQ&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;gs_t0511-rvccoflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg+01(01)&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg+01(01)&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_coflg&nbsp;CP&nbsp;'*N*'&nbsp;OR&nbsp;lv_coflg&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;BUFFER<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;lv_coflg.<br />
&nbsp;&nbsp;CASE&nbsp;gs_t0511-cthcoflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_yes.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;BEGIN&nbsp;OF&nbsp;2016.05.13&nbsp;-&nbsp;##&nbsp;92#&nbsp;######&nbsp;###.&nbsp;###&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-exty&nbsp;=&nbsp;'92'&nbsp;AND&nbsp;gs_t0511-dmbfflg&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;END&nbsp;OF&nbsp;2016.05.13.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0511-dmbfflg&nbsp;EQ&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg(01)&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;gs_t0511-rvcbfflg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg+01(01)&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_coflg+01(01)&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_coflg&nbsp;CP&nbsp;'*N*'&nbsp;OR&nbsp;lv_coflg&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;COFLGBF#&nbsp;##&nbsp;###&nbsp;COFLG#&nbsp;##&nbsp;##&nbsp;###.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0511-coflgbf&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;=&nbsp;gs_t0511-coflg.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;####&nbsp;##&nbsp;###&nbsp;###&nbsp;#####<br />
*&nbsp;&nbsp;&nbsp;##&nbsp;###&nbsp;##&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0511-excoflg&nbsp;=&nbsp;zgftp_n.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflg&nbsp;&nbsp;&nbsp;=&nbsp;zgftp_n.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0511-coflgbf&nbsp;=&nbsp;zgftp_n.<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " MAKE_OC_SUB_HEAD_DATA_MAT<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_OC_SUB_HEAD_ITEM_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_oc_sub_head_item_data  TABLES   pt_subhead   STRUCTURE zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead&nbsp;&nbsp;&nbsp;&nbsp;STRUCTURE&nbsp;zgft0400<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_hstyp.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_rule&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_error&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_append&nbsp;&nbsp;&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_itmtabix&nbsp;TYPE&nbsp;sy-tabix.<br />
&nbsp;&nbsp;DATA:&nbsp;lv_rule_exist,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_detp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_detp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cthcoflg_ex93,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;93#&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cthcoflg_ex95.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;95#&nbsp;##<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_tabix&nbsp;LIKE&nbsp;sy-tabix.<br />
&nbsp;&nbsp;DATA:&nbsp;lt_t0511&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0511&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0512&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;zgft0512&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0512tmp&nbsp;LIKE&nbsp;zgft0512&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_cdmr&nbsp;&nbsp;TYPE&nbsp;zkge_cdmr,&nbsp;&nbsp;"###&nbsp;####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_crvcr&nbsp;TYPE&nbsp;zkge_crvcr,&nbsp;"###&nbsp;####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_inco&nbsp;&nbsp;TYPE&nbsp;inco1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_cdmr2&nbsp;&nbsp;TYPE&nbsp;zkge_cdmr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_crvcr2&nbsp;TYPE&nbsp;zkge_crvcr.<br />
&nbsp;&nbsp;DATA:&nbsp;l_cdmr3(3)&nbsp;&nbsp;TYPE&nbsp;p,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_crvcr3(3)&nbsp;TYPE&nbsp;p.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_item_coflg_cnt&nbsp;&nbsp;TYPE&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_item_ncoflg_cnt&nbsp;TYPE&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###&nbsp;###&nbsp;##<br />
<br />
&nbsp;&nbsp;lv_error&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;PSR(RULE)&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;find_rule&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead-detp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;lv_rule_exist<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rule.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_rule_exist&nbsp;=&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_ccngn&nbsp;&nbsp;=&nbsp;&nbsp;ls_rule-ccngn.<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_rule&nbsp;&nbsp;INTO&nbsp;gs_rule&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;gs_rule-pfona&nbsp;&lt;&gt;&nbsp;ps_inhead-pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;GS_RULE-DETP&nbsp;&nbsp;&lt;&gt;&nbsp;LV_DETP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;gs_rule-ccngn&nbsp;&lt;&gt;&nbsp;lv_ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;gs_rule-datab&nbsp;&lt;&gt;&nbsp;ls_rule-datab.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;#&nbsp;##&nbsp;##<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2016.05.18&nbsp;-&nbsp;#####&nbsp;##&nbsp;####&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_t0511,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0512,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_crvcr,&nbsp;&nbsp;l_cdmr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_zkgt0007,&nbsp;"GT_ZKGT1007,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_inco.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;&nbsp;###&nbsp;buffer&nbsp;master<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_zkgt0007&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;=&nbsp;gs_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_zkgt0007&nbsp;FROM&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gt_zkgt0007-pfona&nbsp;&lt;&gt;&nbsp;gs_rule-pfona.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gt_zkgt0007-datab&nbsp;&lt;=&nbsp;ps_inhead-datuv&nbsp;AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_zkgt0007-datbi&nbsp;&gt;=&nbsp;ps_inhead-datuv.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;gt_zkgt0007-cdmr&nbsp;&nbsp;TO&nbsp;l_cdmr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_zkgt0007-crvcr&nbsp;TO&nbsp;l_crvcr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FTA&nbsp;##&nbsp;#####&nbsp;INCOTERMS&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;get_inco_at_zkgt0004&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;gs_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead-datuv<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;l_inco.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;make&nbsp;sub&nbsp;head&nbsp;data<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_sub_head_data_mat_pfona&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;pv_hstyp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead-prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_cdmr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_inhead.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lv_cthcoflg_ex93,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cthcoflg_ex95,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_item_coflg_cnt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_item_ncoflg_cnt.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_initem&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;guid&nbsp;&nbsp;=&nbsp;&nbsp;ps_inhead-guid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_itmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;93&nbsp;-&nbsp;####&nbsp;####&nbsp;####&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;10)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;93#&nbsp;###&nbsp;####&nbsp;####&nbsp;####&nbsp;##&nbsp;####&nbsp;#####&nbsp;##&nbsp;###<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_initem&nbsp;&nbsp;ASSIGNING&nbsp;&lt;gf_initem&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_itmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;check_item_excep_93&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_initem&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;lv_cthcoflg_ex93.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_cthcoflg_ex93&nbsp;=&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;guid.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_initem&nbsp;ASSIGNING&nbsp;&lt;gf_initem&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_itmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_t0512.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;##&nbsp;##&nbsp;##.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_item_data_mat_ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;lv_cthcoflg_ex93<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cthcoflg_ex95.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITEM&nbsp;APPEND<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_t0512&nbsp;TO&nbsp;lt_t0512.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;lt_t0512.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_t0512-coflgr&nbsp;=&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;lv_item_coflg_cnt.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;gs_t0512-coflgr&nbsp;=&nbsp;zgftp_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;lv_item_ncoflg_cnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;guid.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;LEVEL&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_oc_sub_head_data_mat&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;l_inco<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_crvcr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_item_coflg_cnt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_item_ncoflg_cnt.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUB&nbsp;HEAD#&nbsp;APPEND.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_t0511&nbsp;TO&nbsp;lt_t0511.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;lt_t0511.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lv_item_ncoflg_cnt.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;lv_append.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;##&nbsp;##.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;make_sub_head_data_mat_final&nbsp;&nbsp;TABLES&nbsp;&nbsp;&nbsp;pt_subhead<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;lv_append<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_hstyp.<br />
<br />
&nbsp;&nbsp;"&nbsp;#&nbsp;####&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;SORT&nbsp;lt_t0512&nbsp;BY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mtroh&nbsp;lifnr&nbsp;guid&nbsp;ccngn&nbsp;ccngns&nbsp;rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bukrs&nbsp;werks&nbsp;ccngnr&nbsp;fngbl&nbsp;lifnrstr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mnein&nbsp;coflgr&nbsp;exhs&nbsp;cthcoflg&nbsp;valrf&nbsp;waers&nbsp;land1.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_src&nbsp;&nbsp;TYPE&nbsp;zgft0512,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc&nbsp;&nbsp;TYPE&nbsp;zgft0512,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_init&nbsp;TYPE&nbsp;abap_bool.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;ls_acc,&nbsp;lv_init.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_t0512&nbsp;INTO&nbsp;ls_src.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_init&nbsp;IS&nbsp;INITIAL.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#&nbsp;#&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc&nbsp;=&nbsp;ls_src.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_init&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"==&nbsp;##&nbsp;#&nbsp;##&nbsp;==<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;ls_src-guid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-guid<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-ccngn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-ccngns&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-rseq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-bukrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-werks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-werks<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-mtroh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-mtroh<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-ccngnr&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-ccngnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-fngbl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-fngbl<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-lifnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-lifnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-lifnrstr&nbsp;&nbsp;=&nbsp;ls_acc-lifnrstr<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-mnein&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-mnein<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-coflgr&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-coflgr<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-exhs<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-cthcoflg&nbsp;&nbsp;=&nbsp;ls_acc-cthcoflg<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-valrf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-valrf<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-waers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-waers<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ls_src-land1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_acc-land1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"==&nbsp;##&nbsp;##&nbsp;==<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc-mnglg&nbsp;+=&nbsp;ls_src-mnglg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc-nov&nbsp;&nbsp;&nbsp;+=&nbsp;ls_src-nov.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc-ova&nbsp;&nbsp;&nbsp;+=&nbsp;ls_src-ova.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc-dmnov&nbsp;+=&nbsp;ls_src-dmnov.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_acc&nbsp;TO&nbsp;gt_t0512.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_acc&nbsp;=&nbsp;ls_src.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_init&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_acc&nbsp;TO&nbsp;gt_t0512.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;##&nbsp;APPEND<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;lv_append&nbsp;IS&nbsp;INITIAL.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LINES&nbsp;OF&nbsp;:&nbsp;lt_t0512&nbsp;TO&nbsp;gt_t0512,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LINES&nbsp;OF&nbsp;:&nbsp;lt_t0511&nbsp;TO&nbsp;gt_t0511.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " MAKE_OC_SUB_HEAD_ITEM_DATA<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_OC_HEAD_FINAL_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_oc_head_final_data TABLES pt_rseq STRUCTURE zgft0511.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_rseq_in&nbsp;TYPE&nbsp;zgft0511,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;Hscode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex&nbsp;TYPE&nbsp;zgft0511.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;Hscode<br />
&nbsp;&nbsp;DATA:&nbsp;lv_subrc_ex&nbsp;TYPE&nbsp;sy-subrc,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_subrc_in&nbsp;TYPE&nbsp;sy-subrc.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;##&nbsp;###&nbsp;##&nbsp;###&nbsp;####&nbsp;##&nbsp;###&nbsp;##.<br />
*--&nbsp;####<br />
*&nbsp;1.&nbsp;###&nbsp;###&nbsp;####&nbsp;###&nbsp;##<br />
*&nbsp;2.&nbsp;###&nbsp;###&nbsp;####&nbsp;###&nbsp;##<br />
*&nbsp;3.&nbsp;##&nbsp;#####&nbsp;##hscode&nbsp;####&nbsp;####&nbsp;##<br />
*&nbsp;EX)<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;##&nbsp;Hscode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;##&nbsp;Hscode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;###&nbsp;##<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###(&nbsp;##hs&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###(&nbsp;##hs&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###(&nbsp;##hs&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###(&nbsp;##hs&nbsp;)<br />
*----------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_rseq&nbsp;INTO&nbsp;ls_rseq_ex&nbsp;WITH&nbsp;KEY&nbsp;hstyp&nbsp;=&nbsp;zgftp_ex.<br />
&nbsp;&nbsp;lv_subrc_ex&nbsp;&nbsp;=&nbsp;&nbsp;sy-subrc.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;pt_rseq&nbsp;INTO&nbsp;ls_rseq_in&nbsp;WITH&nbsp;KEY&nbsp;hstyp&nbsp;=&nbsp;zgftp_in.<br />
&nbsp;&nbsp;lv_subrc_in&nbsp;&nbsp;=&nbsp;&nbsp;sy-subrc.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ls_rseq_ex-coflgbf&nbsp;=&nbsp;zgftp_n.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ls_rseq_ex-prule&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex-ccngn&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex-coflg&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-coflg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex-coflgbf&nbsp;TO&nbsp;gs_t0510-coflgbf.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;ls_rseq_in-coflgbf&nbsp;=&nbsp;zgftp_n.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ls_rseq_in-prule&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-ccngn&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-coflg&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-coflg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-coflgbf&nbsp;TO&nbsp;gs_t0510-coflgbf.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;ls_rseq_ex-coflgbf&nbsp;=&nbsp;zgftp_y.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ls_rseq_ex-prule&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex-ccngn&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex-coflg&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-coflg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_ex-coflgbf&nbsp;TO&nbsp;gs_t0510-coflgbf.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_subrc_in&nbsp;IS&nbsp;INITIAL&nbsp;&nbsp;AND&nbsp;&nbsp;lv_subrc_ex&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ls_rseq_in-prule&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-ccngn&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-coflg&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-coflg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-coflgbf&nbsp;TO&nbsp;gs_t0510-coflgbf.<br />
   </div>
   <div class="codeComment">
*##&nbsp;hs&nbsp;code&nbsp;####,&nbsp;##&nbsp;hs&nbsp;code#&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;lv_subrc_in&nbsp;IS&nbsp;INITIAL&nbsp;&nbsp;AND&nbsp;&nbsp;lv_subrc_ex&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;ls_rseq_in-prule&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-prule,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-ccngn&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-ccngn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-coflg&nbsp;&nbsp;&nbsp;TO&nbsp;gs_t0510-coflg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rseq_in-coflgbf&nbsp;TO&nbsp;gs_t0510-coflgbf.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE:&nbsp;zgftp_no&nbsp;&nbsp;TO&nbsp;gs_t0510-coflg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgftp_no&nbsp;&nbsp;TO&nbsp;gs_t0510-coflgbf.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_origin_valpr&nbsp;LIKE&nbsp;zgft0512-ova.<br />
<br />
&nbsp;&nbsp;"head#&nbsp;##/##&nbsp;hscode&nbsp;###&nbsp;##.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_t0510&nbsp;TO&nbsp;gt_t0510.<br />
<br />
ENDFORM.                    " MAKE_OC_HEAD_FINAL_DATA<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAKE_OC_HEAD_FINAL_DATA_GOODS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM make_oc_head_final_data_goods  USING    ps_input    STRUCTURE zgft0400.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0001&nbsp;TYPE&nbsp;zgft0001.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_rule_exist,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_index&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_hsdigit&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_rct,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rvc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_rvc,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rvcr&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_rvcr.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_error&nbsp;&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_append&nbsp;TYPE&nbsp;c.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_ccngnk&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_ccngnk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_bdr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_bdr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_bdr_c(10)&nbsp;TYPE&nbsp;c,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_prule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_prule.<br />
<br />
&nbsp;&nbsp;gs_t0510-prule&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_input-prule.<br />
&nbsp;&nbsp;gs_t0510-ccngn&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_input-ccngn.<br />
&nbsp;&nbsp;gs_t0510-coflg&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_input-coflg.<br />
&nbsp;&nbsp;gs_t0510-coflgbf&nbsp;&nbsp;=&nbsp;&nbsp;ps_input-coflg.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;prule#&nbsp;###&nbsp;####.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;gs_t0510-prule&nbsp;IS&nbsp;INITIAL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSR(RULE)&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;find_rule&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_input-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_input-detp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_input-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;lv_rule_exist<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rule.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_rule_exist&nbsp;=&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ls_rule&nbsp;TO&nbsp;ls_zkgt0001.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;get_rule_data(zgf_form_sub_routine)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_t0510-prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rvc<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rvcr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;make&nbsp;sub&nbsp;head&nbsp;data<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;make_sub_head_data_mat_pfona&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;zgftp_in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510-prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_input.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;INPUT##&nbsp;##&nbsp;HS-CODE#&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;ps_input-ccngnk&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INPUT#&nbsp;##&nbsp;HS-CODE#&nbsp;##&nbsp;HS-CODE#&nbsp;##&nbsp;##.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510-ccngn&nbsp;&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngnk.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;gf_inhead&gt;-ccngnk&nbsp;NE&nbsp;&lt;gf_inhead&gt;-ccngn.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSR(RULE)&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;find_rule&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_input-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_input-detp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_input-ccngnk<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;lv_rule_exist<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_rule.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_rule_exist&nbsp;=&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ls_rule&nbsp;TO&nbsp;ls_zkgt0001.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;get_rule_data(zgf_form_sub_routine)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ls_zkgt0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_t0510-prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rct<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rvc<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rvcr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;make&nbsp;sub&nbsp;head&nbsp;data<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_sub_head_data_mat_pfona&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;zgftp_ex<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t0510-prule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_input.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;HEAD#&nbsp;##/##&nbsp;HS-CODE&nbsp;##&nbsp;#&nbsp;##.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;gs_t0510&nbsp;TO&nbsp;gt_t0510.<br />
<br />
ENDFORM.                    " MAKE_OC_HEAD_FINAL_DATA_GOODS<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SAVE_DATA_RTN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM save_data_rtn .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;l_oref&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cx_root,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_text&nbsp;TYPE&nbsp;string.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;TRY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####&nbsp;##.<br />
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;MODIFY&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgft0510&nbsp;FROM&nbsp;TABLE&nbsp;gt_t0510,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgft0511&nbsp;FROM&nbsp;TABLE&nbsp;gt_t0511,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgft0512&nbsp;FROM&nbsp;TABLE&nbsp;gt_t0512.<br />
<br />
&nbsp;&nbsp;WAIT&nbsp;UP&nbsp;TO&nbsp;1&nbsp;SECONDS.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;INPUT&nbsp;###&nbsp;##&nbsp;##&nbsp;####&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0510.<br />
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;zgft0400&nbsp;SET&nbsp;ocsts&nbsp;=&nbsp;zgftp_b<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;guid&nbsp;EQ&nbsp;gt_t0510-guid.<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
ENDFORM.                    " SAVE_DATA_RTN<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;OC_GOODS_COFLG_YES_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM oc_goods_coflg_yes_data .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_tabix&nbsp;LIKE&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lt_t0511&nbsp;LIKE&nbsp;zgft0511&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_t0512&nbsp;LIKE&nbsp;zgft0512&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
<br />
&nbsp;&nbsp;"###&nbsp;item&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_initem&nbsp;WITH&nbsp;KEY&nbsp;guid&nbsp;=&nbsp;&lt;gf_inhead&gt;-guid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;=&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-----&gt;&nbsp;##&nbsp;LEVEL&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_initem&nbsp;ASSIGNING&nbsp;&lt;gf_initem&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_t0511,&nbsp;lt_t0512.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"--&nbsp;ITEM#&nbsp;##&nbsp;######<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;gf_inhead&gt;-coflg&nbsp;EQ&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_sub_head_data_mat_inter&nbsp;TABLES&nbsp;lt_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;zgftp_in.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;LEVEL&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_item_data_mat_inter&nbsp;TABLES&nbsp;lt_t0512.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;guid.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"----&gt;&nbsp;##&nbsp;LEVEL&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;gf_inhead&gt;-ccngnk&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;gf_inhead&gt;-ccngn&nbsp;=&nbsp;&lt;gf_inhead&gt;-ccngnk.&nbsp;"##&nbsp;HS&nbsp;CODE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_initem&nbsp;ASSIGNING&nbsp;&lt;gf_initem&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_t0511,&nbsp;lt_t0512.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"--&nbsp;ITEM#&nbsp;##&nbsp;######<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&lt;gf_inhead&gt;-coflg&nbsp;EQ&nbsp;zgftp_yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_sub_head_data_mat_inter&nbsp;TABLES&nbsp;lt_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;zgftp_ex.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;LEVEL&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;make_item_data_mat_inter&nbsp;TABLES&nbsp;lt_t0512.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;guid.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"--&nbsp;##&nbsp;APPEND<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LINES&nbsp;OF&nbsp;:&nbsp;LT_T0512&nbsp;TO&nbsp;GT_T0512,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;lt_t0512&nbsp;INTO&nbsp;gt_t0512.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LINES&nbsp;OF&nbsp;:&nbsp;lt_t0511&nbsp;TO&nbsp;gt_t0511.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_t0510&nbsp;TO&nbsp;gt_t0510.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " OC_GOODS_COFLG_YES_DATA<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;INITIAL_SET<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM initial_set .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;FROM&nbsp;t001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;&nbsp;=&nbsp;&nbsp;pa_bukrs.<br />
<br />
ENDFORM.                    " INITIAL_SET<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SET_SCREEN_MOVE_RADIOBT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_screen_move_radiobt .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;pa_pretp.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###,&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-intermediate&nbsp;OR&nbsp;zgftp_pretp-good_issue.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;screen-group1&nbsp;EQ&nbsp;'TPG'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-active&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;zgftp_pretp-closing&nbsp;OR&nbsp;zgftp_pretp-free_subcont&nbsp;OR&nbsp;zgftp_pretp-simulation.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;screen-group1&nbsp;EQ&nbsp;'TPI'&nbsp;OR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-group1&nbsp;EQ&nbsp;'CLS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-active&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " SET_SCREEN_MOVE_RADIOBT<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_CTHR_DIGIT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_cthr_digit_data .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gt_t5011,&nbsp;gt_t5011[].<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;cthr&nbsp;digit<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_t5011<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;zgft5011<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;=&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;gt_t5011&nbsp;BY&nbsp;cthr.<br />
<br />
ENDFORM.                    " GET_CTHR_DIGIT_DATA<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;LIST_BOX_SET<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM list_box_set .<br />
<br />
&nbsp;&nbsp;TYPE-POOLS&nbsp;:&nbsp;vrm.<br />
&nbsp;&nbsp;DATA:&nbsp;l_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;vrm_id,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;vrm_values,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_value&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;l_list,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_temp(20).<br />
<br />
&nbsp;&nbsp;DATA&nbsp;lt_listvalue&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;zgfs0050&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;DEFINE&nbsp;catalog1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_value-key&nbsp;&nbsp;=&nbsp;&1&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;l_value-text&nbsp;=&nbsp;&2&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;l_value&nbsp;TO&nbsp;l_list.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;l_value.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
&nbsp;&nbsp;l_name&nbsp;=&nbsp;'PA_DETP'.<br />
<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zgf_listbox_data/zgf_listbox_data.html">'ZGF_LISTBOX_DATA'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_sgubun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'DIV'<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_listvalue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_listvalue<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list_value_not_found&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;sy-msgid&nbsp;TYPE&nbsp;sy-msgty&nbsp;NUMBER&nbsp;sy-msgno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;sy-msgv1&nbsp;sy-msgv2&nbsp;sy-msgv3&nbsp;sy-msgv4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_listvalue.<br />
&nbsp;&nbsp;&nbsp;&nbsp;catalog1&nbsp;lt_listvalue-svalue&nbsp;lt_listvalue-svtxt.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'VRM_SET_VALUES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;l_name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;=&nbsp;l_list.<br />
<br />
ENDFORM.                    " LIST_BOX_SET<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_MATNR_TEXT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_GS_T0510_MATNR&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_GS_T0510_MAKTX&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_matnr_text  USING    pv_matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cv_maktx.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_maktx.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_maktx&nbsp;&nbsp;WITH&nbsp;TABLE&nbsp;KEY&nbsp;matnr&nbsp;&nbsp;=&nbsp;&nbsp;pv_matnr.<br />
<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;matnr&nbsp;maktx<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;(gt_maktx-matnr,&nbsp;gt_maktx-maktx)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;makt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;spras&nbsp;EQ&nbsp;sy-langu<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;EQ&nbsp;pv_matnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_maktx-matnr&nbsp;=&nbsp;pv_matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;TABLE&nbsp;gt_maktx.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;cv_maktx&nbsp;&nbsp;=&nbsp;&nbsp;gt_maktx-maktx.<br />
<br />
ENDFORM.                    " GET_MATNR_TEXT<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FIND_RULE<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_INPUT_CCNGN&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM find_rule  USING    VALUE(pv_pfona)    TYPE zkge_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE(pv_detp)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_detp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE(pv_ccngn)&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cv_exist<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_tabix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_rule&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_rule&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s.<br />
&nbsp;&nbsp;DATA:&nbsp;lv_index&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-index,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_hsdigit&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;cv_exist,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_rule.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;PSR(RULE)&nbsp;##&nbsp;:&nbsp;HS-CODE#&nbsp;8&nbsp;-&gt;&nbsp;6&nbsp;-&gt;&nbsp;4&nbsp;-&gt;&nbsp;2&nbsp;###&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DO&nbsp;gc_rule_search_count&nbsp;TIMES.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_index&nbsp;&nbsp;=&nbsp;&nbsp;sy-index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_index&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_hsdigit&nbsp;=&nbsp;strlen(&nbsp;pv_ccngn&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_index&nbsp;&nbsp;=&nbsp;&nbsp;lv_index&nbsp;-&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_hsdigit&nbsp;=&nbsp;(&nbsp;6&nbsp;/&nbsp;lv_index&nbsp;+&nbsp;1&nbsp;-&nbsp;(&nbsp;lv_index&nbsp;MOD&nbsp;2&nbsp;)&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;pa_pretp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'12'&nbsp;OR&nbsp;'01'&nbsp;OR&nbsp;'02'&nbsp;OR&nbsp;'00'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_rule&nbsp;&nbsp;INTO&nbsp;ls_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;=&nbsp;&nbsp;pv_pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETP&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;PV_DETP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;=&nbsp;&nbsp;pv_ccngn(lv_hsdigit).<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_rule&nbsp;&nbsp;INTO&nbsp;ls_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;=&nbsp;&nbsp;pv_pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DETP&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ZGFTP_DETP-ALL<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;=&nbsp;&nbsp;pv_ccngn(lv_hsdigit).<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_exist&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_tabix&nbsp;&nbsp;=&nbsp;&nbsp;lv_tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_rule&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_rule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'11'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_rule&nbsp;INTO&nbsp;ls_rule&nbsp;WHERE&nbsp;pfona&nbsp;&nbsp;=&nbsp;&nbsp;pv_pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;DETP&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;PV_DETP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngn&nbsp;&nbsp;=&nbsp;&nbsp;pv_ccngn(lv_hsdigit)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datab&nbsp;&nbsp;=&lt;&nbsp;gs_t0510-datuv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_rule&nbsp;INTO&nbsp;ls_rule&nbsp;WHERE&nbsp;pfona&nbsp;&nbsp;=&nbsp;&nbsp;pv_pfona<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;DETP&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ZGFTP_DETP-ALL<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ccngn&nbsp;&nbsp;=&nbsp;&nbsp;pv_ccngn(lv_hsdigit)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datab&nbsp;&nbsp;=&lt;&nbsp;gs_t0510-datuv.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_tabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_exist&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_tabix&nbsp;&nbsp;=&nbsp;&nbsp;lv_tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_rule&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_rule.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDDO.<br />
<br />
ENDFORM.                    " FIND_RULE<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SUBHEAD_EXCEP_ORIGIN<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_&lt;GF_INHEAD&gt;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_GS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_GS_T0511&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM subhead_excep_origin  USING    ps_rule      TYPE ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####&nbsp;###&nbsp;##&nbsp;LEVEL&nbsp;###&nbsp;##&nbsp;###.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-exsign&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_e.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;cs_t0511-exty&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exty.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;####&nbsp;##&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;cs_t0511-exty.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(REF&nbsp;-&nbsp;7)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'91'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-exie&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_i.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;###,&nbsp;##&nbsp;PSR&nbsp;##(REF&nbsp;-&nbsp;8)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'92'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-exie&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_e.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;####&nbsp;####&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(REF&nbsp;-&nbsp;10)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'93'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-exie&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_i.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(REF&nbsp;-&nbsp;11)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'94'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-exie&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_i.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###,&nbsp;##&nbsp;PSR&nbsp;##(REF&nbsp;-&nbsp;12)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'95'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-exie&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_i.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-coflg&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-coflgbf&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.                    " SUBHEAD_EXCEP_ORIGIN<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_GS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_GS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex93<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex95<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin_91&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin_92&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin_93&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex93<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin_94&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin_95&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex95<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;item_excep_origin_96&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;ps_t0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN_91<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_T0510&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0511&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin_91  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;91&nbsp;-&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;7)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'91',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;cs_t0512-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;lv_frmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;ls_t0002-pfona&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngn&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngns&nbsp;&lt;&gt;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-rseq&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-exty&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;lv_exty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;=&nbsp;&nbsp;strlen(&nbsp;ls_t0002-exhs&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cs_t0512-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN_91<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN_92<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_T0510&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0511&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin_92  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;92&nbsp;-&nbsp;##&nbsp;###,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;8)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'92',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;cs_t0512-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;lv_frmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;ls_t0002-pfona&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngn&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngns&nbsp;&lt;&gt;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-rseq&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-exty&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;lv_exty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;=&nbsp;&nbsp;strlen(&nbsp;ls_t0002-exhs&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cs_t0512-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN_92<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN_93<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_T0510&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0511&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin_93  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex93<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;93&nbsp;-&nbsp;####&nbsp;####&nbsp;####&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;10)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'93',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;cs_t0512-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;lv_frmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;ls_t0002-pfona&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngn&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngns&nbsp;&lt;&gt;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-rseq&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-exty&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;lv_exty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;=&nbsp;&nbsp;strlen(&nbsp;ls_t0002-exhs&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cv_cthcoflg_ex93&nbsp;=&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cs_t0512-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cs_t0512-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex93&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN_93<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN_94<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_T0510&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0511&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin_94  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;94&nbsp;-&nbsp;##&nbsp;##/###&nbsp;###,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;11)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'94',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xexist.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;cs_t0512-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;lv_frmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;ls_t0002-pfona&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngn&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngns&nbsp;&lt;&gt;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-rseq&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-exty&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;lv_exty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;=&nbsp;&nbsp;strlen(&nbsp;ls_t0002-exhs&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cs_t0512-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_xexist&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;lv_xexist&nbsp;&lt;&gt;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN_94<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN_95<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_T0510&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0511&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin_95  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex95<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;95&nbsp;-&nbsp;###,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;12)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'95'.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;cs_t0512-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;IF&nbsp;cv_cthcoflg_ex95&nbsp;=&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0511-excoflg&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex95&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN_95<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ITEM_EXCEP_ORIGIN_96<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_T0510&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0511&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_CS_T0512&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM item_excep_origin_96  USING    ps_t0510    TYPE zgft0510<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cs_t0511&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0511<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0512<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;96<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'91',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;cs_t0512-cthcoflg&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;lv_frmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;ls_t0002-pfona&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngn&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngns&nbsp;&lt;&gt;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-rseq&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-exty&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;lv_exty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;=&nbsp;&nbsp;strlen(&nbsp;ls_t0002-exhs&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;cs_t0512-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-exhs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ls_t0002-exhs(lv_len).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;cs_t0512-nov&nbsp;/&nbsp;ps_t0510-exwpr&nbsp;)&nbsp;&gt;&nbsp;ls_t0002-exr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-yes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cs_t0512-cthcoflg&nbsp;=&nbsp;&nbsp;zgftp_coflg-no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_xexist_excep&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " ITEM_EXCEP_ORIGIN_91<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CHECK_ITEM_EXCEP_93<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_&lt;GF_INITEM&gt;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_GS_RULE&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_LV_CTHCOFLG_EX93&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_item_excep_93  USING    ps_initem   TYPE zgft0401<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_rule&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ty_rule_s<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cv_cthcoflg_ex93.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;93&nbsp;-&nbsp;####&nbsp;####&nbsp;####&nbsp;##&nbsp;##,&nbsp;##&nbsp;PSR&nbsp;##(###&nbsp;##&nbsp;-&nbsp;10)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_t0002&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zgft0002.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;lv_exty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zkge_exty&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'93',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_frmtabix&nbsp;TYPE&nbsp;sy-tabix,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;i.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t0002&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;pfona&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngn&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccngns&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rseq&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exty&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_exty<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;lv_frmtabix&nbsp;&nbsp;=&nbsp;&nbsp;sy-tabix.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_t0002&nbsp;&nbsp;INTO&nbsp;ls_t0002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;lv_frmtabix.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;ls_t0002-pfona&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngn&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-ccngn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-ccngns&nbsp;&lt;&gt;&nbsp;ps_rule-ccngns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-rseq&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;ps_rule-rseq<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;&nbsp;ls_t0002-exty&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;lv_exty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;&nbsp;=&nbsp;&nbsp;strlen(&nbsp;ls_t0002-exhs&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ps_initem-ccngnr(lv_len)&nbsp;EQ&nbsp;ls_t0002-exhs(lv_len).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv_cthcoflg_ex93&nbsp;&nbsp;=&nbsp;&nbsp;zgftp_true.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " CHECK_ITEM_EXCEP_93<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_INCO_AT_ZKGT0004<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_GS_RULE_PFONA&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_PS_INPUTHEAD_DATUV&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_L_INCO&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_inco_at_zkgt0004  USING    pv_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pv_datuv<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;cv_inco.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_zkgt0004&nbsp;WHERE&nbsp;pfona&nbsp;&nbsp;=&nbsp;&nbsp;pv_pfona<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;datuv&nbsp;&nbsp;&lt;=&nbsp;pv_datuv.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;gt_zkgt0004-inco&nbsp;&nbsp;TO&nbsp;cv_inco.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.                    " GET_INCO_AT_ZKGT0004<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_BUKRS<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_bukrs .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;ls_t001&nbsp;LIKE&nbsp;t001.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;ls_t001.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;ls_t001<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;t001<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;bukrs&nbsp;EQ&nbsp;pa_bukrs.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;ls_t001&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;p_butxt&nbsp;=&nbsp;ls_t001-butxt.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_INIT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_init .<br />
<br />
&nbsp;&nbsp;papretp&nbsp;=&nbsp;TEXT-t80.<br />
&nbsp;&nbsp;pabukrs&nbsp;=&nbsp;TEXT-t81."&nbsp;####<br />
&nbsp;&nbsp;padetp&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-t82."###&nbsp;##<br />
&nbsp;&nbsp;sdatuv&nbsp;&nbsp;=&nbsp;TEXT-t83."##&nbsp;###<br />
&nbsp;&nbsp;smatnr&nbsp;&nbsp;=&nbsp;TEXT-t84."##<br />
&nbsp;&nbsp;spfona&nbsp;&nbsp;=&nbsp;TEXT-t85."FTA&nbsp;##<br />
&nbsp;&nbsp;ssalno&nbsp;&nbsp;=&nbsp;TEXT-t86."##&nbsp;##&nbsp;/&nbsp;######<br />
&nbsp;&nbsp;sspmon&nbsp;&nbsp;=&nbsp;TEXT-t87."#<br />
&nbsp;&nbsp;swerks&nbsp;&nbsp;=&nbsp;TEXT-t88."###<br />
&nbsp;&nbsp;szivno&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-t89."Invoice&nbsp;No.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;001&nbsp;Inquiry&nbsp;condi.<br />
*&nbsp;T80&nbsp;Deter.&nbsp;Class.<br />
*&nbsp;T81&nbsp;Company&nbsp;Code<br />
*&nbsp;T82&nbsp;Local&nbsp;/&nbsp;Export<br />
*&nbsp;T83&nbsp;Date&nbsp;from<br />
*&nbsp;T84&nbsp;Product<br />
*&nbsp;T85&nbsp;FTA&nbsp;agreement<br />
*&nbsp;T86&nbsp;Billing&nbsp;Document<br />
*&nbsp;T87&nbsp;Month<br />
*&nbsp;T88&nbsp;Plant<br />
*&nbsp;T89&nbsp;Invoice&nbsp;No.<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;PA_BUKRS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Company&nbsp;Code<br />
*&nbsp;PA_DETP&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;PA_PRETP&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_DATUV&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_MATNR&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_PFONA&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_SALNO&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_SPMON&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_WERKS&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_ZIVNO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Invoice&nbsp;No.<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;ZGFMC<br />
*006&nbsp;&nbsp;&nbsp;No&nbsp;data&nbsp;in&nbsp;question:&nbsp;&1<br />
*007&nbsp;&nbsp;&nbsp;&1&nbsp;does&nbsp;not&nbsp;contain&nbsp;any&nbsp;data.&nbsp;Check&nbsp;&2.<br />
*016&nbsp;&nbsp;&nbsp;&1&nbsp;is&nbsp;a&nbsp;mandatory&nbsp;input&nbsp;field<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 756</td>
   </tr>
</table>
</body>
</html>
